<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>PF: forward simulation — pf_forward • patter</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="PF: forward simulation — pf_forward"><meta property="og:description" content="This function runs the forward simulation of the forward filtering--backward smoothing algorithm. The forward simulation samples possible locations (particles) of an animal at each time point given the data up to (and including) that time point and a movement model."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patter</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/a-methodology.html">Methodology</a>
    </li>
    <li>
      <a href="../articles/b-workflow-outline.html">Workflow outline</a>
    </li>
    <li>
      <a href="../articles/c-workflow-example.html">Example workflow</a>
    </li>
    <li>
      <a href="../articles/d-demos.html">Demos</a>
    </li>
    <li>
      <a href="../articles/e-faqs.html">FAQs</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/edwardlavender/patter/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>PF: forward simulation</h1>
    <small class="dont-index">Source: <a href="https://github.com/edwardlavender/patter/blob/HEAD/R/pf_forward.R" class="external-link"><code>R/pf_forward.R</code></a></small>
    <div class="hidden name"><code>pf_forward.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function runs the forward simulation of the forward filtering--backward smoothing algorithm. The forward simulation samples possible locations (particles) of an animal at each time point given the data up to (and including) that time point and a movement model.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pf_forward</span><span class="op">(</span></span>
<span>  <span class="va">.obs</span>,</span>
<span>  <span class="va">.dlist</span>,</span>
<span>  .rpropose <span class="op">=</span> <span class="va">pf_rpropose_kick</span>,</span>
<span>  .rargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  .dpropose <span class="op">=</span> <span class="va">pf_dpropose</span>,</span>
<span>  .dargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  .likelihood <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  .n <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  .sample <span class="op">=</span> <span class="va">pf_sample_multinomial</span>,</span>
<span>  .trial <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_trial</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  .control <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_control</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  .rerun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  .rerun_from <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_rerun_from</a></span><span class="op">(</span><span class="va">.rerun</span><span class="op">)</span>,</span>
<span>  .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  .verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"patter.verbose"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>.obs</dt>
<dd><p>A <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> defining the timeline and associated observations, typically from <code><a href="pf_setup_obs.html">pf_setup_obs()</a></code>.</p></dd>


<dt>.dlist</dt>
<dd><p>A <code>named</code> list of data and parameters required propose locations and calculate likelihoods (see <code><a href="pat_setup_data.html">pat_setup_data()</a></code>, <code><a href="pf_lik.html">pf_lik</a></code> and <code><a href="pf_propose.html">pf_propose</a></code>). This function requires:</p><ul><li><p><code>.dlist$spatial$bathy</code></p></li>
<li><p>(optional) <code>.dlist$spatial$origin</code>, a <code><a href="https://rdrr.io/pkg/terra/man/SpatRaster-class.html" class="external-link">SpatRaster</a></code> used to define the origin.</p></li>
<li><p><code>.dlist$pars$lonlat</code> (required by the default <code>.rpropose</code> and <code>.dpropose</code> arguments).</p></li>
<li><p>Any additional elements required by <code>.likelihood</code>,<code>.rpropose</code> and <code>.dpropose</code> functions(see below).</p></li>
</ul></dd>


<dt>.rpropose, .dpropose, .rargs, .dargs</dt>
<dd><p>Proposal functions and associated argument lists (see <code><a href="pf_propose.html">pf_propose</a></code>).</p><ul><li><p><code>.rpropose</code> is a function that proposes new locations for the individual, given previous locations. By default, this is a 'stochastic kick' function that simulates new locations by randomly kicking previous particles (see <code><a href="pf_propose.html">pf_rpropose_kick()</a></code> and Details).</p></li>
<li><p><code>.dpropose</code> is a function that evaluates the probability density of movements between location pairs (see <code><a href="pf_propose.html">pf_dpropose()</a></code>). This is required for directed sampling (see Details).</p></li>
<li><p><code>.rargs</code> and <code>.dargs</code> are named <code>list</code>s of arguments passed to <code>.rpropose</code> and <code>.dpropose</code> respectively.</p></li>
</ul></dd>


<dt>.likelihood</dt>
<dd><p>A named <code>list</code> of likelihood functions. These are used to calculate the likelihood of each dataset at proposal locations. See <code><a href="pf_lik.html">pf_lik</a></code> for required arguments, convenience functions and advice.</p></dd>


<dt>.n, .sample</dt>
<dd><p>Sampling arguments.</p><ul><li><p><code>.n</code> is an <code>integer</code> that defines the number of particle samples at each time step.</p></li>
<li><p><code>.sample</code> is a function used to (re)-sample proposal locations (see <code><a href="pf_sample.html">pf_sample</a></code>).</p></li>
</ul></dd>


<dt>.trial</dt>
<dd><p>A named <code>list</code> of tuning parameters for convergence, from <code><a href="pf_opt.html">pf_opt_trial()</a></code>.</p></dd>


<dt>.control</dt>
<dd><p>A named <code>list</code> of control options, from <code><a href="pf_opt.html">pf_opt_control()</a></code>.</p></dd>


<dt>.rerun, .rerun_from</dt>
<dd><p>Rerun options. These options are used to restart the algorithm from an earlier time step in the case of a convergence failure.</p><ul><li><p><code>.rerun</code> is the named <code>list</code> of algorithm outputs from a previous rerun.</p></li>
<li><p><code>.rerun_from</code> is an <code>integer</code> that defines the time step from which to rerun the algorithm.</p></li>
</ul><p>Algorithm parameters should remain consistent on algorithm reruns.</p></dd>


<dt>.record</dt>
<dd><p>A named <code>list</code> of output options, from <code><a href="pf_opt.html">pf_opt_record()</a></code>.</p></dd>


<dt>.verbose</dt>
<dd><p>User output control (see <code><a href="patter-progress.html">patter-progress</a></code> for supported options).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The function returns a <code><a href="pf_particles-class.html">pf_particles</a></code> object. If <code>.record$sink</code> is specified, two directories, <code>{.record$sink}/history/</code> and <code>{.record$sink}/diagnostics</code>, are also created that contain particle samples and diagnostics. Particle samples are labelled <code>1.parquet, 2.parquet, ..., T.parquet</code>, where <code>T</code> is the number of time steps. Diagnostics are labelled <code>A-B-C</code>, where <code>A</code>, <code>B</code> and <code>C</code> are the number of manual restarts, internal reversions and time steps. Use <code><a href="pf_forward_diagnostics.html">pf_forward_diagnostics()</a></code> to collate diagnostics.</p>
    </div>
    <div id="overview">
    <h2>Overview</h2>
    <p><code>pf_forward()</code> iterates over time steps, simulating location samples (termed 'particles') that are consistent with the preceding data and a movement model at each time step. At each time step, this process comprises four steps:</p><ol><li><p>A proposal step, in which we propose possible locations for the individual.</p></li>
<li><p>A likelihood step, in which we calculate the likelihood of the data given each proposal.</p></li>
<li><p>A weights step, in which we translate likelihoods into sampling weights.</p></li>
<li><p>A sampling step, in which we (re)sample valid proposal locations using the weights.</p></li>
</ol><p>At the first time step, proposal locations are defined from a large number of 'quadrature points' across a <code><a href="https://rdrr.io/pkg/terra/man/SpatRaster-class.html" class="external-link">SpatRaster</a></code> that defines starting location(s), defined in <code>.dlist$spatial$origin</code> (<code>.dlist$spatial$bathy</code> is used if <code>.dlist$spatial$origin</code> is undefined). <code>NA</code>s/non <code>NA</code>s distinguish possible/impossible locations. For AC*PF algorithm implementations (i.e., implementations that incorporate acoustic data, see Algorithms, below), grid cells beyond acoustic containers are masked. For *DCPF implementations (i.e., implementations that incorporate depth data, see Algorithms, below), it is also desirable if you can, at least approximately, mask grid cells that are incompatible with the first depth observation. At the first time step, up to <code>1e6</code> locations ('quadrature points') are sampled from the <code><a href="https://rdrr.io/pkg/terra/man/SpatRaster-class.html" class="external-link">SpatRaster</a></code>. At each quadrature point, we evaluate likelihoods and calculate weights. <code>.n</code> starting locations (particles) are sampled from the set of quadrature points using the weights.</p>
<p>At subsequent time steps, proposal locations are generated via <code>.rpropose</code> which, by default, is a 'stochastic kick' function that 'kicks' previous particles at random into new locations (in line with the restrictions imposed by a movement model). The benefit of this approach is that it is extremely fast, but in situations in which there are relatively few possible locations for an individual, the approach can work poorly because few kicked particles end up in valid locations. A <code>list</code> of likelihood functions is used to evaluate the likelihood of the data, given each proposal, and filter invalid proposals. During this time, we track how the number and diversity of proposal locations declines, as the data are revealed to be incompatible with selected proposals by successive likelihood functions (see Convergence and diagnostics, below). Likelihoods are translated into weights and <code>.n</code> valid proposals (particles) are resampled, with replacement, using the weights. If the number of unique, valid locations is &lt;= <code>.trial_kick_crit</code>, this process is repeated up to <code>.trial_kick</code> times.</p>
<p>Following the stochastic-kick methodology, if the number of unique, valid locations is &lt;= <code>.trial_sampler_crit</code>, directed sampling is initiated. For each unique, previous location, this methodology identifies the set of reachable cells, given a mobility parameter, and evaluates likelihoods and the probability density of movements into each reachable location (which are used to define sampling weights). <code>.n</code> locations are then directly sampled from the set of valid locations. This approach is expensive in terms of time (since it requires iteration over particles) and memory (since the complete set of valid locations is used for sampling). Particles can be processed in batches for improved speed, up to the limits imposed by available memory (see <code>.control</code>). While this approach is expensive, sampling from the set of valid locations facilitates convergence.</p>
<p>You can opt to use either <code>.rpropose</code> or directed sampling via the <code>.trial_</code> arguments to <code><a href="pf_opt.html">pf_opt_trial()</a></code>. However, in general, it is advisable to permit the algorithm to chop-and-change between methods, depending on the number of valid proposals. This approach benefits from the speed of stochastic kicks, where possible, as well as the improved convergence properties of directed sampling, where required.</p>
<p>Particle rejuvenation is another strategy that is sometimes used to facilitate convergence but this is not currently implemented.</p>
<p>At the end of each time step, if the number of unique, valid locations remains &lt;= <code>.trial_revert_crit</code>, the algorithm can step backwards in time by <code>.trial_revert_steps</code> and try again. This reversion will be attempted up to <code>.trial_revert</code> times. After <code>.trial_revert</code> times, if the algorithm reaches a time step when there are fewer than <code>.trial_revert_crit</code> unique samples, it will produce a <code><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></code>, but attempt to continue the simulation if possible. In the case of convergence failures, you can rerun the simulation from existing outputs, starting from an earlier time step, via <code>.rerun</code>. However, algorithm arguments should remain constant. On algorithm reversions and reruns, particle samplers are replaced but particle diagnostics are always retained.</p>
<p>The algorithm iterates over the time series, proposing and sampling particles as described above. Particle samples can be saved in memory or written to file, alongside particle diagnostics. If the function fails to convergence, a <code><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></code> is returned alongside the outputs up to that time step. Otherwise, the function will continue to the end of the time series.</p>
    </div>
    <div id="algorithms">
    <h2>Algorithms</h2>
    <p>This is highly flexible routine for the reconstruction of the possible locations of an individual through time, given the data up to that time point. By modifying the likelihood functions, it is straightforward to implement the ACPF, DCPF and ACDCPF algorithms introduced by Lavender et al. (2023) for reconstructing movements using (a) acoustic time series, (b) archival time series and (c) acoustic and archival time series. <code>pf_forward()</code> thus replaces (and enhances) the <a href="https://edwardlavender.github.io/flapper/reference/ac.html" class="external-link"><code><a href="https://edwardlavender.github.io/flapper/reference/ac.html" class="external-link">flapper::ac()</a></code></a>, <a href="https://edwardlavender.github.io/flapper/reference/dc.html" class="external-link"><code><a href="https://edwardlavender.github.io/flapper/reference/dc.html" class="external-link">flapper::dc()</a></code></a>, <a href="https://edwardlavender.github.io/flapper/reference/acdc.html" class="external-link"><code><a href="https://edwardlavender.github.io/flapper/reference/acdc.html" class="external-link">flapper::acdc()</a></code></a> and <a href="https://edwardlavender.github.io/flapper/reference/pf.html" class="external-link"><code><a href="https://edwardlavender.github.io/flapper/reference/pf.html" class="external-link">flapper::pf()</a></code></a> functions.</p>
    </div>
    <div id="convergence-and-diagnostics">
    <h2>Convergence and diagnostics</h2>
    <p>While <code>pf_forward()</code> tries hard to reconstruct a complete time series of location samples, algorithm convergence is not guaranteed. The algorithm may reach a dead-end---a time step at which there are no valid locations into which the algorithm can step. This may be due to data errors, incorrect assumptions, insufficient sampling effort or poor tuning-parameter settings. To facilitate diagnosis of the immediate cause of convergence failures, during likelihood evaluations we keep track of 'particle diagnostics', i.e., the number of unique, valid locations before/after each likelihood evaluation alongside other statistics (see <code><a href="pf_diag.html">pf_diag</a></code> and <code><a href="pf_particles-class.html">pf_particles</a></code>).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>The forward filtering--backward sampling algorithm samples locations (particles) that represent the possible locations of an individual through time, accounting for all data and the individual's movement.</p><ul><li><p>To set up data, use <code><a href="pat_setup_data.html">pat_setup_data()</a></code>.</p></li>
<li><p><code>pf_forward()</code> implements the forward filter:</p><ul><li><p>To set up an observations timeline, use <code><a href="pf_setup_obs.html">pf_setup_obs()</a></code>.</p></li>
<li><p>For proposal (movement) models, see <code><a href="pf_propose.html">pf_propose</a></code>.</p></li>
<li><p>For likelihood functions, to evaluate the likelihood of the data at proposal locations, see <code><a href="pf_lik.html">pf_lik</a></code>.</p></li>
<li><p>For sampling functions, to (re)sample plausible proposal locations, see <code><a href="pf_sample.html">pf_sample</a></code>.</p></li>
<li><p>For tuning parameters, see <code><a href="pf_opt.html">pf_opt</a></code>.</p></li>
</ul></li>
<li><p><code><a href="pf_backward_-times.html">pf_backward_*()</a></code> refines outputs from the forward filter:</p><ul><li><p><code><a href="pf_backward_killer.html">pf_backward_killer()</a></code> removes dead-ends;</p></li>
<li><p><code><a href="pf_backward_sampler.html">pf_backward_sampler()</a></code> implements the backward sampler;</p></li>
</ul></li>
<li><p>To reconstruct movement paths from particle samples, use <code><a href="pf_path.html">pf_path()</a></code>.</p></li>
<li><p>To map emergent patterns of space use, use <code><a href="pf_coord.html">pf_coord()</a></code> plus a <code>map_*()</code> function, such as <code><a href="map_pou.html">map_pou()</a></code>, <code><a href="map_dens.html">map_dens()</a></code> and/or <code><a href="map_hr.html">map_hr</a></code><code>_()</code>.</p></li>
<li><p>For additional utilities, see supporting <code>pf_*()</code> functions, such as <code><a href="pf_plot_history.html">pf_plot_history()</a></code>, <code><a href="pf_files.html">pf_files()</a></code> and <code><a href="pf_files.html">pf_files_size()</a></code>.</p></li>
</ul></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Edward Lavender</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dtplyr.tidyverse.org" class="external-link">dtplyr</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: dtplyr</span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Set up forward simulation</span></span></span>
<span class="r-in"><span><span class="co"># Set up data list(see `?pat_setup_data()`)</span></span></span>
<span class="r-in"><span><span class="va">dlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="datasets-algorithms.html">dat_dlist</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Add AC* algorithm layers</span></span></span>
<span class="r-in"><span><span class="va">dlist</span><span class="op">$</span><span class="va">algorithm</span><span class="op">$</span><span class="va">detection_overlaps</span> <span class="op">&lt;-</span> <span class="fu"><a href="acs_setup_detection_overlaps.html">acs_setup_detection_overlaps</a></span><span class="op">(</span><span class="va">dlist</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dlist</span><span class="op">$</span><span class="va">algorithm</span><span class="op">$</span><span class="va">detection_kernels</span>  <span class="op">&lt;-</span> <span class="fu"><a href="acs_setup_detection_kernels.html">acs_setup_detection_kernels</a></span><span class="op">(</span><span class="va">dlist</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::acs_setup_detection_kernels()` called @ 2024-01-21 13:33:32... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Getting receiver-specific kernels (for detection)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Getting receiver-specific inverse kernels... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Getting area-wide kernels (for non-detection)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Geting unique array designs... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Geting area-wide kernels for each array design... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... For design 1/13... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Extracting kernels for active receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Combining kernels... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... For design 2/13... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Extracting kernels for active receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Combining kernels... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... For design 3/13... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Extracting kernels for active receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Combining kernels... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... For design 4/13... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Extracting kernels for active receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Combining kernels... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... For design 5/13... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Extracting kernels for active receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Combining kernels... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... For design 6/13... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Extracting kernels for active receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Combining kernels... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... For design 7/13... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Extracting kernels for active receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Combining kernels... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... For design 8/13... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Extracting kernels for active receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Combining kernels... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... For design 9/13... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Extracting kernels for active receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Combining kernels... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... For design 10/13... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Extracting kernels for active receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Combining kernels... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... For design 11/13... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Extracting kernels for active receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Combining kernels... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... For design 12/13... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Extracting kernels for active receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Combining kernels... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... For design 13/13... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Extracting kernels for active receivers... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... ... Combining kernels... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Processing kernels ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Receiver-specific kernels (1/4)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Receiver-specific inverse kernels (2/4)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Background surfaces (3/4)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Inverse background surfaces (4/4)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Listing outputs ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::acs_setup_detection_kernels()` call ended @ 2024-01-21 13:33:33 (duration: ~1 sec(s)). </span>
<span class="r-in"><span><span class="co"># Set up observations (see `?pf_setup_obs()`)</span></span></span>
<span class="r-in"><span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="datasets-algorithms.html">dat_obs</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (1): Implement ACPF algorithm with default options</span></span></span>
<span class="r-in"><span><span class="co">## Implement simulation</span></span></span>
<span class="r-in"><span><span class="va">pf_lik_acpf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>acs_filter_land <span class="op">=</span> <span class="va">acs_filter_land</span>,</span></span>
<span class="r-in"><span>                    acs_filter_container <span class="op">=</span> <span class="va">acs_filter_container</span>,</span></span>
<span class="r-in"><span>                    pf_lik_ac <span class="op">=</span> <span class="va">pf_lik_ac</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-01-21 13:33:33... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 5: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 6: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 7: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 8: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 9: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 10: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 11: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 12: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 13: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 14: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 15: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 16: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 17: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 18: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 19: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 20: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 21: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 22: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 23: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 24: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 25: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-01-21 13:33:33 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="co">## Examine output object</span></span></span>
<span class="r-in"><span><span class="co"># The function returns a named list:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_pff</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Length Class      Mode   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> history     25     -none-     list   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> diagnostics  8     data.table list   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> internal     1     -none-     list   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> convergence  1     -none-     logical</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time         1     -none-     list   </span>
<span class="r-in"><span><span class="co"># The `history` element contains a list of particle samples</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_pff</span><span class="op">$</span><span class="va">history</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    timestep cell_past x_past y_past cell_now    x_now   y_now        lik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:        1        NA     NA     NA    38709 709342.1 6252707 0.40110642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:        1        NA     NA     NA    39280 709442.1 6252407 0.03625988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:        1        NA     NA     NA    37949 709342.1 6253107 0.55001787</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:        1        NA     NA     NA    38327 709142.1 6252907 0.43553410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:        1        NA     NA     NA    37188 709242.1 6253507 0.39990960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:        1        NA     NA     NA    38899 709342.1 6252607 0.22765307</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        weight</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: 0.40110642</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2: 0.03625988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3: 0.55001787</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4: 0.43553410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5: 0.39990960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6: 0.22765307</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_pff</span><span class="op">$</span><span class="va">history</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    timestep cell_past   x_past  y_past cell_now    x_now   y_now       lik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:        2     38138 709242.1 6253007    38329 709342.1 6252907 0.6375251</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:        2     37566 709042.1 6253307    37377 709142.1 6253407 0.5966094</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:        2     37949 709342.1 6253107    37758 709242.1 6253207 0.6552462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:        2     37568 709242.1 6253307    37375 708942.1 6253407 0.4004600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:        2     37377 709142.1 6253407    37565 708942.1 6253307 0.4777746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:        2     37566 709042.1 6253307    37377 709142.1 6253407 0.5966094</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       weight</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: 0.6375251</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2: 0.5966094</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3: 0.6552462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4: 0.4004600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5: 0.4777746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6: 0.5966094</span>
<span class="r-in"><span><span class="co"># The `diagnostics` element contains data.table of particle diagnostics</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_pff</span><span class="op">$</span><span class="va">diagnostics</span>, <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     iter_m iter_i timestep                component trial   n n_u         ess</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:      1      1        1                 proposal    NA 202 202 0.004950495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:      1      1        1      lik-acs_filter_land    NA 202 202 0.004950495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:      1      1        1 lik-acs_filter_container    NA 202 202 0.004950495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:      1      1        1            lik-pf_lik_ac    NA 177 177 0.078771993</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:      1      1        1            sample-origin     1 100  59 0.047667397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:      1      1        2                 proposal     1 100  71 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:      1      1        2      lik-acs_filter_land     1 100  71 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:      1      1        2 lik-acs_filter_container     1 100  71 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:      1      1        2            lik-pf_lik_ac     1  93  64 0.076772509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:      1      1        2              sample-kick     1 100  40 0.041375092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:      1      1        3                 proposal     1 100  70 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:      1      1        3      lik-acs_filter_land     1 100  70 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:      1      1        3 lik-acs_filter_container     1 100  70 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:      1      1        3            lik-pf_lik_ac     1  98  68 0.059418307</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:      1      1        3              sample-kick     1 100  38 0.035032543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:      1      1        4                 proposal     1 100  61 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:      1      1        4      lik-acs_filter_land     1 100  61 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:      1      1        4 lik-acs_filter_container     1 100  61 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:      1      1        4            lik-pf_lik_ac     1 100  61 0.074706478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:      1      1        4              sample-kick     1 100  36 0.029154371</span>
<span class="r-in"><span><span class="co"># `convergence` records convergence (TRUE/FALSE)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span><span class="op">$</span><span class="va">convergence</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="co"># `time` records timings</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span><span class="op">$</span><span class="va">time</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]$start</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2024-01-21 13:33:33 CET"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]$end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2024-01-21 13:33:33 CET"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]$duration</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time difference of 0.2661881 secs</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (2): Implement DCPF algorithm with default options</span></span></span>
<span class="r-in"><span><span class="co"># Define shallow and depth limits</span></span></span>
<span class="r-in"><span><span class="va">obs</span><span class="op">[</span>, <span class="va">depth_shallow</span> <span class="op">:=</span> <span class="va">depth</span> <span class="op">-</span> <span class="fl">20</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp       date detection_id detection receiver_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:        1 2016-03-17 01:50:00 2016-03-17            1         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:        2 2016-03-17 01:52:00 2016-03-17            2         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:        3 2016-03-17 01:54:00 2016-03-17            3         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:        4 2016-03-17 01:56:00 2016-03-17            3         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:        5 2016-03-17 01:58:00 2016-03-17            4         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:        6 2016-03-17 02:00:00 2016-03-17            5         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:        7 2016-03-17 02:02:00 2016-03-17            5         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:        8 2016-03-17 02:04:00 2016-03-17            6         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:        9 2016-03-17 02:06:00 2016-03-17            7         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:       10 2016-03-17 02:08:00 2016-03-17            8         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:       11 2016-03-17 02:10:00 2016-03-17            9         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:       12 2016-03-17 02:12:00 2016-03-17           10         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:       13 2016-03-17 02:14:00 2016-03-17           11         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:       14 2016-03-17 02:16:00 2016-03-17           12         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:       15 2016-03-17 02:18:00 2016-03-17           13         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:       16 2016-03-17 02:20:00 2016-03-17           14         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:       17 2016-03-17 02:22:00 2016-03-17           15         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:       18 2016-03-17 02:24:00 2016-03-17           16         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:       19 2016-03-17 02:26:00 2016-03-17           16         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:       20 2016-03-17 02:28:00 2016-03-17           16         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:       21 2016-03-17 02:30:00 2016-03-17           17         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:       22 2016-03-17 02:32:00 2016-03-17           18         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:       23 2016-03-17 02:34:00 2016-03-17           18         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:       24 2016-03-17 02:36:00 2016-03-17           18         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:       25 2016-03-17 02:38:00 2016-03-17           18         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp       date detection_id detection receiver_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     receiver_id_next mobility buffer_past buffer_future</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:               26      500         500          1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:               26      500         500          1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:               26      500         500          1500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:               26      500         500          1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:               21      500         500          5000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:               21      500         500          4500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:               21      500         500          4000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:               21      500         500          3500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     receiver_id_next mobility buffer_past buffer_future</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     buffer_future_incl_gamma depth depth_shallow</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:                     1250 73.78         53.78</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:                     1250 73.32         53.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:                     1750 73.32         53.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:                     1250 73.32         53.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:                     1250 73.55         53.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:                     1750 68.70         48.70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:                     1250 72.16         52.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:                     1250 72.85         52.85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:                     1250 73.55         53.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:                     1250 73.32         53.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:                     1250 73.32         53.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:                     1250 73.55         53.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:                     1250 73.32         53.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:                     1250 73.32         53.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:                     1250 73.32         53.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:                     1250 72.39         52.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:                     1250 72.39         52.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:                     2250 72.39         52.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:                     1750 72.39         52.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:                     1250 72.39         52.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:                     1250 72.39         52.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:                     5750 65.23         45.23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:                     5250 73.55         53.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:                     4750 75.16         55.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:                     4250 76.78         56.78</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     buffer_future_incl_gamma depth depth_shallow</span>
<span class="r-in"><span><span class="va">obs</span><span class="op">[</span>, <span class="va">depth_deep</span> <span class="op">:=</span> <span class="va">depth</span> <span class="op">+</span> <span class="fl">20</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp       date detection_id detection receiver_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:        1 2016-03-17 01:50:00 2016-03-17            1         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:        2 2016-03-17 01:52:00 2016-03-17            2         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:        3 2016-03-17 01:54:00 2016-03-17            3         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:        4 2016-03-17 01:56:00 2016-03-17            3         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:        5 2016-03-17 01:58:00 2016-03-17            4         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:        6 2016-03-17 02:00:00 2016-03-17            5         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:        7 2016-03-17 02:02:00 2016-03-17            5         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:        8 2016-03-17 02:04:00 2016-03-17            6         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:        9 2016-03-17 02:06:00 2016-03-17            7         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:       10 2016-03-17 02:08:00 2016-03-17            8         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:       11 2016-03-17 02:10:00 2016-03-17            9         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:       12 2016-03-17 02:12:00 2016-03-17           10         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:       13 2016-03-17 02:14:00 2016-03-17           11         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:       14 2016-03-17 02:16:00 2016-03-17           12         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:       15 2016-03-17 02:18:00 2016-03-17           13         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:       16 2016-03-17 02:20:00 2016-03-17           14         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:       17 2016-03-17 02:22:00 2016-03-17           15         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:       18 2016-03-17 02:24:00 2016-03-17           16         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:       19 2016-03-17 02:26:00 2016-03-17           16         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:       20 2016-03-17 02:28:00 2016-03-17           16         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:       21 2016-03-17 02:30:00 2016-03-17           17         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:       22 2016-03-17 02:32:00 2016-03-17           18         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:       23 2016-03-17 02:34:00 2016-03-17           18         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:       24 2016-03-17 02:36:00 2016-03-17           18         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:       25 2016-03-17 02:38:00 2016-03-17           18         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp       date detection_id detection receiver_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     receiver_id_next mobility buffer_past buffer_future</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:               26      500         500          1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:               26      500         500          1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:               26      500         500          1500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:               26      500         500          1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:               21      500         500          5000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:               21      500         500          4500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:               21      500         500          4000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:               21      500         500          3500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     receiver_id_next mobility buffer_past buffer_future</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     buffer_future_incl_gamma depth depth_shallow depth_deep</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:                     1250 73.78         53.78      93.78</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:                     1250 73.32         53.32      93.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:                     1750 73.32         53.32      93.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:                     1250 73.32         53.32      93.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:                     1250 73.55         53.55      93.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:                     1750 68.70         48.70      88.70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:                     1250 72.16         52.16      92.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:                     1250 72.85         52.85      92.85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:                     1250 73.55         53.55      93.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:                     1250 73.32         53.32      93.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:                     1250 73.32         53.32      93.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:                     1250 73.55         53.55      93.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:                     1250 73.32         53.32      93.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:                     1250 73.32         53.32      93.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:                     1250 73.32         53.32      93.32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:                     1250 72.39         52.39      92.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:                     1250 72.39         52.39      92.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:                     2250 72.39         52.39      92.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:                     1750 72.39         52.39      92.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:                     1250 72.39         52.39      92.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:                     1250 72.39         52.39      92.39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:                     5750 65.23         45.23      85.23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:                     5250 73.55         53.55      93.55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:                     4750 75.16         55.16      95.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:                     4250 76.78         56.78      96.78</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     buffer_future_incl_gamma depth depth_shallow depth_deep</span>
<span class="r-in"><span><span class="co"># (optional) Define origin SpatRaster</span></span></span>
<span class="r-in"><span><span class="va">origin</span> <span class="op">&lt;-</span> <span class="va">dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">bathy</span></span></span>
<span class="r-in"><span><span class="va">origin</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/clamp.html" class="external-link">clamp</a></span><span class="op">(</span><span class="va">origin</span>,</span></span>
<span class="r-in"><span>                       lower <span class="op">=</span> <span class="va">obs</span><span class="op">$</span><span class="va">depth_shallow</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                       upper <span class="op">=</span> <span class="va">obs</span><span class="op">$</span><span class="va">depth_deep</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">origin</span> <span class="op">&lt;-</span> <span class="va">origin</span></span></span>
<span class="r-in"><span><span class="co"># Implement DCPF algorithm</span></span></span>
<span class="r-in"><span><span class="va">pf_lik_dcpf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pf_lik_dc <span class="op">=</span> <span class="va">pf_lik_dc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_dcpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-01-21 13:33:33... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 5: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 6: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 7: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 8: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 9: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 10: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 11: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 12: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 13: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 14: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 15: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 16: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 17: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 18: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 19: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 20: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 21: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 22: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 23: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 24: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 25: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-01-21 13:33:33 (duration: ~0 sec(s)). </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (3): Implement ACDCPF algorithm with default options</span></span></span>
<span class="r-in"><span><span class="va">pf_lik_acdcpf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pf_lik_dc <span class="op">=</span> <span class="va">pf_lik_dc</span>,</span></span>
<span class="r-in"><span>                      acs_filter_container <span class="op">=</span> <span class="va">acs_filter_container</span>,</span></span>
<span class="r-in"><span>                      pf_lik_ac <span class="op">=</span> <span class="va">pf_lik_ac</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acdcpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-01-21 13:33:33... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 5: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 6: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 7: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 8: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 9: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 10: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 11: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 12: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 13: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 14: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 15: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 16: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 17: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 18: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 19: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 20: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 21: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 22: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 23: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 24: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 25: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-01-21 13:33:34 (duration: ~1 sec(s)). </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (4): Customise movement model via `.rpropose` and `.dpropose`</span></span></span>
<span class="r-in"><span><span class="co"># Pass arguments to the default models via `.rargs` &amp; `.dargs`</span></span></span>
<span class="r-in"><span><span class="co"># * For `.rpropose` = `pf_rpropose_kick()`, `.rargs` get passed to</span></span></span>
<span class="r-in"><span><span class="co"># * ... `.rkick` = `rkick()` &gt; `.rstep` = `rstep()` &gt;</span></span></span>
<span class="r-in"><span><span class="co"># * ... `.rlen` = rlen(), `.rang` = rang()</span></span></span>
<span class="r-in"><span><span class="co"># * For `.dpropose` = `pf_dpropose()`, `.dargs` gets passed to</span></span></span>
<span class="r-in"><span><span class="co"># * ... `.dkick` = `dkick()` &gt; `.dstep` = `dstep()` &gt; `.dlen` = `dtruncgamma()`</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># E.g., customise rlen() shape and scale parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="sim_helpers.html">rlen</a></span><span class="op">(</span>.n <span class="op">=</span> <span class="fl">1e5L</span>, .shape <span class="op">=</span> <span class="fl">1</span>, .scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">500</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pf_forward-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .rpropose <span class="op">=</span> <span class="va">pf_rpropose_kick</span>,</span></span>
<span class="r-in"><span>                      .rargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.shape <span class="op">=</span> <span class="fl">1</span>, .scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .dpropose <span class="op">=</span> <span class="va">pf_dpropose</span>,</span></span>
<span class="r-in"><span>                      .dargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.shape <span class="op">=</span> <span class="fl">1</span>, .scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acdcpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .control <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_control</a></span><span class="op">(</span>.sampler_batch_size <span class="op">=</span> <span class="fl">100L</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-01-21 13:33:34... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 5: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 6: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 7: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 8: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 9: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 10: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 11: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 12: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 13: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 14: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 15: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 16: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 17: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 18: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 19: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 20: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 21: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 22: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 23: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 24: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 25: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-01-21 13:33:34 (duration: ~0 sec(s)). </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># E.g., customise rlen() .mobility parameter</span></span></span>
<span class="r-in"><span><span class="co"># &gt; Restricted mobility leads to convergence failure</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .rpropose <span class="op">=</span> <span class="va">pf_rpropose_kick</span>,</span></span>
<span class="r-in"><span>                      .rargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.mobility <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .dpropose <span class="op">=</span> <span class="va">pf_dpropose</span>,</span></span>
<span class="r-in"><span>                      .dargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.mobility <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acdcpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .control <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_control</a></span><span class="op">(</span>.sampler_batch_size <span class="op">=</span> <span class="fl">100L</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-01-21 13:33:34... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 5: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 6: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 7: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 8: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 9: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 10: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 11: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 12: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 13: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 14: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 15: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 16: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 17: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 18: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 19: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 20: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 21: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 22: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 23: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 24: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 25: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-01-21 13:33:34 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="co"># &gt; Sequential steps are &lt; .mobility + grid resolution/2</span></span></span>
<span class="r-in"><span><span class="va">out_pfbk</span> <span class="op">&lt;-</span> <span class="fu"><a href="pf_backward_killer.html">pf_backward_killer</a></span><span class="op">(</span><span class="va">out_pff</span><span class="op">$</span><span class="va">history</span>,</span></span>
<span class="r-in"><span>                               .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_backward_killer()` called @ 2024-01-21 13:33:34... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 25: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[25]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 24: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[23]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 100 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 7 dead ends (93 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 93 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[24]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 23: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[22]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 93 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 19 dead ends (81 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 81 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[23]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 22: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[21]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 81 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 14 dead ends (86 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 86 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[22]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 21: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[20]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 86 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 8 dead ends (92 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 92 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[21]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 20: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[19]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 92 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 16 dead ends (84 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 84 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[20]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 19: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[18]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 84 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 18 dead ends (82 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 82 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[19]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 18: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[17]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 82 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 5 dead ends (95 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 95 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[18]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 17: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[16]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 95 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 7 dead ends (93 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 93 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[17]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 16: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[15]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 93 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 3 dead ends (97 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 97 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[16]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 15: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[14]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 97 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 6 dead ends (94 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 94 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[15]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 14: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[13]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 94 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 12 dead ends (88 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 88 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[14]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 13: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[12]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 88 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 4 dead ends (96 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 96 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[13]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 12: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[11]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 96 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 11 dead ends (89 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 89 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[12]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 11: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[10]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 89 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 12 dead ends (88 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 88 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[11]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 10: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[9]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 88 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 18 dead ends (82 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 82 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[10]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 9: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[8]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 82 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 26 dead ends (74 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 74 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[9]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 8: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[7]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 74 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 22 dead ends (78 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 78 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[8]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 7: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[6]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 78 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 13 dead ends (87 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 87 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[7]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 6: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[5]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 87 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 13 dead ends (87 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 87 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[6]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 5: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[4]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 87 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 5 dead ends (95 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 95 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[5]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[3]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 95 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 15 dead ends (85 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 85 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[4]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[2]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 85 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 13 dead ends (87 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 87 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[3]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Cleaning `.history[[1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Identifying `cell_now` (for the previous step) that match `cell_past` (for the current step)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Input: 87 rows in `.history[[t]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Filtering 24 dead ends (76 remain)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Output: 76 rows in `.history[[t - 1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[2]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Time step 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Recording (cleaned) outputs for `.history[[1]]`... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_backward_killer()` call ended @ 2024-01-21 13:33:34 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="va">out_path</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="pf_path.html">pf_path</a></span><span class="op">(</span><span class="va">out_pfbk</span><span class="op">$</span><span class="va">history</span>, .bathy <span class="op">=</span> <span class="va">dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">bathy</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">path_id</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dist <span class="op">=</span> <span class="fu"><a href="dist_along_path.html">dist_along_path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">cell_x</span>, <span class="va">cell_y</span><span class="op">)</span>, .lonlat <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_path()` called @ 2024-01-21 13:33:34... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Processing history[[1]]... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining chain text... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Evaluating chain text... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Reorientating matrix via pf_path_pivot()... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_path()` call ended @ 2024-01-21 13:33:34 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">out_path</span><span class="op">$</span><span class="va">dist</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&lt;</span></span></span>
<span class="r-in"><span>  <span class="fl">100</span> <span class="op">+</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">res</a></span><span class="op">(</span><span class="va">dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">bathy</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## E.g. customise rlen() and dlen() models</span></span></span>
<span class="r-in"><span><span class="co"># Write a new model with step lengths simulated from a lognormal distribution</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">1e6L</span>, meanlog <span class="op">=</span> <span class="fl">5</span>, sdlog <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">500</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pf_forward-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .rpropose <span class="op">=</span> <span class="va">pf_rpropose_kick</span>,</span></span>
<span class="r-in"><span>                      .dpropose <span class="op">=</span> <span class="va">pf_dpropose</span>,</span></span>
<span class="r-in"><span>                      .rargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.rlen <span class="op">=</span> <span class="va">rlnorm</span>, meanlog <span class="op">=</span> <span class="fl">5</span>, sdlog <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .dargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.dlen <span class="op">=</span> <span class="va">dlnorm</span>, meanlog <span class="op">=</span> <span class="fl">5</span>, sdlog <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acdcpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .control <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_control</a></span><span class="op">(</span>.sampler_batch_size <span class="op">=</span> <span class="fl">100L</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-01-21 13:33:34... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 5: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 6: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 7: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 8: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 9: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 10: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 11: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 12: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 13: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 14: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 15: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 16: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 17: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 18: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 19: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 20: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 21: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 22: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 23: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 24: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 25: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-01-21 13:33:35 (duration: ~1 sec(s)). </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (5): Customise likelihood</span></span></span>
<span class="r-in"><span><span class="co"># We can implement different algorithms by modifying the .likelihood list (above)</span></span></span>
<span class="r-in"><span><span class="co"># We can also write custom likelihood functions</span></span></span>
<span class="r-in"><span><span class="co"># As an example, we will imagine we have observed temperatures every two minutes</span></span></span>
<span class="r-in"><span><span class="va">obs</span><span class="op">[</span>, <span class="va">temp</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">.N</span>, <span class="fl">7</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp       date detection_id detection receiver_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:        1 2016-03-17 01:50:00 2016-03-17            1         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:        2 2016-03-17 01:52:00 2016-03-17            2         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:        3 2016-03-17 01:54:00 2016-03-17            3         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:        4 2016-03-17 01:56:00 2016-03-17            3         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:        5 2016-03-17 01:58:00 2016-03-17            4         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:        6 2016-03-17 02:00:00 2016-03-17            5         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:        7 2016-03-17 02:02:00 2016-03-17            5         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:        8 2016-03-17 02:04:00 2016-03-17            6         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:        9 2016-03-17 02:06:00 2016-03-17            7         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:       10 2016-03-17 02:08:00 2016-03-17            8         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:       11 2016-03-17 02:10:00 2016-03-17            9         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:       12 2016-03-17 02:12:00 2016-03-17           10         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:       13 2016-03-17 02:14:00 2016-03-17           11         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:       14 2016-03-17 02:16:00 2016-03-17           12         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:       15 2016-03-17 02:18:00 2016-03-17           13         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:       16 2016-03-17 02:20:00 2016-03-17           14         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:       17 2016-03-17 02:22:00 2016-03-17           15         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:       18 2016-03-17 02:24:00 2016-03-17           16         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:       19 2016-03-17 02:26:00 2016-03-17           16         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:       20 2016-03-17 02:28:00 2016-03-17           16         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:       21 2016-03-17 02:30:00 2016-03-17           17         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:       22 2016-03-17 02:32:00 2016-03-17           18         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:       23 2016-03-17 02:34:00 2016-03-17           18         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:       24 2016-03-17 02:36:00 2016-03-17           18         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:       25 2016-03-17 02:38:00 2016-03-17           18         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp       date detection_id detection receiver_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     receiver_id_next mobility buffer_past buffer_future</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:               26      500         500          1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:               26      500         500          1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:               26      500         500          1500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:               26      500         500          1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:               21      500         500          5000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:               21      500         500          4500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:               21      500         500          4000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:               21      500         500          3500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     receiver_id_next mobility buffer_past buffer_future</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     buffer_future_incl_gamma depth depth_shallow depth_deep     temp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:                     1250 73.78         53.78      93.78 7.086510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:                     1250 73.32         53.32      93.32 7.024533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:                     1750 73.32         53.32      93.32 8.282159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:                     1250 73.32         53.32      93.32 6.839149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:                     1250 73.55         53.55      93.55 5.393472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:                     1750 68.70         48.70      88.70 7.747349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:                     1250 72.16         52.16      92.16 6.518981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:                     1250 72.85         52.85      92.85 7.332639</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:                     1250 73.55         53.55      93.55 7.552591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:                     1250 73.32         53.32      93.32 7.002062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:                     1250 73.32         53.32      93.32 8.262998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:                     1250 73.55         53.55      93.55 6.197458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:                     1250 73.32         53.32      93.32 5.667899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:                     1250 73.32         53.32      93.32 6.779726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:                     1250 73.32         53.32      93.32 8.404868</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:                     1250 72.39         52.39      92.39 8.929612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:                     1250 72.39         52.39      92.39 6.691907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:                     2250 72.39         52.39      92.39 6.364719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:                     1750 72.39         52.39      92.39 4.226425</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:                     1250 72.39         52.39      92.39 6.235429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:                     1250 72.39         52.39      92.39 4.983954</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:                     5750 65.23         45.23      85.23 6.510819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:                     5250 73.55         53.55      93.55 7.609492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:                     4750 75.16         55.16      95.16 7.573493</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:                     4250 76.78         56.78      96.78 6.161920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     buffer_future_incl_gamma depth depth_shallow depth_deep     temp</span>
<span class="r-in"><span><span class="va">obs</span><span class="op">[</span>, <span class="va">temp_cool</span> <span class="op">:=</span> <span class="va">temp</span> <span class="op">-</span> <span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp       date detection_id detection receiver_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:        1 2016-03-17 01:50:00 2016-03-17            1         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:        2 2016-03-17 01:52:00 2016-03-17            2         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:        3 2016-03-17 01:54:00 2016-03-17            3         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:        4 2016-03-17 01:56:00 2016-03-17            3         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:        5 2016-03-17 01:58:00 2016-03-17            4         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:        6 2016-03-17 02:00:00 2016-03-17            5         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:        7 2016-03-17 02:02:00 2016-03-17            5         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:        8 2016-03-17 02:04:00 2016-03-17            6         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:        9 2016-03-17 02:06:00 2016-03-17            7         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:       10 2016-03-17 02:08:00 2016-03-17            8         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:       11 2016-03-17 02:10:00 2016-03-17            9         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:       12 2016-03-17 02:12:00 2016-03-17           10         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:       13 2016-03-17 02:14:00 2016-03-17           11         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:       14 2016-03-17 02:16:00 2016-03-17           12         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:       15 2016-03-17 02:18:00 2016-03-17           13         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:       16 2016-03-17 02:20:00 2016-03-17           14         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:       17 2016-03-17 02:22:00 2016-03-17           15         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:       18 2016-03-17 02:24:00 2016-03-17           16         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:       19 2016-03-17 02:26:00 2016-03-17           16         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:       20 2016-03-17 02:28:00 2016-03-17           16         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:       21 2016-03-17 02:30:00 2016-03-17           17         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:       22 2016-03-17 02:32:00 2016-03-17           18         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:       23 2016-03-17 02:34:00 2016-03-17           18         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:       24 2016-03-17 02:36:00 2016-03-17           18         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:       25 2016-03-17 02:38:00 2016-03-17           18         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp       date detection_id detection receiver_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     receiver_id_next mobility buffer_past buffer_future</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:               26      500         500          1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:               26      500         500          1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:               26      500         500          1500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:               26      500         500          1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:               21      500         500          5000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:               21      500         500          4500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:               21      500         500          4000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:               21      500         500          3500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     receiver_id_next mobility buffer_past buffer_future</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     buffer_future_incl_gamma depth depth_shallow depth_deep     temp temp_cool</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:                     1250 73.78         53.78      93.78 7.086510  5.086510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:                     1250 73.32         53.32      93.32 7.024533  5.024533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:                     1750 73.32         53.32      93.32 8.282159  6.282159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:                     1250 73.32         53.32      93.32 6.839149  4.839149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:                     1250 73.55         53.55      93.55 5.393472  3.393472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:                     1750 68.70         48.70      88.70 7.747349  5.747349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:                     1250 72.16         52.16      92.16 6.518981  4.518981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:                     1250 72.85         52.85      92.85 7.332639  5.332639</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:                     1250 73.55         53.55      93.55 7.552591  5.552591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:                     1250 73.32         53.32      93.32 7.002062  5.002062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:                     1250 73.32         53.32      93.32 8.262998  6.262998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:                     1250 73.55         53.55      93.55 6.197458  4.197458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:                     1250 73.32         53.32      93.32 5.667899  3.667899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:                     1250 73.32         53.32      93.32 6.779726  4.779726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:                     1250 73.32         53.32      93.32 8.404868  6.404868</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:                     1250 72.39         52.39      92.39 8.929612  6.929612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:                     1250 72.39         52.39      92.39 6.691907  4.691907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:                     2250 72.39         52.39      92.39 6.364719  4.364719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:                     1750 72.39         52.39      92.39 4.226425  2.226425</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:                     1250 72.39         52.39      92.39 6.235429  4.235429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:                     1250 72.39         52.39      92.39 4.983954  2.983954</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:                     5750 65.23         45.23      85.23 6.510819  4.510819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:                     5250 73.55         53.55      93.55 7.609492  5.609492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:                     4750 75.16         55.16      95.16 7.573493  5.573493</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:                     4250 76.78         56.78      96.78 6.161920  4.161920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     buffer_future_incl_gamma depth depth_shallow depth_deep     temp temp_cool</span>
<span class="r-in"><span><span class="va">obs</span><span class="op">[</span>, <span class="va">temp_warm</span> <span class="op">:=</span> <span class="va">temp</span> <span class="op">+</span> <span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp       date detection_id detection receiver_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:        1 2016-03-17 01:50:00 2016-03-17            1         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:        2 2016-03-17 01:52:00 2016-03-17            2         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:        3 2016-03-17 01:54:00 2016-03-17            3         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:        4 2016-03-17 01:56:00 2016-03-17            3         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:        5 2016-03-17 01:58:00 2016-03-17            4         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:        6 2016-03-17 02:00:00 2016-03-17            5         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:        7 2016-03-17 02:02:00 2016-03-17            5         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:        8 2016-03-17 02:04:00 2016-03-17            6         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:        9 2016-03-17 02:06:00 2016-03-17            7         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:       10 2016-03-17 02:08:00 2016-03-17            8         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:       11 2016-03-17 02:10:00 2016-03-17            9         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:       12 2016-03-17 02:12:00 2016-03-17           10         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:       13 2016-03-17 02:14:00 2016-03-17           11         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:       14 2016-03-17 02:16:00 2016-03-17           12         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:       15 2016-03-17 02:18:00 2016-03-17           13         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:       16 2016-03-17 02:20:00 2016-03-17           14         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:       17 2016-03-17 02:22:00 2016-03-17           15         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:       18 2016-03-17 02:24:00 2016-03-17           16         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:       19 2016-03-17 02:26:00 2016-03-17           16         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:       20 2016-03-17 02:28:00 2016-03-17           16         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:       21 2016-03-17 02:30:00 2016-03-17           17         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:       22 2016-03-17 02:32:00 2016-03-17           18         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:       23 2016-03-17 02:34:00 2016-03-17           18         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:       24 2016-03-17 02:36:00 2016-03-17           18         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:       25 2016-03-17 02:38:00 2016-03-17           18         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp       date detection_id detection receiver_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     receiver_id_next mobility buffer_past buffer_future</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:               26      500         500          1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:               26      500         500          1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:               26      500         500          1500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:               26      500         500          1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:               21      500         500          5000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:               21      500         500          4500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:               21      500         500          4000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:               21      500         500          3500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     receiver_id_next mobility buffer_past buffer_future</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     buffer_future_incl_gamma depth depth_shallow depth_deep     temp temp_cool</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:                     1250 73.78         53.78      93.78 7.086510  5.086510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:                     1250 73.32         53.32      93.32 7.024533  5.024533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:                     1750 73.32         53.32      93.32 8.282159  6.282159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:                     1250 73.32         53.32      93.32 6.839149  4.839149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:                     1250 73.55         53.55      93.55 5.393472  3.393472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:                     1750 68.70         48.70      88.70 7.747349  5.747349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:                     1250 72.16         52.16      92.16 6.518981  4.518981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:                     1250 72.85         52.85      92.85 7.332639  5.332639</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:                     1250 73.55         53.55      93.55 7.552591  5.552591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:                     1250 73.32         53.32      93.32 7.002062  5.002062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:                     1250 73.32         53.32      93.32 8.262998  6.262998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:                     1250 73.55         53.55      93.55 6.197458  4.197458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:                     1250 73.32         53.32      93.32 5.667899  3.667899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:                     1250 73.32         53.32      93.32 6.779726  4.779726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:                     1250 73.32         53.32      93.32 8.404868  6.404868</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:                     1250 72.39         52.39      92.39 8.929612  6.929612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:                     1250 72.39         52.39      92.39 6.691907  4.691907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:                     2250 72.39         52.39      92.39 6.364719  4.364719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:                     1750 72.39         52.39      92.39 4.226425  2.226425</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:                     1250 72.39         52.39      92.39 6.235429  4.235429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:                     1250 72.39         52.39      92.39 4.983954  2.983954</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:                     5750 65.23         45.23      85.23 6.510819  4.510819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:                     5250 73.55         53.55      93.55 7.609492  5.609492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:                     4750 75.16         55.16      95.16 7.573493  5.573493</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:                     4250 76.78         56.78      96.78 6.161920  4.161920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     buffer_future_incl_gamma depth depth_shallow depth_deep     temp temp_cool</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     temp_warm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:  9.086510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:  9.024533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3: 10.282159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:  8.839149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:  7.393472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:  9.747349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:  8.518981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:  9.332639</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:  9.552591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:  9.002062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11: 10.262998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:  8.197458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:  7.667899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:  8.779726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15: 10.404868</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16: 10.929612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:  8.691907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:  8.364719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:  6.226425</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:  8.235429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:  6.983954</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:  8.510819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:  9.609492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:  9.573493</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:  8.161920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     temp_warm</span>
<span class="r-in"><span><span class="co"># We will also imagine we have hourly temperature data across the study area</span></span></span>
<span class="r-in"><span><span class="co"># (e.g., from a hydrodynamic model)</span></span></span>
<span class="r-in"><span><span class="va">obs</span><span class="op">[</span>, <span class="va">hour</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">timestamp</span>, <span class="st">"hour"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp       date detection_id detection receiver_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:        1 2016-03-17 01:50:00 2016-03-17            1         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:        2 2016-03-17 01:52:00 2016-03-17            2         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:        3 2016-03-17 01:54:00 2016-03-17            3         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:        4 2016-03-17 01:56:00 2016-03-17            3         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:        5 2016-03-17 01:58:00 2016-03-17            4         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:        6 2016-03-17 02:00:00 2016-03-17            5         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:        7 2016-03-17 02:02:00 2016-03-17            5         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:        8 2016-03-17 02:04:00 2016-03-17            6         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:        9 2016-03-17 02:06:00 2016-03-17            7         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:       10 2016-03-17 02:08:00 2016-03-17            8         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:       11 2016-03-17 02:10:00 2016-03-17            9         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:       12 2016-03-17 02:12:00 2016-03-17           10         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:       13 2016-03-17 02:14:00 2016-03-17           11         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:       14 2016-03-17 02:16:00 2016-03-17           12         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:       15 2016-03-17 02:18:00 2016-03-17           13         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:       16 2016-03-17 02:20:00 2016-03-17           14         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:       17 2016-03-17 02:22:00 2016-03-17           15         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:       18 2016-03-17 02:24:00 2016-03-17           16         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:       19 2016-03-17 02:26:00 2016-03-17           16         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:       20 2016-03-17 02:28:00 2016-03-17           16         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:       21 2016-03-17 02:30:00 2016-03-17           17         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:       22 2016-03-17 02:32:00 2016-03-17           18         1          26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:       23 2016-03-17 02:34:00 2016-03-17           18         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:       24 2016-03-17 02:36:00 2016-03-17           18         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:       25 2016-03-17 02:38:00 2016-03-17           18         0            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp       date detection_id detection receiver_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     receiver_id_next mobility buffer_past buffer_future</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:               26      500         500          1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:               26      500         500          1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:               26      500         500          1500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:               26      500         500          1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:               26      500         500           500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:               21      500         500          5000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:               21      500         500          4500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:               21      500         500          4000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:               21      500         500          3500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     receiver_id_next mobility buffer_past buffer_future</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     buffer_future_incl_gamma depth depth_shallow depth_deep     temp temp_cool</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:                     1250 73.78         53.78      93.78 7.086510  5.086510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:                     1250 73.32         53.32      93.32 7.024533  5.024533</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:                     1750 73.32         53.32      93.32 8.282159  6.282159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:                     1250 73.32         53.32      93.32 6.839149  4.839149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:                     1250 73.55         53.55      93.55 5.393472  3.393472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:                     1750 68.70         48.70      88.70 7.747349  5.747349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:                     1250 72.16         52.16      92.16 6.518981  4.518981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:                     1250 72.85         52.85      92.85 7.332639  5.332639</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:                     1250 73.55         53.55      93.55 7.552591  5.552591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:                     1250 73.32         53.32      93.32 7.002062  5.002062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:                     1250 73.32         53.32      93.32 8.262998  6.262998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:                     1250 73.55         53.55      93.55 6.197458  4.197458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:                     1250 73.32         53.32      93.32 5.667899  3.667899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:                     1250 73.32         53.32      93.32 6.779726  4.779726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:                     1250 73.32         53.32      93.32 8.404868  6.404868</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:                     1250 72.39         52.39      92.39 8.929612  6.929612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:                     1250 72.39         52.39      92.39 6.691907  4.691907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:                     2250 72.39         52.39      92.39 6.364719  4.364719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:                     1750 72.39         52.39      92.39 4.226425  2.226425</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:                     1250 72.39         52.39      92.39 6.235429  4.235429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:                     1250 72.39         52.39      92.39 4.983954  2.983954</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:                     5750 65.23         45.23      85.23 6.510819  4.510819</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:                     5250 73.55         53.55      93.55 7.609492  5.609492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:                     4750 75.16         55.16      95.16 7.573493  5.573493</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:                     4250 76.78         56.78      96.78 6.161920  4.161920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     buffer_future_incl_gamma depth depth_shallow depth_deep     temp temp_cool</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     temp_warm hour</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:  9.086510    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:  9.024533    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3: 10.282159    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:  8.839149    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:  7.393472    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:  9.747349    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:  8.518981    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:  9.332639    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:  9.552591    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:  9.002062    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11: 10.262998    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:  8.197458    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:  7.667899    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:  8.779726    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15: 10.404868    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16: 10.929612    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:  8.691907    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:  8.364719    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:  6.226425    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:  8.235429    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:  6.983954    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:  8.510819    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:  9.609492    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:  9.573493    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:  8.161920    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     temp_warm hour</span>
<span class="r-in"><span><span class="va">hours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">obs</span><span class="op">$</span><span class="va">hour</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/setValues.html" class="external-link">setValues</a></span><span class="op">(</span><span class="va">dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">bathy</span>, <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nc</span>   <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">temps</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="va">hours</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">hour</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nc</span>, <span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">hydro</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/setValues.html" class="external-link">setValues</a></span><span class="op">(</span><span class="va">grid</span>, <span class="va">vals</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/mask.html" class="external-link">mask</a></span><span class="op">(</span><span class="va">hydro</span>, <span class="va">dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">bathy</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">temps</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">hours</span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">temps</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pf_forward-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">temps</span></span></span>
<span class="r-in"><span><span class="co"># Define the likelihood of the temp data given location proposals</span></span></span>
<span class="r-in"><span><span class="va">pf_lik_temp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.particles</span>, <span class="va">.obs</span>, <span class="va">.t</span>, <span class="va">.dlist</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># Extract temps</span></span></span>
<span class="r-in"><span>  <span class="va">temp</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span>  <span class="va">locs</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">.particles</span><span class="op">$</span><span class="va">x_now</span>, <span class="va">.particles</span><span class="op">$</span><span class="va">y_now</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">.particles</span><span class="op">[</span>, <span class="va">temp</span> <span class="op">:=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/extract.html" class="external-link">extract</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">temp</span>,</span></span>
<span class="r-in"><span>                                      y <span class="op">=</span> <span class="va">locs</span>,</span></span>
<span class="r-in"><span>                                      layer <span class="op">=</span> <span class="va">.obs</span><span class="op">$</span><span class="va">hour</span><span class="op">[</span><span class="va">.t</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">value</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="co"># Calculate temp likelihood</span></span></span>
<span class="r-in"><span>  <span class="co"># * We use a simple binary model for illustration</span></span></span>
<span class="r-in"><span>  <span class="co"># * Under this model, temperature observations that are not</span></span></span>
<span class="r-in"><span>  <span class="co"># * ... within a cool/warm limit are impossible</span></span></span>
<span class="r-in"><span>  <span class="va">.particles</span><span class="op">[</span>, <span class="va">lik_temp</span> <span class="op">:=</span> <span class="op">(</span><span class="va">temp</span> <span class="op">&gt;=</span> <span class="va">.obs</span><span class="op">$</span><span class="va">temp_cool</span><span class="op">[</span><span class="va">.t</span><span class="op">]</span> <span class="op">&amp;</span></span></span>
<span class="r-in"><span>                              <span class="va">temp</span> <span class="op">&lt;=</span> <span class="va">.obs</span><span class="op">$</span><span class="va">temp_warm</span><span class="op">[</span><span class="va">.t</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0</span>, <span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="co"># Update likelihood &amp; filter impossible locations</span></span></span>
<span class="r-in"><span>  <span class="va">lik</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span>  <span class="va">.particles</span><span class="op">[</span>, <span class="va">lik</span> <span class="op">:=</span> <span class="va">lik</span> <span class="op">*</span> <span class="va">lik_temp</span><span class="op">]</span><span class="op">[</span><span class="va">lik</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># Run simulation accounting for temperature data only</span></span></span>
<span class="r-in"><span><span class="va">dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">origin</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pf_lik_temp <span class="op">=</span> <span class="va">pf_lik_temp</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-01-21 13:33:35... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 5: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 6: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 7: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 8: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 9: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 10: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 11: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 12: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 13: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 14: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 15: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 16: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 17: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 18: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 19: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 20: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 21: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 22: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 23: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 24: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 25: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-01-21 13:33:35 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="co"># Run simulation accounting for multiple datasets</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pf_lik_ac <span class="op">=</span> <span class="va">pf_lik_ac</span>,</span></span>
<span class="r-in"><span>                                         pf_lik_temp <span class="op">=</span> <span class="va">pf_lik_temp</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-01-21 13:33:35... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 5: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 6: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 7: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 8: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 9: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 10: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 11: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 12: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 13: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 14: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 15: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 16: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 17: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 18: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 19: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 20: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 21: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 22: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 23: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 24: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 25: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-01-21 13:33:35 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="co"># Note that the temperature likelihood (deliberately) has no influence here:</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span><span class="op">$</span><span class="va">diagnostics</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      iter_m iter_i timestep       component trial   n n_u         ess</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:      1      1        1        proposal    NA 202 202 0.004950495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:      1      1        1   lik-pf_lik_ac    NA 177 177 0.078771993</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:      1      1        1 lik-pf_lik_temp    NA 167 167 0.086303804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:      1      1        1   sample-origin     1 100  56 0.048698966</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:      1      1        2        proposal     1 100  71 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   6:      1      1        2   lik-pf_lik_ac     1  94  67 0.073251000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   7:      1      1        2 lik-pf_lik_temp     1  88  64 0.078192190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   8:      1      1        2     sample-kick     1 100  39 0.041675693</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9:      1      1        3        proposal     1 100  62 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  10:      1      1        3   lik-pf_lik_ac     1  99  61 0.054137184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  11:      1      1        3 lik-pf_lik_temp     1  76  49 0.069801486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  12:      1      1        3     sample-kick     1 100  31 0.033820017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  13:      1      1        4        proposal     1 100  64 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  14:      1      1        4   lik-pf_lik_ac     1 100  64 0.074710630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  15:      1      1        4 lik-pf_lik_temp     1  95  61 0.080888439</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  16:      1      1        4     sample-kick     1 100  40 0.028577891</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  17:      1      1        5        proposal     1 100  84 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  18:      1      1        5   lik-pf_lik_ac     1  89  73 0.136116936</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  19:      1      1        5 lik-pf_lik_temp     1  57  46 0.202993492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  20:      1      1        5     sample-kick     1 100  30 0.058440232</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  21:      1      1        6        proposal     1 100  64 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  22:      1      1        6   lik-pf_lik_ac     1  96  60 0.082581809</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  23:      1      1        6 lik-pf_lik_temp     1  84  54 0.098865981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  24:      1      1        6     sample-kick     1 100  33 0.039419902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  25:      1      1        7        proposal     1 100  66 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  26:      1      1        7   lik-pf_lik_ac     1 100  66 0.049573643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  27:      1      1        7 lik-pf_lik_temp     1  95  62 0.049822375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  28:      1      1        7     sample-kick     1 100  39 0.018810422</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  29:      1      1        8        proposal     1 100  70 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  30:      1      1        8   lik-pf_lik_ac     1  76  53 0.163854697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  31:      1      1        8 lik-pf_lik_temp     1  74  52 0.163863433</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  32:      1      1        8     sample-kick     1 100  37 0.079134564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  33:      1      1        9        proposal     1 100  70 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  34:      1      1        9   lik-pf_lik_ac     1  90  62 0.098001003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  35:      1      1        9 lik-pf_lik_temp     1  83  57 0.111314850</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  36:      1      1        9     sample-kick     1 100  39 0.050878494</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  37:      1      1       10        proposal     1 100  68 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  38:      1      1       10   lik-pf_lik_ac     1  98  66 0.065886876</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  39:      1      1       10 lik-pf_lik_temp     1  95  64 0.069128120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  40:      1      1       10     sample-kick     1 100  36 0.037350132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  41:      1      1       11        proposal     1 100  61 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  42:      1      1       11   lik-pf_lik_ac     1  98  59 0.056811297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  43:      1      1       11 lik-pf_lik_temp     1  75  47 0.067823803</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  44:      1      1       11     sample-kick     1 100  32 0.038349058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  45:      1      1       12        proposal     1 100  62 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  46:      1      1       12   lik-pf_lik_ac     1  99  61 0.051902884</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  47:      1      1       12 lik-pf_lik_temp     1  90  56 0.057699908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  48:      1      1       12     sample-kick     1 100  36 0.033725405</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  49:      1      1       13        proposal     1 100  61 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  50:      1      1       13   lik-pf_lik_ac     1  97  58 0.053091360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  51:      1      1       13 lik-pf_lik_temp     1  74  46 0.063924368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  52:      1      1       13     sample-kick     1 100  29 0.033886078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  53:      1      1       14        proposal     1 100  60 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  54:      1      1       14   lik-pf_lik_ac     1 100  60 0.051252519</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  55:      1      1       14 lik-pf_lik_temp     1  95  58 0.056717924</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  56:      1      1       14     sample-kick     1 100  32 0.033242540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  57:      1      1       15        proposal     1 100  57 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  58:      1      1       15   lik-pf_lik_ac     1 100  57 0.050383968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  59:      1      1       15 lik-pf_lik_temp     1  69  38 0.073622799</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  60:      1      1       15     sample-kick     1 100  21 0.032994853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  61:      1      1       16        proposal     1 100  59 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  62:      1      1       16   lik-pf_lik_ac     1 100  59 0.053090017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  63:      1      1       16 lik-pf_lik_temp     1  60  32 0.093196092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  64:      1      1       16     sample-kick     1 100  25 0.041934164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  65:      1      1       17        proposal     1 100  65 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  66:      1      1       17   lik-pf_lik_ac     1  98  63 0.057645114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  67:      1      1       17 lik-pf_lik_temp     1  97  62 0.058852005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  68:      1      1       17     sample-kick     1 100  40 0.039568553</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  69:      1      1       18        proposal     1 100  60 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  70:      1      1       18   lik-pf_lik_ac     1  99  59 0.061827947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  71:      1      1       18 lik-pf_lik_temp     1  92  55 0.069017763</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  72:      1      1       18     sample-kick     1 100  35 0.036107158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  73:      1      1       19        proposal     1 100  66 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  74:      1      1       19   lik-pf_lik_ac     1 100  66 0.067323381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  75:      1      1       19 lik-pf_lik_temp     1  23  16 0.309351561</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  76:      1      1       19     sample-kick     1 100  15 0.028534466</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  77:      1      1       20        proposal     1 100  67 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  78:      1      1       20   lik-pf_lik_ac     1 100  67 0.023659875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  79:      1      1       20 lik-pf_lik_temp     1  86  59 0.028567443</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  80:      1      1       20     sample-kick     1 100  31 0.014065376</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  81:      1      1       21        proposal     1 100  71 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  82:      1      1       21   lik-pf_lik_ac     1  64  38 0.164739202</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  83:      1      1       21 lik-pf_lik_temp     1  25  18 0.298166744</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  84:      1      1       21     sample-kick     1 100  16 0.047983043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  85:      1      1       22        proposal     1 100  54 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  86:      1      1       22   lik-pf_lik_ac     1  99  53 0.059629051</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  87:      1      1       22 lik-pf_lik_temp     1  92  49 0.067986561</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  88:      1      1       22     sample-kick     1 100  32 0.035893268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  89:      1      1       23        proposal     1 100  58 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  90:      1      1       23   lik-pf_lik_ac     1 100  58 0.058140826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  91:      1      1       23 lik-pf_lik_temp     1  85  51 0.066330886</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  92:      1      1       23     sample-kick     1 100  34 0.023523726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  93:      1      1       24        proposal     1 100  78 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  94:      1      1       24   lik-pf_lik_ac     1 100  78 0.022345170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  95:      1      1       24 lik-pf_lik_temp     1  96  74 0.022553930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  96:      1      1       24     sample-kick     1 100  50 0.015307144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  97:      1      1       25        proposal     1 100  76 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  98:      1      1       25   lik-pf_lik_ac     1 100  76 0.018081757</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  99:      1      1       25 lik-pf_lik_temp     1  84  66 0.022219543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100:      1      1       25     sample-kick     1 100  43 0.014830235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      iter_m iter_i timestep       component trial   n n_u         ess</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (6): Customise (re)sampling</span></span></span>
<span class="r-in"><span><span class="co"># Adjust the number of particles</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                      .n <span class="op">=</span> <span class="fl">1000L</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-01-21 13:33:35... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 5: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 6: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 7: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 8: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 9: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 10: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 11: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 12: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 13: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 14: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 15: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 16: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 17: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 18: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 19: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 20: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 21: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 22: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 23: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 24: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 25: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-01-21 13:33:35 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">out_pff</span><span class="op">$</span><span class="va">history</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1000</span>
<span class="r-in"><span><span class="co"># Use systematic resampling</span></span></span>
<span class="r-in"><span><span class="co"># * This triggers directed sampling, so we boost sampler_batch_size for improved speed</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                      .sample <span class="op">=</span> <span class="va">pf_sample_systematic</span>,</span></span>
<span class="r-in"><span>                      .control <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_control</a></span><span class="op">(</span>.sampler_batch_size <span class="op">=</span> <span class="fl">100L</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-01-21 13:33:35... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 5: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 6: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 7: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 8: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 9: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 10: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 11: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 12: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 13: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 14: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 15: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 16: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 17: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 18: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 19: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 20: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 21: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 22: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 23: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 24: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 25: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Using directed sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-01-21 13:33:42 (duration: ~7 sec(s)). </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (7): Control convergence via `.trial_` arguments</span></span></span>
<span class="r-in"><span><span class="co"># See `vignette("c-demos", package = "patter")` for detailed examples</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (8): Rerun the algorithm from an earlier time step</span></span></span>
<span class="r-in"><span><span class="co"># This is only sensible in the case of a convergence failure,</span></span></span>
<span class="r-in"><span><span class="co"># but for demonstration purposes:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff_1</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-01-21 13:33:42... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 5: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 6: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 7: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 8: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 9: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 10: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 11: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 12: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 13: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 14: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 15: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 16: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 17: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 18: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 19: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 20: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 21: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 22: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 23: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 24: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 25: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-01-21 13:33:42 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff_2</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                        .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                        .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                        .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        .rerun <span class="op">=</span> <span class="va">out_pff_1</span>, .rerun_from <span class="op">=</span> <span class="fl">5L</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-01-21 13:33:42... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 5: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 6: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 7: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 8: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 9: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 10: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 11: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 12: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 13: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 14: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 15: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 16: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 17: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 18: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 19: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 20: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 21: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 22: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 23: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 24: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 25: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-01-21 13:33:42 (duration: ~0 sec(s)). </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (9): Adjust record options</span></span></span>
<span class="r-in"><span><span class="co"># Use `sink` to write to particles to file (recommended)</span></span></span>
<span class="r-in"><span><span class="va">pff_folder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"forward"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">pff_folder</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">FALSE</span>, .sink <span class="op">=</span> <span class="va">pff_folder</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-01-21 13:33:42... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 5: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 6: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 7: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 8: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 9: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 10: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 11: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 12: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 13: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 14: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 15: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 16: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 17: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 18: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 19: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 20: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 21: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 22: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 23: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 24: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 25: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-01-21 13:33:43 (duration: ~1 sec(s)). </span>
<span class="r-in"><span><span class="co"># &gt; `save = FALSE` suppresses outputs in memory:</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span><span class="op">$</span><span class="va">history</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> list()</span>
<span class="r-in"><span><span class="va">out_pff</span><span class="op">$</span><span class="va">diagnostics</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-in"><span><span class="co"># &gt; `sink` directs outputs to file:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">pff_folder</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "diagnostics" "history"    </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="pf_files.html">pf_files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">pff_folder</span>, <span class="st">"history"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/var/folders/nl/ygb3g6tj24z06jddbqqhj6hw0000gn/T//RtmpQu3F7r/forward/history/1.parquet"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/var/folders/nl/ygb3g6tj24z06jddbqqhj6hw0000gn/T//RtmpQu3F7r/forward/history/2.parquet"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/var/folders/nl/ygb3g6tj24z06jddbqqhj6hw0000gn/T//RtmpQu3F7r/forward/history/3.parquet"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/var/folders/nl/ygb3g6tj24z06jddbqqhj6hw0000gn/T//RtmpQu3F7r/forward/history/4.parquet"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[5]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/var/folders/nl/ygb3g6tj24z06jddbqqhj6hw0000gn/T//RtmpQu3F7r/forward/history/5.parquet"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[6]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/var/folders/nl/ygb3g6tj24z06jddbqqhj6hw0000gn/T//RtmpQu3F7r/forward/history/6.parquet"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># &gt; Check file size (MB)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="pf_files.html">pf_files_size</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">pff_folder</span>, <span class="st">"history"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.289373</span>
<span class="r-in"><span><span class="co"># Use `cols` to restrict the output columns</span></span></span>
<span class="r-in"><span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"timestep"</span>, <span class="st">"cell_now"</span>, <span class="st">"x_now"</span>, <span class="st">"y_now"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                                              .sink <span class="op">=</span> <span class="va">pff_folder</span>,</span></span>
<span class="r-in"><span>                                              .cols <span class="op">=</span> <span class="va">cols</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-01-21 13:33:43... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The directory '/var/folders/nl/ygb3g6tj24z06jddbqqhj6hw0000gn/T//RtmpQu3F7r/forward/history' is not empty.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The directory '/var/folders/nl/ygb3g6tj24z06jddbqqhj6hw0000gn/T//RtmpQu3F7r/forward/diagnostics' is not empty.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 5: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 6: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 7: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 8: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 9: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 10: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 11: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 12: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 13: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 14: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 15: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 16: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 17: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 18: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 19: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 20: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 21: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 22: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 23: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 24: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 25: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-01-21 13:33:43 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="fu"><a href="pf_files.html">pf_files_size</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">pff_folder</span>, <span class="st">"history"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.206542</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">pff_folder</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (10): Adjust standard `patter-progress` options</span></span></span>
<span class="r-in"><span><span class="co"># Use a log.txt file</span></span></span>
<span class="r-in"><span><span class="va">log.txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .verbose <span class="op">=</span> <span class="va">log.txt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">log.txt</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "`patter::pf_forward()` called @ 2024-01-21 13:33:43... "                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2] "... Setting up simulation... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] "... Defining origin... "                                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4] "... Initiating simulation... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "... ... Time step 2: "                                                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "... ... Time step 3: "                                                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "... ... Time step 4: "                                                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "... ... Time step 5: "                                                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "... ... Time step 6: "                                                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] "... ... Time step 7: "                                                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] "... ... Time step 8: "                                                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "... ... Time step 9: "                                                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21] "... ... Time step 10: "                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23] "... ... Time step 11: "                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] "... ... Time step 12: "                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27] "... ... Time step 13: "                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29] "... ... Time step 14: "                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] "... ... Time step 15: "                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [32] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33] "... ... Time step 16: "                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [34] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [35] "... ... Time step 17: "                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [36] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37] "... ... Time step 18: "                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [38] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39] "... ... Time step 19: "                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [40] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [41] "... ... Time step 20: "                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [42] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [43] "... ... Time step 21: "                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [44] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [45] "... ... Time step 22: "                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [46] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [47] "... ... Time step 23: "                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [48] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [49] "... ... Time step 24: "                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [50] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [51] "... ... Time step 25: "                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [52] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [53] "`patter::pf_forward()` call ended @ 2024-01-21 13:33:43 (duration: ~0 sec(s)). "</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">log.txt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Suppress `.verbose`</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Suppress progress bar</span></span></span>
<span class="r-in"><span><span class="va">pbo</span> <span class="op">&lt;-</span> <span class="fu">pbapply</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pbapply/man/pboptions.html" class="external-link">pboptions</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-01-21 13:33:44... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 2: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 3: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 4: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 5: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 6: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 7: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 8: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 9: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 10: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 11: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 12: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 13: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 14: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 15: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 16: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 17: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 18: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 19: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 20: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 21: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 22: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 23: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 24: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Time step 25: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-01-21 13:33:44 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="fu">pbapply</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pbapply/man/pboptions.html" class="external-link">pboptions</a></span><span class="op">(</span><span class="va">pbo</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

