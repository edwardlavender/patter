<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>PF: forward simulation — pf_forward • patter</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="PF: forward simulation — pf_forward"><meta property="og:description" content="This function runs the forward simulation of the forward filtering--backward smoothing algorithm. The forward simulation samples possible locations (particles) of an animal at each time point given the data up to (and including) that time point and a movement model."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patter</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/a-methodology.html">Methodology</a>
    </li>
    <li>
      <a href="../articles/b-workflow-outline.html">Workflow outline</a>
    </li>
    <li>
      <a href="../articles/c-workflow-example.html">Example workflow</a>
    </li>
    <li>
      <a href="../articles/d-demos.html">Demos</a>
    </li>
    <li>
      <a href="../articles/e-faqs.html">FAQs</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/edwardlavender/patter/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>PF: forward simulation</h1>
    <small class="dont-index">Source: <a href="https://github.com/edwardlavender/patter/blob/HEAD/R/pf_forward.R" class="external-link"><code>R/pf_forward.R</code></a></small>
    <div class="hidden name"><code>pf_forward.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function runs the forward simulation of the forward filtering--backward smoothing algorithm. The forward simulation samples possible locations (particles) of an animal at each time point given the data up to (and including) that time point and a movement model.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pf_forward</span><span class="op">(</span></span>
<span>  <span class="va">.obs</span>,</span>
<span>  <span class="va">.dlist</span>,</span>
<span>  .rpropose <span class="op">=</span> <span class="va">pf_rpropose_kick</span>,</span>
<span>  .rargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  .dpropose <span class="op">=</span> <span class="va">pf_dpropose</span>,</span>
<span>  .dargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  .likelihood <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  .n <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  .sample <span class="op">=</span> <span class="va">pf_sample_systematic</span>,</span>
<span>  .trial <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_trial</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  .control <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_control</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  .rerun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  .rerun_from <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_rerun_from</a></span><span class="op">(</span><span class="va">.rerun</span><span class="op">)</span>,</span>
<span>  .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  .verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"patter.verbose"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>.obs</dt>
<dd><p>A <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> defining the timeline and associated observations, typically from <code><a href="pf_setup_obs.html">pf_setup_obs()</a></code>.</p></dd>


<dt>.dlist</dt>
<dd><p>A <code>named</code> list of data and parameters required propose locations and calculate likelihoods (see <code><a href="pat_setup_data.html">pat_setup_data()</a></code>, <code><a href="pf_lik.html">pf_lik</a></code> and <code><a href="pf_propose.html">pf_propose</a></code>). This function requires:</p><ul><li><p><code>.dlist$spatial$bathy</code></p></li>
<li><p>(optional) <code>.dlist$spatial$origin</code>, a <code><a href="https://rspatial.github.io/terra/reference/SpatRaster-class.html" class="external-link">SpatRaster</a></code> used to define the origin. This may differ in geometry from <code>.dlist$spatial$bathy</code> but must have the same coordinate reference system.</p></li>
<li><p><code>.dlist$pars$lonlat</code> (required by the default <code>.rpropose</code> and <code>.dpropose</code> arguments).</p></li>
<li><p>Any additional elements required by <code>.likelihood</code>,<code>.rpropose</code> and <code>.dpropose</code> functions (see below).</p></li>
</ul></dd>


<dt>.rpropose, .dpropose, .rargs, .dargs</dt>
<dd><p>Proposal functions and associated argument lists (see <code><a href="pf_propose.html">pf_propose</a></code>).</p><ul><li><p><code>.rpropose</code> is a function that proposes new locations for the individual, given previous locations. By default, this is a 'stochastic kick' function that simulates new locations by randomly kicking previous particles (see <code><a href="pf_propose.html">pf_rpropose_kick()</a></code> and Details).</p></li>
<li><p><code>.dpropose</code> is a function that evaluates the probability density of movements between location pairs (see <code><a href="pf_propose.html">pf_dpropose()</a></code>). This is required for directed sampling (see Details).</p></li>
<li><p><code>.rargs</code> and <code>.dargs</code> are named <code>list</code>s of arguments passed to <code>.rpropose</code> and <code>.dpropose</code> respectively.</p></li>
</ul></dd>


<dt>.likelihood</dt>
<dd><p>A named <code>list</code> of likelihood functions. These are used to calculate the likelihood of each dataset at proposal locations. See <code><a href="pf_lik.html">pf_lik</a></code> for required arguments, convenience functions and advice.</p></dd>


<dt>.n, .sample</dt>
<dd><p>Sampling arguments.</p><ul><li><p><code>.n</code> is an <code>integer</code> that defines the number of particle samples at each time step.</p></li>
<li><p><code>.sample</code> is a function used to (re)-sample proposal locations (see <code><a href="pf_sample.html">pf_sample</a></code>).</p></li>
</ul></dd>


<dt>.trial</dt>
<dd><p>A named <code>list</code> of tuning parameters for convergence, from <code><a href="pf_opt.html">pf_opt_trial()</a></code>.</p></dd>


<dt>.control</dt>
<dd><p>A named <code>list</code> of control options, from <code><a href="pf_opt.html">pf_opt_control()</a></code>.</p></dd>


<dt>.rerun, .rerun_from</dt>
<dd><p>Rerun options. These options are used to restart the algorithm from an earlier time step in the case of a convergence failure.</p><ul><li><p><code>.rerun</code> is the named <code>list</code> of algorithm outputs from a previous rerun.</p></li>
<li><p><code>.rerun_from</code> is an <code>integer</code> that defines the time step from which to rerun the algorithm.</p></li>
</ul><p>Algorithm parameters should remain consistent on algorithm reruns.</p></dd>


<dt>.record</dt>
<dd><p>A named <code>list</code> of output options, from <code><a href="pf_opt.html">pf_opt_record()</a></code>.</p></dd>


<dt>.verbose</dt>
<dd><p>User output control (see <code><a href="patter-progress.html">patter-progress</a></code> for supported options).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The function returns a <code><a href="pf_particles-class.html">pf_particles</a></code> object. If <code>.record$sink</code> is specified, two directories, <code>{.record$sink}/history/</code> and <code>{.record$sink}/diagnostics</code>, are also created that contain particle samples and diagnostics. Particle samples are labelled <code>1.parquet, 2.parquet, ..., T.parquet</code>, where <code>T</code> is the number of time steps. Diagnostics are labelled <code>A-B-C</code>, where <code>A</code>, <code>B</code> and <code>C</code> are the number of manual restarts, internal reversions and time steps. Use <code>pf_diag_convergence()</code> to collate convergence diagnostics and <code><a href="pf_diag.html">pf_diag_summary()</a></code> for a summary.</p>
    </div>
    <div id="overview">
    <h2>Overview</h2>
    <p><code>pf_forward()</code> iterates over time steps, simulating location samples (termed 'particles') that are consistent with the preceding data and a movement model at each time step. At each time step, this process comprises four steps:</p><ol><li><p>A proposal step, in which we propose possible locations for the individual.</p></li>
<li><p>A likelihood step, in which we calculate the likelihood of the data given each proposal.</p></li>
<li><p>A weights step, in which we translate likelihoods into sampling weights.</p></li>
<li><p>A sampling step, in which we (re)sample valid proposal locations using the weights.</p></li>
</ol><p>At the first time step, proposal locations are defined from a large number of 'quadrature points' across a <code><a href="https://rspatial.github.io/terra/reference/SpatRaster-class.html" class="external-link">SpatRaster</a></code> that defines starting location(s), defined in <code>.dlist$spatial$origin</code> (<code>.dlist$spatial$bathy</code> is used if <code>.dlist$spatial$origin</code> is undefined). <code>NA</code>s/non <code>NA</code>s distinguish possible/impossible locations. For AC*PF algorithm implementations (i.e., implementations that incorporate acoustic data, see Algorithms, below), grid cells beyond acoustic containers are masked. For *DCPF implementations (i.e., implementations that incorporate depth data, see Algorithms, below), it is also desirable if you can, at least approximately, mask grid cells that are incompatible with the first depth observation. At the first time step, up to <code>1e6</code> locations ('quadrature points') are sampled from the <code><a href="https://rspatial.github.io/terra/reference/SpatRaster-class.html" class="external-link">SpatRaster</a></code>. At each quadrature point, we evaluate likelihoods and calculate weights. <code>.n</code> starting locations (particles) are sampled, via <code>.sample</code>, from the set of quadrature points using the weights. If the effective sample size (ESS) of sampled locations is less than <code>.trial$trial_origin_crit</code>, a <code><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></code> is given.</p>
<p>At subsequent time steps, proposal locations are generated via <code>.rpropose</code> which, by default, is a 'stochastic kick' function that 'kicks' previous particles at random into new locations (in line with the restrictions imposed by a movement model). The benefit of this approach is that it is extremely fast, but in situations in which there are relatively few possible locations for an individual, the approach can work poorly because few kicked particles end up in valid locations. A <code>list</code> of likelihood functions is used to evaluate the likelihood of the data, given each proposal, and filter invalid proposals. During this time, we track how the number and diversity of proposal locations declines, as the data are revealed to be incompatible with selected proposals by successive likelihood functions (see Convergence and diagnostics, below). Likelihoods are translated into weights for resampling (see below).</p>
<p>Following the stochastic-kick methodology, if the effective sample size is &lt;= <code>.trial$trial_sampler_crit</code>, directed sampling is initiated. For the subset of (previous) locations for which stochastic kicks failed to generate valid samples, for each unique location, this methodology identifies the set of reachable cells, given a mobility parameter, and evaluates likelihoods and the probability density of movements into each reachable location (which are used to define sampling weights). This approach is expensive in terms of time (since it requires iteration over particles) and memory (since the complete set of valid locations is used for sampling). For this reason, it is currently only implemented for the subset of locations for which subsequent samples are lacking. Particles can be processed in batches for improved speed, up to the limits imposed by available memory (see <code>.control</code>). While this approach is expensive, sampling from the set of valid locations facilitates convergence.</p>
<p>You can opt to use either <code>.rpropose</code> or directed sampling via the <code>.trial_</code> arguments to <code><a href="pf_opt.html">pf_opt_trial()</a></code>. However, in general, it is advisable to permit the algorithm to chop-and-change between methods, depending on the number of valid proposals. This approach benefits from the speed of stochastic kicks, where possible, as well as the improved convergence properties of directed sampling, where required.</p>
<p>Particle rejuvenation is another strategy that is sometimes used to facilitate convergence but this is not currently implemented.</p>
<p>At the end of each time step, the effective sample size of weighted particles is evaluated. If the ESS is below the critical value specified in <code>.trial$trial_resample_crit</code> and/or directed sampling is implemented, particles are (re)-sampled, via <code>.sample</code>. If the ESS is less than <code>.trial$trial_revert_crit</code>, the algorithm can step backwards in time by <code>.trial$trial_revert_steps</code> and try again. This reversion will be attempted up to <code>.trial$trial_revert</code> times. After <code>.trial$trial_revert</code> times, if the algorithm reaches a time step when the ESS is less than <code>.trial$trial_revert_crit</code>, it will produce a <code><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></code>, but attempt to continue the simulation if possible. In the case of convergence failures, you can rerun the simulation from existing outputs, starting from an earlier time step, via <code>.rerun</code>. However, algorithm arguments should remain constant. On algorithm reversions and reruns, particle samplers are replaced but particle diagnostics are always retained.</p>
<p>The algorithm iterates over the time series, proposing, weighting and (re)sampling particles as described above. Particle samples can be saved in memory or written to file, alongside particle diagnostics. If the function fails to convergence, a <code><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></code> is returned alongside the outputs up to that time step. Otherwise, the function will continue to the end of the time series.</p>
    </div>
    <div id="algorithms">
    <h2>Algorithms</h2>
    <p>This is highly flexible routine for the reconstruction of the possible locations of an individual through time, given the data up to that time point. By modifying the likelihood functions, it is straightforward to implement the ACPF, DCPF and ACDCPF algorithms introduced by Lavender et al. (2023) for reconstructing movements using (a) acoustic time series, (b) archival time series and (c) acoustic and archival time series. <code>pf_forward()</code> thus replaces (and enhances) the <a href="https://edwardlavender.github.io/flapper/reference/ac.html" class="external-link"><code><a href="https://edwardlavender.github.io/flapper/reference/ac.html" class="external-link">flapper::ac()</a></code></a>, <a href="https://edwardlavender.github.io/flapper/reference/dc.html" class="external-link"><code><a href="https://edwardlavender.github.io/flapper/reference/dc.html" class="external-link">flapper::dc()</a></code></a>, <a href="https://edwardlavender.github.io/flapper/reference/acdc.html" class="external-link"><code><a href="https://edwardlavender.github.io/flapper/reference/acdc.html" class="external-link">flapper::acdc()</a></code></a> and <a href="https://edwardlavender.github.io/flapper/reference/pf.html" class="external-link"><code><a href="https://edwardlavender.github.io/flapper/reference/pf.html" class="external-link">flapper::pf()</a></code></a> functions.</p>
    </div>
    <div id="convergence-and-diagnostics">
    <h2>Convergence and diagnostics</h2>
    <p>While <code>pf_forward()</code> tries hard to reconstruct a complete time series of location samples, algorithm convergence is not guaranteed. The algorithm may reach a dead-end---a time step at which there are no valid locations into which the algorithm can step. This may be due to data errors, incorrect assumptions, insufficient sampling effort or poor tuning-parameter settings. To facilitate diagnosis of the immediate cause of convergence failures, during likelihood evaluations we keep track of 'particle diagnostics', i.e., the number of unique, valid locations before/after each likelihood evaluation alongside other statistics (see <code><a href="pf_diag-internal.html">pf_diag-internal</a></code> and <code><a href="pf_particles-class.html">pf_particles</a></code>).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>The forward filtering--backward sampling algorithm samples locations (particles) that represent the possible locations of an individual through time, accounting for all data and the individual's movement.</p><ul><li><p>To set up data, use <code><a href="pat_setup_data.html">pat_setup_data()</a></code>.</p></li>
<li><p><code>pf_forward()</code> implements the forward filter:</p><ul><li><p>To set up an observations timeline, use <code><a href="pf_setup_obs.html">pf_setup_obs()</a></code>.</p></li>
<li><p>For proposal (movement) models, see <code><a href="pf_propose.html">pf_propose</a></code>.</p></li>
<li><p>For likelihood functions, to evaluate the likelihood of the data at proposal locations, see <code><a href="pf_lik.html">pf_lik</a></code>.</p></li>
<li><p>For sampling functions, to (re)sample plausible proposal locations, see <code><a href="pf_sample.html">pf_sample</a></code>.</p></li>
<li><p>For tuning parameters, see <code><a href="pf_opt.html">pf_opt</a></code>.</p></li>
</ul></li>
<li><p><code>pf_backward_*()</code> refines outputs from the forward filter:</p><ul><li><p><code>pf_backward_killer()</code> removes dead-ends;</p></li>
<li><p><code>pf_backward_sampler</code><code>_*()</code> implements the backward sampler;</p></li>
</ul></li>
<li><p>To reconstruct movement paths from particle samples, use <code>pf_path()</code>.</p></li>
<li><p>To map emergent patterns of space use, use <code><a href="pf_coord.html">pf_coord()</a></code> plus a <code>map_*()</code> function, such as <code><a href="map_pou.html">map_pou()</a></code>, <code><a href="map_dens.html">map_dens()</a></code> and/or <code><a href="map_hr.html">map_hr</a></code><code>_()</code>.</p></li>
<li><p>For additional utilities, see supporting <code>pf_*()</code> functions, such as <code><a href="pf_files.html">pf_files()</a></code>, <code><a href="pf_files.html">pf_files_size()</a></code>, <code><a href="pf_plot_history.html">pf_plot_history()</a></code>, <code>pf_diag_convergence()</code> and <code><a href="pf_diag.html">pf_diag_summary()</a></code>.</p></li>
</ul></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Edward Lavender</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dtplyr.tidyverse.org" class="external-link">dtplyr</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: dtplyr</span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Set up forward simulation</span></span></span>
<span class="r-in"><span><span class="co"># Set up data list(see `?pat_setup_data()`)</span></span></span>
<span class="r-in"><span><span class="va">dlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="datasets-algorithms.html">dat_dlist</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Add AC* algorithm layers</span></span></span>
<span class="r-in"><span><span class="va">dlist</span><span class="op">$</span><span class="va">algorithm</span><span class="op">$</span><span class="va">detection_overlaps</span> <span class="op">&lt;-</span> <span class="fu"><a href="acs_setup_detection_overlaps.html">acs_setup_detection_overlaps</a></span><span class="op">(</span><span class="va">dlist</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dlist</span><span class="op">$</span><span class="va">algorithm</span><span class="op">$</span><span class="va">detection_kernels</span>  <span class="op">&lt;-</span> <span class="fu"><a href="acs_setup_detection_kernels.html">acs_setup_detection_kernels</a></span><span class="op">(</span><span class="va">dlist</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::acs_setup_detection_kernels()` called @ 2024-03-18 14:27:51... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Getting Pr(detection)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Getting Pr(non-detection)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Getting log-likelihood surfaces for non-detection... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Listing outputs ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::acs_setup_detection_kernels()` call ended @ 2024-03-18 14:27:51 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="co"># Set up observations (see `?pf_setup_obs()`)</span></span></span>
<span class="r-in"><span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="datasets-algorithms.html">dat_obs</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (1): Implement ACPF algorithm with default options</span></span></span>
<span class="r-in"><span><span class="co">## Implement simulation</span></span></span>
<span class="r-in"><span><span class="va">pf_lik_acpf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>acs_filter_land <span class="op">=</span> <span class="va">acs_filter_land</span>,</span></span>
<span class="r-in"><span>                    acs_filter_container <span class="op">=</span> <span class="va">acs_filter_container</span>,</span></span>
<span class="r-in"><span>                    pf_lik_ac <span class="op">=</span> <span class="va">pf_lik_ac</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-03-18 14:27:51... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 2 (timestep 2): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 3 (timestep 3): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 4 (timestep 4): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 5 (timestep 5): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 6 (timestep 6): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 7 (timestep 7): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 8 (timestep 8): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 9 (timestep 9): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 10 (timestep 10): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 11 (timestep 11): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 12 (timestep 12): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 13 (timestep 13): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 14 (timestep 14): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 15 (timestep 15): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 16 (timestep 16): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 17 (timestep 17): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 18 (timestep 18): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 19 (timestep 19): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 20 (timestep 20): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 21 (timestep 21): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 22 (timestep 22): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 23 (timestep 23): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 24 (timestep 24): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 25 (timestep 25): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-03-18 14:27:51 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="co">## Examine output object</span></span></span>
<span class="r-in"><span><span class="co"># The function returns a named list:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_pff</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Length Class      Mode   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> history     25     -none-     list   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> convergence  1     -none-     logical</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time         3     data.table list   </span>
<span class="r-in"><span><span class="co"># `history` contains a list of particle samples</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_pff</span><span class="op">$</span><span class="va">history</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    timestep cell_past x_past y_past cell_now    x_now   y_now    loglik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;int&gt;     &lt;int&gt;  &lt;num&gt;  &lt;num&gt;    &lt;int&gt;    &lt;num&gt;   &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:        1        NA     NA     NA    36804 708842.1 6253707 -3.250623</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:        1        NA     NA     NA    36808 709242.1 6253707 -2.213505</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:        1        NA     NA     NA    36994 708842.1 6253607 -2.489701</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:        1        NA     NA     NA    36996 709042.1 6253607 -1.608534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:        1        NA     NA     NA    36997 709142.1 6253607 -1.451129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:        1        NA     NA     NA    36999 709342.1 6253607 -1.699861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        bathy    logwt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;num&gt;    &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: 138.12404 -4.60517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2: 103.00890 -4.60517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3: 132.47633 -4.60517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4: 116.70552 -4.60517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5: 105.22495 -4.60517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:  81.56814 -4.60517</span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">out_pff</span><span class="op">$</span><span class="va">history</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    timestep cell_past   x_past  y_past    logwt    x_now   y_now    bathy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;int&gt;     &lt;int&gt;    &lt;num&gt;   &lt;num&gt;    &lt;num&gt;    &lt;num&gt;   &lt;num&gt;    &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:        2     36808 709242.1 6253707 -4.60517 709381.6 6253604 81.56814</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:        2     36994 708842.1 6253607 -4.60517 709023.2 6253445 99.90396</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:        2     36996 709042.1 6253607 -4.60517 709161.0 6253445 87.54828</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:        2     36996 709042.1 6253607 -4.60517 709161.0 6253445 87.54828</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:        2     37185 708942.1 6253507 -4.60517 709132.8 6253350 80.03239</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:        2     37185 708942.1 6253507 -4.60517 709132.8 6253350 80.03239</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    cell_now     loglik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &lt;int&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:    36999 -1.6998615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:    37376 -0.6251042</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:    37377 -0.5164927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:    37377 -0.5164927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:    37567 -0.3716784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:    37567 -0.3716784</span>
<span class="r-in"><span><span class="co"># `convergence` records convergence (TRUE/FALSE)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span><span class="op">$</span><span class="va">convergence</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="co"># `time` records timings</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span><span class="op">$</span><span class="va">time</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  start                 end       duration</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 &lt;POSc&gt;              &lt;POSc&gt;     &lt;difftime&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: 2024-03-18 14:27:51 2024-03-18 14:27:51 0.1879342 secs</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (2): Implement DCPF algorithm with default options</span></span></span>
<span class="r-in"><span><span class="co"># Define shallow and depth errors</span></span></span>
<span class="r-in"><span><span class="va">obs</span><span class="op">[</span>, <span class="va">depth_shallow_eps</span> <span class="op">:=</span> <span class="fl">20</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp mobility array_id detection acoustics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;int&gt;              &lt;POSc&gt;    &lt;num&gt;    &lt;int&gt;     &lt;int&gt;    &lt;list&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:        1 2016-03-17 01:50:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:        2 2016-03-17 01:52:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:        3 2016-03-17 01:54:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:        4 2016-03-17 01:56:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:        5 2016-03-17 01:58:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:        6 2016-03-17 02:00:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:        7 2016-03-17 02:02:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:        8 2016-03-17 02:04:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:        9 2016-03-17 02:06:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:       10 2016-03-17 02:08:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:       11 2016-03-17 02:10:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:       12 2016-03-17 02:12:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:       13 2016-03-17 02:14:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:       14 2016-03-17 02:16:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:       15 2016-03-17 02:18:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:       16 2016-03-17 02:20:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:       17 2016-03-17 02:22:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:       18 2016-03-17 02:24:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:       19 2016-03-17 02:26:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:       20 2016-03-17 02:28:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:       21 2016-03-17 02:30:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:       22 2016-03-17 02:32:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:       23 2016-03-17 02:34:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:       24 2016-03-17 02:36:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:       25 2016-03-17 02:38:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp mobility array_id detection acoustics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     container depth depth_shallow_eps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;list&gt; &lt;num&gt;             &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1: &lt;list[2]&gt; 73.78                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2: &lt;list[2]&gt; 73.32                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3: &lt;list[2]&gt; 73.32                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4: &lt;list[2]&gt; 73.32                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5: &lt;list[2]&gt; 73.55                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6: &lt;list[2]&gt; 68.70                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7: &lt;list[2]&gt; 72.16                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8: &lt;list[2]&gt; 72.85                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9: &lt;list[2]&gt; 73.55                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10: &lt;list[2]&gt; 73.32                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11: &lt;list[2]&gt; 73.32                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12: &lt;list[2]&gt; 73.55                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13: &lt;list[2]&gt; 73.32                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14: &lt;list[2]&gt; 73.32                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15: &lt;list[2]&gt; 73.32                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16: &lt;list[2]&gt; 72.39                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17: &lt;list[2]&gt; 72.39                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18: &lt;list[2]&gt; 72.39                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19: &lt;list[2]&gt; 72.39                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20: &lt;list[2]&gt; 72.39                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21: &lt;list[2]&gt; 72.39                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22: &lt;list[2]&gt; 65.23                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23: &lt;list[2]&gt; 73.55                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24: &lt;list[2]&gt; 75.16                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25: &lt;list[2]&gt; 76.78                20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     container depth depth_shallow_eps</span>
<span class="r-in"><span><span class="va">obs</span><span class="op">[</span>, <span class="va">depth_deep_eps</span> <span class="op">:=</span> <span class="fl">20</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp mobility array_id detection acoustics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;int&gt;              &lt;POSc&gt;    &lt;num&gt;    &lt;int&gt;     &lt;int&gt;    &lt;list&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:        1 2016-03-17 01:50:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:        2 2016-03-17 01:52:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:        3 2016-03-17 01:54:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:        4 2016-03-17 01:56:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:        5 2016-03-17 01:58:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:        6 2016-03-17 02:00:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:        7 2016-03-17 02:02:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:        8 2016-03-17 02:04:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:        9 2016-03-17 02:06:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:       10 2016-03-17 02:08:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:       11 2016-03-17 02:10:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:       12 2016-03-17 02:12:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:       13 2016-03-17 02:14:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:       14 2016-03-17 02:16:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:       15 2016-03-17 02:18:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:       16 2016-03-17 02:20:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:       17 2016-03-17 02:22:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:       18 2016-03-17 02:24:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:       19 2016-03-17 02:26:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:       20 2016-03-17 02:28:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:       21 2016-03-17 02:30:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:       22 2016-03-17 02:32:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:       23 2016-03-17 02:34:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:       24 2016-03-17 02:36:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:       25 2016-03-17 02:38:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp mobility array_id detection acoustics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     container depth depth_shallow_eps depth_deep_eps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;list&gt; &lt;num&gt;             &lt;num&gt;          &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1: &lt;list[2]&gt; 73.78                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2: &lt;list[2]&gt; 73.32                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3: &lt;list[2]&gt; 73.32                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4: &lt;list[2]&gt; 73.32                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5: &lt;list[2]&gt; 73.55                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6: &lt;list[2]&gt; 68.70                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7: &lt;list[2]&gt; 72.16                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8: &lt;list[2]&gt; 72.85                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9: &lt;list[2]&gt; 73.55                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10: &lt;list[2]&gt; 73.32                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11: &lt;list[2]&gt; 73.32                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12: &lt;list[2]&gt; 73.55                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13: &lt;list[2]&gt; 73.32                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14: &lt;list[2]&gt; 73.32                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15: &lt;list[2]&gt; 73.32                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16: &lt;list[2]&gt; 72.39                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17: &lt;list[2]&gt; 72.39                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18: &lt;list[2]&gt; 72.39                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19: &lt;list[2]&gt; 72.39                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20: &lt;list[2]&gt; 72.39                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21: &lt;list[2]&gt; 72.39                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22: &lt;list[2]&gt; 65.23                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23: &lt;list[2]&gt; 73.55                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24: &lt;list[2]&gt; 75.16                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25: &lt;list[2]&gt; 76.78                20             20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     container depth depth_shallow_eps depth_deep_eps</span>
<span class="r-in"><span><span class="co"># (optional) Define origin SpatRaster</span></span></span>
<span class="r-in"><span><span class="va">shallow</span> <span class="op">&lt;-</span> <span class="va">dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">bathy</span> <span class="op">-</span> <span class="va">obs</span><span class="op">$</span><span class="va">depth_shallow_eps</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">deep</span>    <span class="op">&lt;-</span> <span class="va">dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">bathy</span> <span class="op">+</span> <span class="va">obs</span><span class="op">$</span><span class="va">depth_deep_eps</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">origin</span>  <span class="op">&lt;-</span> <span class="op">(</span><span class="va">obs</span><span class="op">$</span><span class="va">depth</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">shallow</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">obs</span><span class="op">$</span><span class="va">depth</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">deep</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">origin</span>  <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/classify.html" class="external-link">classify</a></span><span class="op">(</span><span class="va">origin</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">0</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Examine origin SpatRaster</span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">origin</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pf_forward-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">bathy</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/mask.html" class="external-link">mask</a></span><span class="op">(</span><span class="va">origin</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"bathy"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 53.78857 93.77747</span>
<span class="r-in"><span><span class="va">dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">origin</span> <span class="op">&lt;-</span> <span class="va">origin</span></span></span>
<span class="r-in"><span><span class="co"># Implement DCPF algorithm</span></span></span>
<span class="r-in"><span><span class="va">pf_lik_dcpf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pf_lik_dc <span class="op">=</span> <span class="va">pf_lik_dc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_dcpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-03-18 14:27:52... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 2 (timestep 2): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 3 (timestep 3): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 4 (timestep 4): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 5 (timestep 5): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 6 (timestep 6): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 7 (timestep 7): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 8 (timestep 8): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 9 (timestep 9): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 10 (timestep 10): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 11 (timestep 11): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 12 (timestep 12): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 13 (timestep 13): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 14 (timestep 14): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 15 (timestep 15): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 16 (timestep 16): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 17 (timestep 17): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 18 (timestep 18): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 19 (timestep 19): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 20 (timestep 20): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 21 (timestep 21): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 22 (timestep 22): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 23 (timestep 23): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 24 (timestep 24): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 25 (timestep 25): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-03-18 14:27:52 (duration: ~0 sec(s)). </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (3): Implement ACDCPF algorithm with default options</span></span></span>
<span class="r-in"><span><span class="va">pf_lik_acdcpf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pf_lik_dc <span class="op">=</span> <span class="va">pf_lik_dc</span>,</span></span>
<span class="r-in"><span>                      acs_filter_container <span class="op">=</span> <span class="va">acs_filter_container</span>,</span></span>
<span class="r-in"><span>                      pf_lik_ac <span class="op">=</span> <span class="va">pf_lik_ac</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acdcpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-03-18 14:27:52... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 2 (timestep 2): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 3 (timestep 3): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 4 (timestep 4): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 5 (timestep 5): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 6 (timestep 6): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 7 (timestep 7): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 8 (timestep 8): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 9 (timestep 9): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 10 (timestep 10): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 11 (timestep 11): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 12 (timestep 12): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 13 (timestep 13): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 14 (timestep 14): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 15 (timestep 15): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 16 (timestep 16): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 17 (timestep 17): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 18 (timestep 18): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 19 (timestep 19): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 20 (timestep 20): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 21 (timestep 21): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 22 (timestep 22): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 23 (timestep 23): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 24 (timestep 24): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 25 (timestep 25): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-03-18 14:27:52 (duration: ~0 sec(s)). </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (4): Customise movement model via `.rpropose` and `.dpropose`</span></span></span>
<span class="r-in"><span><span class="co"># Pass arguments to the default models via `.rargs` &amp; `.dargs`</span></span></span>
<span class="r-in"><span><span class="co"># * For `.rpropose` = `pf_rpropose_kick()`, `.rargs` get passed to</span></span></span>
<span class="r-in"><span><span class="co"># * ... `.rkick` = `rkick()` &gt; `.rstep` = `rstep()` &gt;</span></span></span>
<span class="r-in"><span><span class="co"># * ... `.rlen` = rlen(), `.rang` = rang()</span></span></span>
<span class="r-in"><span><span class="co"># * For `.dpropose` = `pf_dpropose()`, `.dargs` gets passed to</span></span></span>
<span class="r-in"><span><span class="co"># * ... `.dkick` = `dkick()` &gt; `.dstep` = `dstep()` &gt; `.dlen` = `dtruncgamma()`</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># E.g., customise rlen() shape and scale parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="sim_helpers.html">rlen</a></span><span class="op">(</span>.n <span class="op">=</span> <span class="fl">1e5L</span>, .shape <span class="op">=</span> <span class="fl">1</span>, .scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">500</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pf_forward-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .rpropose <span class="op">=</span> <span class="va">pf_rpropose_kick</span>,</span></span>
<span class="r-in"><span>                      .rargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.shape <span class="op">=</span> <span class="fl">1</span>, .scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .dpropose <span class="op">=</span> <span class="va">pf_dpropose</span>,</span></span>
<span class="r-in"><span>                      .dargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.shape <span class="op">=</span> <span class="fl">1</span>, .scale <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acdcpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-03-18 14:27:52... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 2 (timestep 2): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 3 (timestep 3): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 4 (timestep 4): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 5 (timestep 5): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 6 (timestep 6): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 7 (timestep 7): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 8 (timestep 8): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 9 (timestep 9): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 10 (timestep 10): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 11 (timestep 11): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 12 (timestep 12): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 13 (timestep 13): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 14 (timestep 14): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 15 (timestep 15): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 16 (timestep 16): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 17 (timestep 17): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 18 (timestep 18): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 19 (timestep 19): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 20 (timestep 20): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 21 (timestep 21): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 22 (timestep 22): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 23 (timestep 23): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 24 (timestep 24): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 25 (timestep 25): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-03-18 14:27:52 (duration: ~0 sec(s)). </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># E.g., customise rlen() .mobility parameter</span></span></span>
<span class="r-in"><span><span class="co"># &gt; Restricted mobility leads to convergence failure</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .rpropose <span class="op">=</span> <span class="va">pf_rpropose_kick</span>,</span></span>
<span class="r-in"><span>                      .rargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.mobility <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .dpropose <span class="op">=</span> <span class="va">pf_dpropose</span>,</span></span>
<span class="r-in"><span>                      .dargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.mobility <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acdcpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-03-18 14:27:52... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 2 (timestep 2): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 3 (timestep 3): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 4 (timestep 4): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 5 (timestep 5): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 6 (timestep 6): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 7 (timestep 7): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 8 (timestep 8): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 9 (timestep 9): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 10 (timestep 10): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 11 (timestep 11): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 12 (timestep 12): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 13 (timestep 13): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 14 (timestep 14): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 15 (timestep 15): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 16 (timestep 16): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 17 (timestep 17): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 18 (timestep 18): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 19 (timestep 19): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 20 (timestep 20): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 21 (timestep 21): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 22 (timestep 22): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 23 (timestep 23): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 24 (timestep 24): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 25 (timestep 25): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-03-18 14:27:52 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="co"># &gt; Pairwise steps are &lt; .mobility + grid resolution/2</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">out_pff</span><span class="op">$</span><span class="va">history</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_helpers.html">clen</a></span><span class="op">(</span><span class="va">out_pff</span><span class="op">$</span><span class="va">history</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">x_past</span>, <span class="va">y_past</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>               <span class="va">out_pff</span><span class="op">$</span><span class="va">history</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">x_now</span>, <span class="va">y_now</span><span class="op">)</span><span class="op">]</span>, .lonlat <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">100</span> <span class="op">+</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">res</a></span><span class="op">(</span><span class="va">dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">bathy</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 25</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## E.g. customise rlen() and dlen() models</span></span></span>
<span class="r-in"><span><span class="co"># Write a new model with step lengths simulated from a lognormal distribution</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">1e6L</span>, meanlog <span class="op">=</span> <span class="fl">5</span>, sdlog <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">500</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pf_forward-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .rpropose <span class="op">=</span> <span class="va">pf_rpropose_kick</span>,</span></span>
<span class="r-in"><span>                      .dpropose <span class="op">=</span> <span class="va">pf_dpropose</span>,</span></span>
<span class="r-in"><span>                      .rargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.rlen <span class="op">=</span> <span class="va">rlnorm</span>, meanlog <span class="op">=</span> <span class="fl">5</span>, sdlog <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .dargs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>.dlen <span class="op">=</span> <span class="va">dlnorm</span>, meanlog <span class="op">=</span> <span class="fl">5</span>, sdlog <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acdcpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-03-18 14:27:52... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 2 (timestep 2): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 3 (timestep 3): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 4 (timestep 4): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 5 (timestep 5): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 6 (timestep 6): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 7 (timestep 7): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 8 (timestep 8): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 9 (timestep 9): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 10 (timestep 10): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 11 (timestep 11): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 12 (timestep 12): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 13 (timestep 13): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 14 (timestep 14): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 15 (timestep 15): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 16 (timestep 16): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 17 (timestep 17): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 18 (timestep 18): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 19 (timestep 19): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 20 (timestep 20): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 21 (timestep 21): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 22 (timestep 22): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 23 (timestep 23): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 24 (timestep 24): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 25 (timestep 25): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-03-18 14:27:52 (duration: ~0 sec(s)). </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (5): Customise likelihood</span></span></span>
<span class="r-in"><span><span class="co"># We can implement different algorithms by modifying the .likelihood list (above)</span></span></span>
<span class="r-in"><span><span class="co"># We can also write custom likelihood functions</span></span></span>
<span class="r-in"><span><span class="co"># As an example, we will imagine we have observed temperatures every two minutes</span></span></span>
<span class="r-in"><span><span class="va">obs</span><span class="op">[</span>, <span class="va">temp</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">.N</span>, <span class="fl">7</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp mobility array_id detection acoustics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;int&gt;              &lt;POSc&gt;    &lt;num&gt;    &lt;int&gt;     &lt;int&gt;    &lt;list&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:        1 2016-03-17 01:50:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:        2 2016-03-17 01:52:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:        3 2016-03-17 01:54:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:        4 2016-03-17 01:56:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:        5 2016-03-17 01:58:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:        6 2016-03-17 02:00:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:        7 2016-03-17 02:02:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:        8 2016-03-17 02:04:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:        9 2016-03-17 02:06:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:       10 2016-03-17 02:08:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:       11 2016-03-17 02:10:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:       12 2016-03-17 02:12:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:       13 2016-03-17 02:14:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:       14 2016-03-17 02:16:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:       15 2016-03-17 02:18:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:       16 2016-03-17 02:20:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:       17 2016-03-17 02:22:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:       18 2016-03-17 02:24:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:       19 2016-03-17 02:26:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:       20 2016-03-17 02:28:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:       21 2016-03-17 02:30:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:       22 2016-03-17 02:32:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:       23 2016-03-17 02:34:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:       24 2016-03-17 02:36:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:       25 2016-03-17 02:38:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp mobility array_id detection acoustics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     container depth depth_shallow_eps depth_deep_eps     temp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;list&gt; &lt;num&gt;             &lt;num&gt;          &lt;num&gt;    &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1: &lt;list[2]&gt; 73.78                20             20 5.381298</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2: &lt;list[2]&gt; 73.32                20             20 6.773228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3: &lt;list[2]&gt; 73.32                20             20 7.337118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4: &lt;list[2]&gt; 73.32                20             20 6.971825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5: &lt;list[2]&gt; 73.55                20             20 5.918969</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6: &lt;list[2]&gt; 68.70                20             20 8.334818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7: &lt;list[2]&gt; 72.16                20             20 7.561101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8: &lt;list[2]&gt; 72.85                20             20 7.285438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9: &lt;list[2]&gt; 73.55                20             20 6.749179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10: &lt;list[2]&gt; 73.32                20             20 7.393860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11: &lt;list[2]&gt; 73.32                20             20 7.979044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12: &lt;list[2]&gt; 73.55                20             20 6.856692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13: &lt;list[2]&gt; 73.32                20             20 6.417101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14: &lt;list[2]&gt; 73.32                20             20 6.349568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15: &lt;list[2]&gt; 73.32                20             20 7.174847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16: &lt;list[2]&gt; 72.39                20             20 7.087278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17: &lt;list[2]&gt; 72.39                20             20 7.173980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18: &lt;list[2]&gt; 72.39                20             20 8.180645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19: &lt;list[2]&gt; 72.39                20             20 6.062234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20: &lt;list[2]&gt; 72.39                20             20 8.629503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21: &lt;list[2]&gt; 72.39                20             20 6.707187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22: &lt;list[2]&gt; 65.23                20             20 7.853289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23: &lt;list[2]&gt; 73.55                20             20 6.290827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24: &lt;list[2]&gt; 75.16                20             20 6.496155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25: &lt;list[2]&gt; 76.78                20             20 6.394978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     container depth depth_shallow_eps depth_deep_eps     temp</span>
<span class="r-in"><span><span class="va">obs</span><span class="op">[</span>, <span class="va">temp_cool</span> <span class="op">:=</span> <span class="va">temp</span> <span class="op">-</span> <span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp mobility array_id detection acoustics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;int&gt;              &lt;POSc&gt;    &lt;num&gt;    &lt;int&gt;     &lt;int&gt;    &lt;list&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:        1 2016-03-17 01:50:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:        2 2016-03-17 01:52:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:        3 2016-03-17 01:54:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:        4 2016-03-17 01:56:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:        5 2016-03-17 01:58:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:        6 2016-03-17 02:00:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:        7 2016-03-17 02:02:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:        8 2016-03-17 02:04:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:        9 2016-03-17 02:06:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:       10 2016-03-17 02:08:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:       11 2016-03-17 02:10:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:       12 2016-03-17 02:12:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:       13 2016-03-17 02:14:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:       14 2016-03-17 02:16:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:       15 2016-03-17 02:18:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:       16 2016-03-17 02:20:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:       17 2016-03-17 02:22:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:       18 2016-03-17 02:24:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:       19 2016-03-17 02:26:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:       20 2016-03-17 02:28:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:       21 2016-03-17 02:30:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:       22 2016-03-17 02:32:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:       23 2016-03-17 02:34:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:       24 2016-03-17 02:36:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:       25 2016-03-17 02:38:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp mobility array_id detection acoustics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     container depth depth_shallow_eps depth_deep_eps     temp temp_cool</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;list&gt; &lt;num&gt;             &lt;num&gt;          &lt;num&gt;    &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1: &lt;list[2]&gt; 73.78                20             20 5.381298  3.381298</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2: &lt;list[2]&gt; 73.32                20             20 6.773228  4.773228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3: &lt;list[2]&gt; 73.32                20             20 7.337118  5.337118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4: &lt;list[2]&gt; 73.32                20             20 6.971825  4.971825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5: &lt;list[2]&gt; 73.55                20             20 5.918969  3.918969</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6: &lt;list[2]&gt; 68.70                20             20 8.334818  6.334818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7: &lt;list[2]&gt; 72.16                20             20 7.561101  5.561101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8: &lt;list[2]&gt; 72.85                20             20 7.285438  5.285438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9: &lt;list[2]&gt; 73.55                20             20 6.749179  4.749179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10: &lt;list[2]&gt; 73.32                20             20 7.393860  5.393860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11: &lt;list[2]&gt; 73.32                20             20 7.979044  5.979044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12: &lt;list[2]&gt; 73.55                20             20 6.856692  4.856692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13: &lt;list[2]&gt; 73.32                20             20 6.417101  4.417101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14: &lt;list[2]&gt; 73.32                20             20 6.349568  4.349568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15: &lt;list[2]&gt; 73.32                20             20 7.174847  5.174847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16: &lt;list[2]&gt; 72.39                20             20 7.087278  5.087278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17: &lt;list[2]&gt; 72.39                20             20 7.173980  5.173980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18: &lt;list[2]&gt; 72.39                20             20 8.180645  6.180645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19: &lt;list[2]&gt; 72.39                20             20 6.062234  4.062234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20: &lt;list[2]&gt; 72.39                20             20 8.629503  6.629503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21: &lt;list[2]&gt; 72.39                20             20 6.707187  4.707187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22: &lt;list[2]&gt; 65.23                20             20 7.853289  5.853289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23: &lt;list[2]&gt; 73.55                20             20 6.290827  4.290827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24: &lt;list[2]&gt; 75.16                20             20 6.496155  4.496155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25: &lt;list[2]&gt; 76.78                20             20 6.394978  4.394978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     container depth depth_shallow_eps depth_deep_eps     temp temp_cool</span>
<span class="r-in"><span><span class="va">obs</span><span class="op">[</span>, <span class="va">temp_warm</span> <span class="op">:=</span> <span class="va">temp</span> <span class="op">+</span> <span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp mobility array_id detection acoustics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;int&gt;              &lt;POSc&gt;    &lt;num&gt;    &lt;int&gt;     &lt;int&gt;    &lt;list&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:        1 2016-03-17 01:50:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:        2 2016-03-17 01:52:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:        3 2016-03-17 01:54:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:        4 2016-03-17 01:56:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:        5 2016-03-17 01:58:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:        6 2016-03-17 02:00:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:        7 2016-03-17 02:02:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:        8 2016-03-17 02:04:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:        9 2016-03-17 02:06:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:       10 2016-03-17 02:08:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:       11 2016-03-17 02:10:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:       12 2016-03-17 02:12:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:       13 2016-03-17 02:14:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:       14 2016-03-17 02:16:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:       15 2016-03-17 02:18:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:       16 2016-03-17 02:20:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:       17 2016-03-17 02:22:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:       18 2016-03-17 02:24:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:       19 2016-03-17 02:26:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:       20 2016-03-17 02:28:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:       21 2016-03-17 02:30:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:       22 2016-03-17 02:32:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:       23 2016-03-17 02:34:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:       24 2016-03-17 02:36:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:       25 2016-03-17 02:38:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp mobility array_id detection acoustics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     container depth depth_shallow_eps depth_deep_eps     temp temp_cool</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;list&gt; &lt;num&gt;             &lt;num&gt;          &lt;num&gt;    &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1: &lt;list[2]&gt; 73.78                20             20 5.381298  3.381298</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2: &lt;list[2]&gt; 73.32                20             20 6.773228  4.773228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3: &lt;list[2]&gt; 73.32                20             20 7.337118  5.337118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4: &lt;list[2]&gt; 73.32                20             20 6.971825  4.971825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5: &lt;list[2]&gt; 73.55                20             20 5.918969  3.918969</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6: &lt;list[2]&gt; 68.70                20             20 8.334818  6.334818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7: &lt;list[2]&gt; 72.16                20             20 7.561101  5.561101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8: &lt;list[2]&gt; 72.85                20             20 7.285438  5.285438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9: &lt;list[2]&gt; 73.55                20             20 6.749179  4.749179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10: &lt;list[2]&gt; 73.32                20             20 7.393860  5.393860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11: &lt;list[2]&gt; 73.32                20             20 7.979044  5.979044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12: &lt;list[2]&gt; 73.55                20             20 6.856692  4.856692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13: &lt;list[2]&gt; 73.32                20             20 6.417101  4.417101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14: &lt;list[2]&gt; 73.32                20             20 6.349568  4.349568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15: &lt;list[2]&gt; 73.32                20             20 7.174847  5.174847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16: &lt;list[2]&gt; 72.39                20             20 7.087278  5.087278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17: &lt;list[2]&gt; 72.39                20             20 7.173980  5.173980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18: &lt;list[2]&gt; 72.39                20             20 8.180645  6.180645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19: &lt;list[2]&gt; 72.39                20             20 6.062234  4.062234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20: &lt;list[2]&gt; 72.39                20             20 8.629503  6.629503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21: &lt;list[2]&gt; 72.39                20             20 6.707187  4.707187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22: &lt;list[2]&gt; 65.23                20             20 7.853289  5.853289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23: &lt;list[2]&gt; 73.55                20             20 6.290827  4.290827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24: &lt;list[2]&gt; 75.16                20             20 6.496155  4.496155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25: &lt;list[2]&gt; 76.78                20             20 6.394978  4.394978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     container depth depth_shallow_eps depth_deep_eps     temp temp_cool</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     temp_warm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:  7.381298</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:  8.773228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:  9.337118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:  8.971825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:  7.918969</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6: 10.334818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:  9.561101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:  9.285438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:  8.749179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:  9.393860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:  9.979044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:  8.856692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:  8.417101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:  8.349568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:  9.174847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:  9.087278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:  9.173980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18: 10.180645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:  8.062234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20: 10.629503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:  8.707187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:  9.853289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:  8.290827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:  8.496155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:  8.394978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     temp_warm</span>
<span class="r-in"><span><span class="co"># We will also imagine we have hourly temperature data across the study area</span></span></span>
<span class="r-in"><span><span class="co"># (e.g., from a hydrodynamic model)</span></span></span>
<span class="r-in"><span><span class="va">obs</span><span class="op">[</span>, <span class="va">hour</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">timestamp</span>, <span class="st">"hour"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp mobility array_id detection acoustics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;int&gt;              &lt;POSc&gt;    &lt;num&gt;    &lt;int&gt;     &lt;int&gt;    &lt;list&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:        1 2016-03-17 01:50:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:        2 2016-03-17 01:52:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:        3 2016-03-17 01:54:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:        4 2016-03-17 01:56:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:        5 2016-03-17 01:58:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:        6 2016-03-17 02:00:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:        7 2016-03-17 02:02:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:        8 2016-03-17 02:04:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:        9 2016-03-17 02:06:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:       10 2016-03-17 02:08:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:       11 2016-03-17 02:10:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:       12 2016-03-17 02:12:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:       13 2016-03-17 02:14:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:       14 2016-03-17 02:16:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:       15 2016-03-17 02:18:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:       16 2016-03-17 02:20:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:       17 2016-03-17 02:22:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18:       18 2016-03-17 02:24:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:       19 2016-03-17 02:26:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20:       20 2016-03-17 02:28:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:       21 2016-03-17 02:30:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:       22 2016-03-17 02:32:00      500        1         1   1,0,0,0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:       23 2016-03-17 02:34:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:       24 2016-03-17 02:36:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:       25 2016-03-17 02:38:00      500        1         0          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     timestep           timestamp mobility array_id detection acoustics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     container depth depth_shallow_eps depth_deep_eps     temp temp_cool</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;list&gt; &lt;num&gt;             &lt;num&gt;          &lt;num&gt;    &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1: &lt;list[2]&gt; 73.78                20             20 5.381298  3.381298</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2: &lt;list[2]&gt; 73.32                20             20 6.773228  4.773228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3: &lt;list[2]&gt; 73.32                20             20 7.337118  5.337118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4: &lt;list[2]&gt; 73.32                20             20 6.971825  4.971825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5: &lt;list[2]&gt; 73.55                20             20 5.918969  3.918969</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6: &lt;list[2]&gt; 68.70                20             20 8.334818  6.334818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7: &lt;list[2]&gt; 72.16                20             20 7.561101  5.561101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8: &lt;list[2]&gt; 72.85                20             20 7.285438  5.285438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9: &lt;list[2]&gt; 73.55                20             20 6.749179  4.749179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10: &lt;list[2]&gt; 73.32                20             20 7.393860  5.393860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11: &lt;list[2]&gt; 73.32                20             20 7.979044  5.979044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12: &lt;list[2]&gt; 73.55                20             20 6.856692  4.856692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13: &lt;list[2]&gt; 73.32                20             20 6.417101  4.417101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14: &lt;list[2]&gt; 73.32                20             20 6.349568  4.349568</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15: &lt;list[2]&gt; 73.32                20             20 7.174847  5.174847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16: &lt;list[2]&gt; 72.39                20             20 7.087278  5.087278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17: &lt;list[2]&gt; 72.39                20             20 7.173980  5.173980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18: &lt;list[2]&gt; 72.39                20             20 8.180645  6.180645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19: &lt;list[2]&gt; 72.39                20             20 6.062234  4.062234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20: &lt;list[2]&gt; 72.39                20             20 8.629503  6.629503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21: &lt;list[2]&gt; 72.39                20             20 6.707187  4.707187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22: &lt;list[2]&gt; 65.23                20             20 7.853289  5.853289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23: &lt;list[2]&gt; 73.55                20             20 6.290827  4.290827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24: &lt;list[2]&gt; 75.16                20             20 6.496155  4.496155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25: &lt;list[2]&gt; 76.78                20             20 6.394978  4.394978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     container depth depth_shallow_eps depth_deep_eps     temp temp_cool</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     temp_warm  hour</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;num&gt; &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:  7.381298     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:  8.773228     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:  9.337118     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:  8.971825     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:  7.918969     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6: 10.334818     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:  9.561101     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:  9.285438     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:  8.749179     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:  9.393860     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:  9.979044     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:  8.856692     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:  8.417101     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:  8.349568     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:  9.174847     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:  9.087278     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17:  9.173980     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18: 10.180645     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19:  8.062234     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20: 10.629503     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21:  8.707187     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22:  9.853289     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23:  8.290827     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24:  8.496155     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25:  8.394978     2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     temp_warm  hour</span>
<span class="r-in"><span><span class="va">hours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">obs</span><span class="op">$</span><span class="va">hour</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/setValues.html" class="external-link">setValues</a></span><span class="op">(</span><span class="va">dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">bathy</span>, <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nc</span>   <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">ncell</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">temps</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="va">hours</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">hour</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nc</span>, <span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">hydro</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/setValues.html" class="external-link">setValues</a></span><span class="op">(</span><span class="va">grid</span>, <span class="va">vals</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/mask.html" class="external-link">mask</a></span><span class="op">(</span><span class="va">hydro</span>, <span class="va">dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">bathy</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">temps</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">hours</span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">temps</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pf_forward-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">temps</span></span></span>
<span class="r-in"><span><span class="co"># Define the likelihood of the temp data given location proposals</span></span></span>
<span class="r-in"><span><span class="va">pf_lik_temp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.particles</span>, <span class="va">.obs</span>, <span class="va">.t</span>, <span class="va">.dlist</span>, <span class="va">.drop</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># Extract temps</span></span></span>
<span class="r-in"><span>  <span class="va">temp</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span>  <span class="va">locs</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">.particles</span><span class="op">$</span><span class="va">x_now</span>, <span class="va">.particles</span><span class="op">$</span><span class="va">y_now</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">.particles</span><span class="op">[</span>, <span class="va">temp</span> <span class="op">:=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/extract.html" class="external-link">extract</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">temp</span>,</span></span>
<span class="r-in"><span>                                      y <span class="op">=</span> <span class="va">locs</span>,</span></span>
<span class="r-in"><span>                                      layer <span class="op">=</span> <span class="va">.obs</span><span class="op">$</span><span class="va">hour</span><span class="op">[</span><span class="va">.t</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">value</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="co"># Calculate log-likelihood</span></span></span>
<span class="r-in"><span>  <span class="co"># * We use a simple binary model for illustration</span></span></span>
<span class="r-in"><span>  <span class="co"># * Under this model, temperature observations that are not</span></span></span>
<span class="r-in"><span>  <span class="co"># * ... within a cool/warm limit are impossible</span></span></span>
<span class="r-in"><span>  <span class="va">loglik_temp</span> <span class="op">&lt;-</span> <span class="va">loglik</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span>  <span class="va">.particles</span><span class="op">[</span>, <span class="va">loglik_temp</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">(</span><span class="va">temp</span> <span class="op">&gt;=</span> <span class="va">.obs</span><span class="op">$</span><span class="va">temp_cool</span><span class="op">[</span><span class="va">.t</span><span class="op">]</span> <span class="op">&amp;</span></span></span>
<span class="r-in"><span>                                     <span class="va">temp</span> <span class="op">&lt;=</span> <span class="va">.obs</span><span class="op">$</span><span class="va">temp_warm</span><span class="op">[</span><span class="va">.t</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="co"># Update log-likelihood</span></span></span>
<span class="r-in"><span>  <span class="va">.particles</span><span class="op">[</span>, <span class="va">loglik</span> <span class="op">:=</span> <span class="va">loglik</span> <span class="op">+</span> <span class="va">loglik_temp</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="co"># (optional) Filter impossible locations</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="va">.drop</span> <span class="op">&amp;&amp;</span> <span class="fu">collapse</span><span class="fu">::</span><span class="fu"><a href="https://sebkrantz.github.io/collapse/reference/efficient-programming.html" class="external-link">anyv</a></span><span class="op">(</span><span class="va">.particles</span><span class="op">$</span><span class="va">loglik</span>, <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">.particles</span> <span class="op">&lt;-</span> <span class="va">.particles</span><span class="op">[</span><span class="va">loglik</span> <span class="op">&gt;</span> <span class="op">-</span><span class="cn">Inf</span>, <span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="va">.particles</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># Run simulation accounting for temperature data only</span></span></span>
<span class="r-in"><span><span class="va">dlist</span><span class="op">$</span><span class="va">spatial</span><span class="op">$</span><span class="va">origin</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pf_lik_temp <span class="op">=</span> <span class="va">pf_lik_temp</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-03-18 14:27:53... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 2 (timestep 2): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 3 (timestep 3): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 4 (timestep 4): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 5 (timestep 5): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 6 (timestep 6): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 7 (timestep 7): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 8 (timestep 8): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 9 (timestep 9): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 10 (timestep 10): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 11 (timestep 11): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 12 (timestep 12): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 13 (timestep 13): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 14 (timestep 14): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 15 (timestep 15): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 16 (timestep 16): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 17 (timestep 17): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 18 (timestep 18): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 19 (timestep 19): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 20 (timestep 20): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 21 (timestep 21): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 22 (timestep 22): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 23 (timestep 23): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 24 (timestep 24): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 25 (timestep 25): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-03-18 14:27:53 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="co"># Run simulation accounting for multiple datasets</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pf_lik_ac <span class="op">=</span> <span class="va">pf_lik_ac</span>,</span></span>
<span class="r-in"><span>                                         pf_lik_temp <span class="op">=</span> <span class="va">pf_lik_temp</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-03-18 14:27:53... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 2 (timestep 2): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 3 (timestep 3): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 4 (timestep 4): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 5 (timestep 5): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 6 (timestep 6): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 7 (timestep 7): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 8 (timestep 8): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 9 (timestep 9): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 10 (timestep 10): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 11 (timestep 11): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 12 (timestep 12): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 13 (timestep 13): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 14 (timestep 14): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 15 (timestep 15): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 16 (timestep 16): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 17 (timestep 17): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 18 (timestep 18): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 19 (timestep 19): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 20 (timestep 20): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 21 (timestep 21): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 22 (timestep 22): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 23 (timestep 23): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 24 (timestep 24): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 25 (timestep 25): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-03-18 14:27:53 (duration: ~0 sec(s)). </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (6): Customise (re)sampling</span></span></span>
<span class="r-in"><span><span class="co"># Adjust the number of particles</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                      .n <span class="op">=</span> <span class="fl">1000L</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-03-18 14:27:53... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 2 (timestep 2): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 3 (timestep 3): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 4 (timestep 4): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 5 (timestep 5): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 6 (timestep 6): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 7 (timestep 7): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 8 (timestep 8): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 9 (timestep 9): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 10 (timestep 10): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 11 (timestep 11): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 12 (timestep 12): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 13 (timestep 13): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 14 (timestep 14): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 15 (timestep 15): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 16 (timestep 16): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 17 (timestep 17): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 18 (timestep 18): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 19 (timestep 19): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 20 (timestep 20): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 21 (timestep 21): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 22 (timestep 22): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 23 (timestep 23): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 24 (timestep 24): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 25 (timestep 25): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-03-18 14:27:53 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">out_pff</span><span class="op">$</span><span class="va">history</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (7): Control convergence via `.trial_` arguments</span></span></span>
<span class="r-in"><span><span class="co"># See `vignette("c-demos", package = "patter")` for detailed examples</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (8): Rerun the algorithm from an earlier time step</span></span></span>
<span class="r-in"><span><span class="co"># This is only sensible in the case of a convergence failure,</span></span></span>
<span class="r-in"><span><span class="co"># but for demonstration purposes:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff_1</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-03-18 14:27:53... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 2 (timestep 2): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 3 (timestep 3): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 4 (timestep 4): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 5 (timestep 5): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 6 (timestep 6): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 7 (timestep 7): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 8 (timestep 8): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 9 (timestep 9): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 10 (timestep 10): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 11 (timestep 11): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 12 (timestep 12): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 13 (timestep 13): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 14 (timestep 14): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 15 (timestep 15): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 16 (timestep 16): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 17 (timestep 17): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 18 (timestep 18): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 19 (timestep 19): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 20 (timestep 20): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 21 (timestep 21): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 22 (timestep 22): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 23 (timestep 23): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 24 (timestep 24): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 25 (timestep 25): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-03-18 14:27:53 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff_2</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                        .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                        .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                        .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        .rerun <span class="op">=</span> <span class="va">out_pff_1</span>, .rerun_from <span class="op">=</span> <span class="fl">5L</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-03-18 14:27:53... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 5 (timestep 5): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 6 (timestep 6): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 7 (timestep 7): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 8 (timestep 8): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 9 (timestep 9): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 10 (timestep 10): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 11 (timestep 11): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 12 (timestep 12): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 13 (timestep 13): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 14 (timestep 14): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 15 (timestep 15): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 16 (timestep 16): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 17 (timestep 17): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 18 (timestep 18): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 19 (timestep 19): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 20 (timestep 20): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 21 (timestep 21): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 22 (timestep 22): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 23 (timestep 23): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 24 (timestep 24): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 25 (timestep 25): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-03-18 14:27:54 (duration: ~1 sec(s)). </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (9): Adjust record options</span></span></span>
<span class="r-in"><span><span class="co"># Use `sink` to write to particles to file (slow)</span></span></span>
<span class="r-in"><span><span class="va">pff_folder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"forward"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">pff_folder</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">FALSE</span>, .sink <span class="op">=</span> <span class="va">pff_folder</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-03-18 14:27:54... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 2 (timestep 2): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 3 (timestep 3): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 4 (timestep 4): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 5 (timestep 5): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 6 (timestep 6): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 7 (timestep 7): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 8 (timestep 8): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 9 (timestep 9): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 10 (timestep 10): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 11 (timestep 11): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 12 (timestep 12): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 13 (timestep 13): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 14 (timestep 14): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 15 (timestep 15): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 16 (timestep 16): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 17 (timestep 17): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 18 (timestep 18): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 19 (timestep 19): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 20 (timestep 20): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 21 (timestep 21): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 22 (timestep 22): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 23 (timestep 23): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 24 (timestep 24): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 25 (timestep 25): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-03-18 14:27:54 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="co"># &gt; `save = FALSE` does not save outputs in memory:</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span><span class="op">$</span><span class="va">history</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> list()</span>
<span class="r-in"><span><span class="co"># &gt; `sink` directs outputs to file:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="pf_files.html">pf_files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">pff_folder</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/var/folders/nl/ygb3g6tj24z06jddbqqhj6hw0000gn/T//Rtmp6gn8HN/forward/1.parquet"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/var/folders/nl/ygb3g6tj24z06jddbqqhj6hw0000gn/T//Rtmp6gn8HN/forward/2.parquet"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/var/folders/nl/ygb3g6tj24z06jddbqqhj6hw0000gn/T//Rtmp6gn8HN/forward/3.parquet"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/var/folders/nl/ygb3g6tj24z06jddbqqhj6hw0000gn/T//Rtmp6gn8HN/forward/4.parquet"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[5]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/var/folders/nl/ygb3g6tj24z06jddbqqhj6hw0000gn/T//Rtmp6gn8HN/forward/5.parquet"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[6]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/var/folders/nl/ygb3g6tj24z06jddbqqhj6hw0000gn/T//Rtmp6gn8HN/forward/6.parquet"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># &gt; Check file size (MB)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="pf_files.html">pf_files_size</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">pff_folder</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.220553</span>
<span class="r-in"><span><span class="co"># Use `cols` to restrict the output columns</span></span></span>
<span class="r-in"><span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"timestep"</span>, <span class="st">"cell_now"</span>, <span class="st">"x_now"</span>, <span class="st">"y_now"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                                              .sink <span class="op">=</span> <span class="va">pff_folder</span>,</span></span>
<span class="r-in"><span>                                              .cols <span class="op">=</span> <span class="va">cols</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-03-18 14:27:54... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The directory '/var/folders/nl/ygb3g6tj24z06jddbqqhj6hw0000gn/T//Rtmp6gn8HN/forward' is not empty.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 2 (timestep 2): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 3 (timestep 3): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 4 (timestep 4): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 5 (timestep 5): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 6 (timestep 6): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 7 (timestep 7): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 8 (timestep 8): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 9 (timestep 9): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 10 (timestep 10): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 11 (timestep 11): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 12 (timestep 12): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 13 (timestep 13): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 14 (timestep 14): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 15 (timestep 15): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 16 (timestep 16): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 17 (timestep 17): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 18 (timestep 18): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 19 (timestep 19): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 20 (timestep 20): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 21 (timestep 21): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 22 (timestep 22): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 23 (timestep 23): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 24 (timestep 24): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 25 (timestep 25): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-03-18 14:27:54 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="fu"><a href="pf_files.html">pf_files_size</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">pff_folder</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.10457</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">pff_folder</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (10): Adjust standard `patter-progress` options</span></span></span>
<span class="r-in"><span><span class="co"># Use a log.txt file</span></span></span>
<span class="r-in"><span><span class="va">log.txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".txt"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .verbose <span class="op">=</span> <span class="va">log.txt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">log.txt</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "`patter::pf_forward()` called @ 2024-03-18 14:27:54... "                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2] "... Setting up simulation... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3] "... Defining origin... "                                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4] "... Initiating simulation... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "... ... Index 2 (timestep 2): "                                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] "... ... Index 3 (timestep 3): "                                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11] "... ... Index 4 (timestep 4): "                                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14] "... ... Index 5 (timestep 5): "                                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] "... ... Index 6 (timestep 6): "                                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20] "... ... Index 7 (timestep 7): "                                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23] "... ... Index 8 (timestep 8): "                                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26] "... ... Index 9 (timestep 9): "                                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29] "... ... Index 10 (timestep 10): "                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [32] "... ... Index 11 (timestep 11): "                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [34] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [35] "... ... Index 12 (timestep 12): "                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [36] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [38] "... ... Index 13 (timestep 13): "                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [40] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [41] "... ... Index 14 (timestep 14): "                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [42] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [43] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [44] "... ... Index 15 (timestep 15): "                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [45] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [46] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [47] "... ... Index 16 (timestep 16): "                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [48] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [49] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [50] "... ... Index 17 (timestep 17): "                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [51] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [52] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [53] "... ... Index 18 (timestep 18): "                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [54] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [55] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [56] "... ... Index 19 (timestep 19): "                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [57] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [58] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [59] "... ... Index 20 (timestep 20): "                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [60] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [61] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [62] "... ... Index 21 (timestep 21): "                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [63] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [64] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [65] "... ... Index 22 (timestep 22): "                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [66] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [67] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [68] "... ... Index 23 (timestep 23): "                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [69] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [70] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [71] "... ... Index 24 (timestep 24): "                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [72] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [73] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [74] "... ... Index 25 (timestep 25): "                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [75] "... ... ... Kicking particles... "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [76] "... ... ... (Re)-sampling... "                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [77] "`patter::pf_forward()` call ended @ 2024-03-18 14:27:54 (duration: ~0 sec(s)). "</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">log.txt</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Suppress `.verbose`</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      .verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Suppress progress bar</span></span></span>
<span class="r-in"><span><span class="va">pbo</span> <span class="op">&lt;-</span> <span class="fu">pbapply</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pbapply/man/pboptions.html" class="external-link">pboptions</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="sim_helpers.html">ssv</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out_pff</span> <span class="op">&lt;-</span> <span class="fu">pf_forward</span><span class="op">(</span>.obs <span class="op">=</span> <span class="va">obs</span>,</span></span>
<span class="r-in"><span>                      .dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                      .likelihood <span class="op">=</span> <span class="va">pf_lik_acpf</span>,</span></span>
<span class="r-in"><span>                      .record <span class="op">=</span> <span class="fu"><a href="pf_opt.html">pf_opt_record</a></span><span class="op">(</span>.save <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` called @ 2024-03-18 14:27:55... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Setting up simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Defining origin... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Initiating simulation... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 2 (timestep 2): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 3 (timestep 3): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 4 (timestep 4): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 5 (timestep 5): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 6 (timestep 6): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 7 (timestep 7): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 8 (timestep 8): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 9 (timestep 9): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 10 (timestep 10): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 11 (timestep 11): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 12 (timestep 12): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 13 (timestep 13): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 14 (timestep 14): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 15 (timestep 15): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 16 (timestep 16): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 17 (timestep 17): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 18 (timestep 18): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 19 (timestep 19): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 20 (timestep 20): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 21 (timestep 21): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 22 (timestep 22): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 23 (timestep 23): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 24 (timestep 24): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... Index 25 (timestep 25): </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... Kicking particles... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... ... ... (Re)-sampling... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::pf_forward()` call ended @ 2024-03-18 14:27:55 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="fu">pbapply</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pbapply/man/pboptions.html" class="external-link">pboptions</a></span><span class="op">(</span><span class="va">pbo</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

