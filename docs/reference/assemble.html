<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Assemble observations — assemble • patter</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Assemble observations — assemble"><meta name="description" content="These functions assemble a timeline and observations for the particle filter (pf_filter())."><meta property="og:description" content="These functions assemble a timeline and observations for the particle filter (pf_filter())."><meta property="og:image" content="https://edwardlavender.github.io/patter/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">patter</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a-methodology.html">Methodology</a></li>
    <li><a class="dropdown-item" href="../articles/b-workflow-outline.html">Workflow outline</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/edwardlavender/patter/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Assemble observations</h1>
      <small class="dont-index">Source: <a href="https://github.com/edwardlavender/patter/blob/HEAD/R/assemble-data.R" class="external-link"><code>R/assemble-data.R</code></a></small>
      <div class="d-none name"><code>assemble.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions assemble a timeline and observations for the particle filter (<code><a href="pf_filter.html">pf_filter()</a></code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">assemble_timeline</span><span class="op">(</span>.datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">.step</span>, .trim <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">assemble_acoustics</span><span class="op">(</span><span class="va">.timeline</span>, <span class="va">.detections</span>, <span class="va">.moorings</span>, .services <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">assemble_archival</span><span class="op">(</span><span class="va">.timeline</span>, <span class="va">.archival</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">assemble_custom</span><span class="op">(</span><span class="va">.timeline</span>, <span class="va">.dataset</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">assemble_xinit_containers</span><span class="op">(</span></span>
<span>  <span class="va">.timeline</span>,</span>
<span>  .xinit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">.radius</span>,</span>
<span>  <span class="va">.mobility</span>,</span>
<span>  .map <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .threshold <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">assemble_acoustics_containers</span><span class="op">(</span></span>
<span>  <span class="va">.timeline</span>,</span>
<span>  <span class="va">.acoustics</span>,</span>
<span>  <span class="va">.mobility</span>,</span>
<span>  .map <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .threshold <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">assemble_containers</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--datasets-step-trim">.datasets, .step, .trim<a class="anchor" aria-label="anchor" href="#arg--datasets-step-trim"></a></dt>
<dd><p>Arguments for <code>assemble_timeline()</code>.</p><ul><li><p><code>.datasets</code>—A <code>list</code> of <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code>s, one for each data type, each containing a <code>timestamp</code> column;</p></li>
<li><p><code>.step</code>—A <code>character</code> (such as <code>"2 mins"</code>), passed to <code><a href="https://lubridate.tidyverse.org/reference/round_date.html" class="external-link">lubridate::round_date()</a></code> and <code><a href="https://rdrr.io/r/base/seq.POSIXt.html" class="external-link">seq.POSIXt()</a></code>, that defines the resolution of the timeline;</p></li>
<li><p><code>.trim</code>—A <code>logical</code> variable that defines whether or not to trim the timeline to the overlapping period between datasets;</p></li>
</ul></dd>


<dt id="arg--timeline">.timeline<a class="anchor" aria-label="anchor" href="#arg--timeline"></a></dt>
<dd><p>A <code>POSIXct</code> vector of regularly spaced time stamps that defines the timeline for the simulation (optionally from <code>assemble_timeline()</code>). Here, <code>timeline</code> is used to:</p><ul><li><p>Define the resolution of observations;</p></li>
</ul></dd>


<dt id="arg--detections-moorings-services">.detections, .moorings, .services<a class="anchor" aria-label="anchor" href="#arg--detections-moorings-services"></a></dt>
<dd><p>The <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code>s for <code>assemble_acoustics()</code> (see <code><a href="pat_setup_data.html">pat_setup_data()</a></code>).</p><ul><li><p><code>.detections</code> is a <a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a> of acoustic detections <strong>for a single individual</strong>. This must contain the <code>receiver_id</code> and <code>timestamp</code> columns.</p></li>
<li><p><code>.moorings</code> is a <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> of acoustic receiver deployments. This must contain the <code>receiver_id</code>, <code>receiver_start</code>, and <code>receiver_end</code> columns, plus  (optional) additional parameter columns.</p></li>
<li><p>(optional) <code>.services</code> is a <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> of servicing events. This must contain the <code>receiver_id</code>, <code>service_start</code> and <code>service_end</code> columns.</p></li>
</ul></dd>


<dt id="arg--archival">.archival<a class="anchor" aria-label="anchor" href="#arg--archival"></a></dt>
<dd><p>For <code>assemble_archival()</code>, <code>.archival</code> is a <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> of depth observations <strong>for a single individual</strong> with <code>timestamp</code> and <code>obs</code> columns (see <code>.dataset</code>, below).</p></dd>


<dt id="arg--dataset">.dataset<a class="anchor" aria-label="anchor" href="#arg--dataset"></a></dt>
<dd><p>For <code>assemble_custom()</code>, <code>.dataset</code> is a <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> of observations (such as depth measurements) <strong>for a single individual</strong>. This must contain <code>timestamp</code> and <code>obs</code> columns plus (optional) additional parameter columns.</p></dd>


<dt id="arg--xinit-radius-">.xinit, .radius, <a class="anchor" aria-label="anchor" href="#arg--xinit-radius-"></a></dt>
<dd><p>Dataset arguments for <code>assemble_xinit_containers()</code>.</p><ul><li><p><code>.xinit</code> is a named <code>list</code>, with elements <code>"forward"</code> and <code>"backward"</code>. Elements should be <code>NULL</code> or a <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> of initial state(s) (i.e., capture or recapture locations) for the corresponding filter run. If capture/recapture locations are known exactly, use a one-row <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code>. If starting/ending locations are not known exactly, multi-row <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code>s (with all possible starting/ending locations) are permitted.</p></li>
<li><p><code>.radius</code> is a double that defines the radius of the container around the capture/recapture location that particles must reach (in <code>assemble_acoustics_containers()</code>, <code>.radius = .acoustics$detection_gamma</code>).</p></li>
</ul></dd>


<dt id="arg--mobility-map-threshold">.mobility, .map, .threshold<a class="anchor" aria-label="anchor" href="#arg--mobility-map-threshold"></a></dt>
<dd><p>Shared container threshold arguments (for <code>assemble_xinit_containers()</code> and <code>assemble_acoustics_containers()</code>).</p><ul><li><p><code>.mobility</code> is the maximum movement distance (m) between two time steps (and sets the rate of container contraction).</p></li>
<li><p><code>.map</code>, <code>.threshold</code> are distance threshold options. Specify <code>.map</code> or <code>.threshold</code>:</p><ul><li><p><code>.map</code> is a two-column <code>matrix</code> of the four coordinates of the study area or a <code>SpatRaster</code> or <code>SpatVector</code> from which such a <code>matrix</code> can be obtained. On Linux, the latter two options are only possible if <code>JUILA_SESSION = "FALSE"</code>. <code>.threshold</code> is set automatically based on the distances between container centroids and the boundaries of the study area.</p></li>
<li><p>Otherwise, <code>.threshold</code> is a <code>double</code> that defines the distance threshold.</p></li>
</ul></li>
</ul></dd>


<dt id="arg--acoustics">.acoustics<a class="anchor" aria-label="anchor" href="#arg--acoustics"></a></dt>
<dd><p>Dataset arguments for <code>assemble_acoustics_containers()</code>.</p><ul><li><p><code>.acoustics</code> is a <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> of acoustic observations, from <code>assemble_acoustics()</code>.</p></li>
</ul></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>For <code>assemble_containers()</code>, <code>...</code> represents container <code>list</code>s for multiple data types, such as capture events (<code>assemble_xinit_containers()</code>) and acoustic observations (<code>assemble_acoustics_containers()</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>

<ul><li><p><code>assemble_timeline()</code> returns a POSIXct vector;</p></li>
<li><p><code>assemble_acoustics()</code>, <code>assemble_archival()</code> and <code>assemble_custom()</code> return a <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> for <code><a href="pf_filter.html">pf_filter()</a></code>;</p></li>
<li><p><code>assemble_xinit_containers()</code>, <code>assemble_acoustics_containers()</code> and <code>assemble_containers()</code> return a named <code>list</code>, with one element (<code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code>) for (a) the forward and (b) the backward runs of <code><a href="pf_filter.html">pf_filter()</a></code>;</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="assemble-timeline">Assemble timeline<a class="anchor" aria-label="anchor" href="#assemble-timeline"></a></h2>
    <p><code>assemble_timeline()</code> is a simple function that defines a regular timeline, of resolution <code>.step</code>, from a <code>list</code> of input datasets.</p><ul><li><p>If <code>.trim = FALSE</code>, this defines a sequence of regular time stamps across the full range of time stamps in the input datasets.</p></li>
<li><p>If <code>.trim = TRUE</code>, the timeline is trimmed to the overlapping period between datasets.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="assemble-datasets">Assemble datasets<a class="anchor" aria-label="anchor" href="#assemble-datasets"></a></h2>
    <p><code>assemble_{dataset}()</code> functions are helper routines that prepare timelines observations for different data types as required for the particle filter (<code><a href="pf_filter.html">pf_filter()</a></code>). The filter expects a named <code>list</code> of datasets (one for each data type). Each dataset must contain the following columns:</p><ul><li><p><code>timestamp</code></p></li>
<li><p><code>sensor_id</code></p></li>
<li><p><code>obs</code></p></li>
<li><p>Additional columns with the parameters of the observation model (see <code><a href="glossary.html">glossary</a></code>).</p></li>
</ul><p><code>assemble_acoustics()</code>, <code>assemble_archival()</code> and <code>assemble_custom()</code> assemble 'standard' observational time series:</p><ol><li><p><code>assemble_acoustics()</code> prepares a timeline of acoustic observations as required by the filter <strong>for a single individual</strong>. This function expects a 'standard' detection dataset (that is, a <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> like <code><a href="datasets-mefs.html">dat_detections</a></code> but for a single individual) that defines detections at receivers alongside a moorings dataset (like <code><a href="datasets-mefs.html">dat_moorings</a></code>) that defines receiver deployment periods and, optionally, a <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> of servicing events (when receiver(s) were non-operational). <code>assemble_acoustics()</code> uses these datasets to assemble a complete time series of acoustic observations; that is, a <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> of time stamps and receivers that defines, for each time step and each operational receiver whether (<code>1L</code>) or not (<code>0L</code>) a detection was recorded at that time step. Duplicate observations (that is, detections at the same receiver in the same time step) are dropped. If available in <code>.moorings</code>, additional columns (<code>receiver_alpha</code>, <code>receiver_beta</code> and <code>receiver_gamma</code>) are included as required for the default acoustic observation model (that is, <code><a href="ModelObs.html">ModelObsAcousticLogisTrunc</a></code>). If observation model parameters vary both by receiver and through time, simply amend these columns as required.</p></li>
<li><p><code>assemble_archival()</code> prepares a timeline of archival functions <strong>for a single individual</strong>. This simply wraps <code>assemble_custom()</code> and is informally deprecated.</p></li>
<li><p><code>assemble_custom()</code> prepares a timeline of observations for other data types, as required by the filter. This function expects a <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> that includes, at a minimum, the <code>timestamp</code> and <code>obs</code> columns. The latter defines the observations. The <code>sensor_id</code> column (if unspecified) is simply set to <code>1L</code>. The function re-expresses time stamps at the resolution specified by <code>timeline</code>. Duplicate observations (that is, multiple measurements in the same time step) throw a <code><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></code>.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="assemble-containers">Assemble containers<a class="anchor" aria-label="anchor" href="#assemble-containers"></a></h2>
    <p><code>assemble_containers()</code>, <code>assemble_xinit_containers()</code> and <code>assemble_acoustics_containers()</code> assemble 'container' datasets. A container is a circular region within which an individual must be located, given:</p><ul><li><p>A 'future' observation in a particular place, such as a capture/recapture event or an acoustic detection;</p></li>
<li><p>The time until that observation;</p></li>
<li><p>An individual's maximum movement speed (<code>.mobility</code>);</p></li>
</ul><p>As we approach a 'future' observation, the container within which an individual must be located, according to that observation, shrinks towards the location in which the observation was recorded. Encoding this knowledge in the particle filter (by killing particles outside of a container that are incompatible with a future observation) facilitates convergence with fewer particles, assuming regular resampling (see <code><a href="pf_filter.html">pf_filter()</a></code>). (Otherwise, we rely on some particles ending up in the right region by chance, which can be unlikely if the region in which particles must end up is small (e.g., a receiver's detection container).)</p>
<p>Consider acoustic containers as an example. Suppose an individual can move up to <code>.mobility</code> = 500 m per time step, and two time steps elapse between the first and second detections, then at the moment of the first detection the individual must be within 1000 m of the detection range (say, <code>receiver_gamma</code> = 750 m) of the second receiver; that is, at the moment of first detection, the maximum possible distance of the individual from the receiver that recorded the next detection is 1750 m. As time passes, the container shrinks towards the receiver(s) that recorded the next detection(s), in line with the individual's <code>.mobility</code>. Pro-actively killing particles that move outside these containers (and are incompatible with the next detection) facilitates convergence.</p>
<p>The following functions assemble containers:</p><ol><li><p><code>assemble_xinit_containers()</code> assembles containers for initial capture or recapture events. This is designed for situations in which you know the starting and/or ending location for an individual. Suppose you know the starting location of an individual. We can specify this in the forward filter run via <code>.xinit</code> in <code><a href="pf_filter.html">pf_filter()</a></code>. But what about the backward filter run? For particle smoothing (via <code><a href="pf_smoother_two_filter.html">pf_smoother_two_filter()</a></code>), we need a forward and a backward filter run and these must align sufficiently. Containers provide a mechanism that encourages the backward filter run to end up in the known starting location. Similarly, if we know a recapture location, containers in the forward filter run provide a mechanism that encourages the filter to end up in that location. In <code>assemble_xinit_containers()</code>, <code>.xinit</code> defines the initial locations for the forward/backward filter runs and <code>.radius</code> defines the radius of the starting/ending container. If you know capture/recapture locations exactly, strictly speaking <code>.radius = 0</code>. But it may help to permit some flexibility (e.g., <code>.radius = .mobility</code>) to facilitate convergence (it is unlikely that particles will finish in exactly the right location). If capture/recapture locations are not known exactly, the centroid of the input coordinates is taken as the container's centroid. The container radius at the time of capture/recapture event is given by the maximum distance from the centroid to any of the coordinates plus <code>.radius</code>. As time passes, containers shrink towards this region in line with <code>.mobility</code>.</p></li>
<li><p><code>assemble_acoustics_containers()</code> prepares a dataset of acoustic containers, given the acoustic time series from <code>assemble_acoustics()</code>. Acoustic containers define the region within which an individual must be located at a given time step according to the receiver(s) at which it was next detected. The radius depends on the time until the next detection, the maximum movement speed and the detection range around the receiver at the time of the detection. This function requires the <code><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">tidyr::nest()</a></code>, <code><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">tidyr::unnest()</a></code> and <code><a href="https://rdrr.io/pkg/zoo/man/na.locf.html" class="external-link">zoo::na.locf()</a></code> functions (suggested dependencies).</p></li>
<li><p><code>assemble_containers()</code> is a post-processing function. Use this function to collate the container <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code>s from multiple datasets, i.e., if you have capture/recapture and acoustic containers.</p></li>
</ol><p>All <code>assemble_*_containers()</code> functions assemble a <code>list</code> of <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code>s (with one element for the forward filter run and one element for the backward filter run). Each row defines the maximum distance (<code>radius</code>) of the individual from the location in which a future observation was recorded. For computational efficiency,  <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code>s only include containers with a <code>radius</code> &lt; <code>.threshold</code>. If <code>.map</code> is supplied, the <code>.threshold</code> is set to the maximum distance between each location (e.g., receiver) and the furthest corner of the study area. Otherwise, set the .<code>threshold</code> to the desired value. The <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code>s are used to instantiate a Vector of <code><a href="ModelObs.html">ModelObsContainer</a></code> instances in <code>Julia</code>. (Only one sub-type is used for all container structures for speed.) In the particle filter (<code><a href="pf_filter.html">pf_filter()</a></code>), for each particle, we compute the log-probability of the particle from the distance of the particle from the relevant location (0.0 or -Inf). By re-sampling particles with replacement, particles that move in a way that is incompatible with the future data (e.g., a detection) are killed.</p>
    </div>
    <div class="section level2">
    <h2 id="julia-implementation"><code>Julia</code> implementation<a class="anchor" aria-label="anchor" href="#julia-implementation"></a></h2>
    <p>In <code>Julia</code>, datasets are translated into a hash-table (<code>Dict</code>) of observations (via <a href="https://edwardlavender.github.io/Patter.jl/" class="external-link"><code>Patter.assemble_yobs()</code></a>). For each time stamp with an observation, this includes a <code>Vector</code> of <code>Tuple</code>s, each containing the observation and the associated <code><a href="ModelObs.html">ModelObs</a></code> instance that defines the parameters of the observation model. The particle filter (<a href="https://edwardlavender.github.io/Patter.jl/" class="external-link"><code>Patter.particle_filter()</code></a>) iterates over each time step in the timeline, uses a movement model to simulate animal movement and, for the time stamps with observations, evaluates the likelihood of those observations for the simulated locations (particles).</p>
<p><code>assemble_*()</code> routines are only required for real-world analyses.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Particle filters and smoothers sample states (particles) that represent the possible locations of an individual through time, accounting for all data and the individual's movement.</p><ul><li><p>To simulate artificial datasets, see <code>sim_*()</code> functions (especially <code><a href="sim_path_walk.html">sim_path_walk()</a></code>, <code><a href="sim_array.html">sim_array()</a></code> and <code><a href="sim_observations.html">sim_observations()</a></code>).</p></li>
<li><p>To assemble real-world datasets for the filter, see <code>assemble</code><code>_*()</code> functions.</p></li>
<li><p><code><a href="pf_filter.html">pf_filter()</a></code> runs the filter:</p><ul><li><p>For state types, see <code><a href="State.html">State</a></code>;</p></li>
<li><p>For observation models, see <code><a href="ModelObs.html">ModelObs</a></code>;</p></li>
<li><p>For movement models, see <code><a href="ModelMove.html">ModelMove</a></code>;</p></li>
</ul></li>
<li><p>To run particle smoothing, use <code><a href="pf_smoother_two_filter.html">pf_smoother_two_filter()</a></code>.</p></li>
<li><p>To map emergent patterns of space use, use a <code>map_*()</code> function (such as <code><a href="map_pou.html">map_pou()</a></code>, <code><a href="map_dens.html">map_dens()</a></code> and <code><a href="map_hr.html">map_hr()</a></code>).</p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Edward Lavender</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="patter_run.html">patter_run</a></span><span class="op">(</span>.julia <span class="op">=</span> <span class="cn">FALSE</span>, .geospatial <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dtplyr.tidyverse.org" class="external-link">dtplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#### Define example dataset(s) for a selected individual</span></span></span>
<span class="r-in"><span>  <span class="co"># Study area map</span></span></span>
<span class="r-in"><span>  <span class="va">map</span> <span class="op">&lt;-</span> <span class="fu"><a href="datasets-mefs.html">dat_gebco</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Acoustic detection time series</span></span></span>
<span class="r-in"><span>  <span class="co"># * Observation model parameters are defined in `.moorings`</span></span></span>
<span class="r-in"><span>  <span class="va">det</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="va">dat_detections</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">individual_id</span> <span class="op">==</span> <span class="fl">25L</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"timestamp"</span>, <span class="st">"receiver_id"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Archival time series</span></span></span>
<span class="r-in"><span>  <span class="co"># * Observation model parameters must be included</span></span></span>
<span class="r-in"><span>  <span class="co"># * Here, we define parameters for `?ModelObsDepthNormalTruncSeabed`</span></span></span>
<span class="r-in"><span>  <span class="va">arc</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="va">dat_archival</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">individual_id</span> <span class="op">==</span> <span class="fl">25L</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"timestamp"</span>, obs <span class="op">=</span> <span class="st">"depth"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>depth_sigma <span class="op">=</span> <span class="fl">50</span>, depth_deep_eps <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#### Example (1): Define a timeline</span></span></span>
<span class="r-in"><span>  <span class="co"># Define a timeline manually</span></span></span>
<span class="r-in"><span>  <span class="va">timeline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2016-03-01 00:00:00"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2016-04-01 00:00:00"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  by <span class="op">=</span> <span class="st">"2 mins"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Use `assemble_timeline()` with `.trim = FALSE`</span></span></span>
<span class="r-in"><span>  <span class="va">timeline</span> <span class="op">&lt;-</span> <span class="fu">assemble_timeline</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">det</span>, <span class="va">arc</span><span class="op">)</span>, .step <span class="op">=</span> <span class="st">"2 mins"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">timeline</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Use `assemble_timeline()` with `.trim = TRUE`</span></span></span>
<span class="r-in"><span>  <span class="va">timeline</span> <span class="op">&lt;-</span> <span class="fu">assemble_timeline</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">det</span>, <span class="va">arc</span><span class="op">)</span>, .step <span class="op">=</span> <span class="st">"2 mins"</span>, .trim <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">timeline</span> <span class="op">&lt;-</span> <span class="va">timeline</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">1440</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">timeline</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#### Example (2): Assemble an acoustic timeline</span></span></span>
<span class="r-in"><span>  <span class="co"># Assemble a timeline of acoustic observations (0, 1) and model parameters</span></span></span>
<span class="r-in"><span>  <span class="co"># * The default acoustic observation model parameters are taken from `.moorings`</span></span></span>
<span class="r-in"><span>  <span class="co"># * But can be modified or added afterwards for custom observation models</span></span></span>
<span class="r-in"><span>  <span class="va">acoustics</span> <span class="op">&lt;-</span> <span class="fu">assemble_acoustics</span><span class="op">(</span>.timeline <span class="op">=</span> <span class="va">timeline</span>,</span></span>
<span class="r-in"><span>                                  .detections <span class="op">=</span> <span class="va">det</span>,</span></span>
<span class="r-in"><span>                                  .moorings <span class="op">=</span> <span class="va">dat_moorings</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">acoustics</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#### Example (3): Assemble an archival timeline</span></span></span>
<span class="r-in"><span>  <span class="co"># Assemble a timeline of archival observations and model parameters</span></span></span>
<span class="r-in"><span>  <span class="va">archival</span> <span class="op">&lt;-</span> <span class="fu">assemble_archival</span><span class="op">(</span>.timeline <span class="op">=</span> <span class="va">timeline</span>,</span></span>
<span class="r-in"><span>                                .archival <span class="op">=</span> <span class="va">arc</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">archival</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#### Example (4): Assemble custom datasets</span></span></span>
<span class="r-in"><span>  <span class="va">temperature</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>timestamp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2016-03-17 01:50:30"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                             <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2016-03-17 02:00:30 UTC"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7.6</span>, <span class="fl">7.7</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">temperature</span> <span class="op">&lt;-</span> <span class="fu">assemble_custom</span><span class="op">(</span>.timeline <span class="op">=</span> <span class="va">timeline</span>,</span></span>
<span class="r-in"><span>                                 .dataset <span class="op">=</span> <span class="va">temperature</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">temperature</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#### Example (5): Assemble xinit (capture/recapture) containers</span></span></span>
<span class="r-in"><span>  <span class="co"># (A) If we know the capture location, containers are defined for the backward filter run</span></span></span>
<span class="r-in"><span>  <span class="va">capture_xy</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">708913.6</span>, y <span class="op">=</span> <span class="fl">6256280</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">xinit_containers</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu">assemble_xinit_containers</span><span class="op">(</span>.timeline <span class="op">=</span> <span class="va">timeline</span>,</span></span>
<span class="r-in"><span>                              .xinit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>forward <span class="op">=</span> <span class="va">capture_xy</span>,</span></span>
<span class="r-in"><span>                                            backward <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                              .radius <span class="op">=</span> <span class="fl">750</span>,</span></span>
<span class="r-in"><span>                              .mobility <span class="op">=</span> <span class="fl">750</span>,</span></span>
<span class="r-in"><span>                              .map <span class="op">=</span> <span class="va">map</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># (B) If we know the recapture location, containers are defined for the forward run</span></span></span>
<span class="r-in"><span>  <span class="va">recapture_xy</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">707816.5</span>, y <span class="op">=</span> <span class="fl">6265746</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">xinit_containers</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu">assemble_xinit_containers</span><span class="op">(</span>.timeline <span class="op">=</span> <span class="va">timeline</span>,</span></span>
<span class="r-in"><span>                              .xinit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>forward <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>                                            backward <span class="op">=</span> <span class="va">recapture_xy</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                              .radius <span class="op">=</span> <span class="fl">750</span>,</span></span>
<span class="r-in"><span>                              .mobility <span class="op">=</span> <span class="fl">750</span>,</span></span>
<span class="r-in"><span>                              .map <span class="op">=</span> <span class="va">map</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># (C) If we know capture &amp; recapture locations, containers are defined for both filter runs</span></span></span>
<span class="r-in"><span>  <span class="va">xinit_containers</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu">assemble_xinit_containers</span><span class="op">(</span>.timeline <span class="op">=</span> <span class="va">timeline</span>,</span></span>
<span class="r-in"><span>                              .xinit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>forward <span class="op">=</span> <span class="va">capture_xy</span>,</span></span>
<span class="r-in"><span>                                            backward <span class="op">=</span> <span class="va">recapture_xy</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                              .radius <span class="op">=</span> <span class="fl">750</span>,</span></span>
<span class="r-in"><span>                              .mobility <span class="op">=</span> <span class="fl">750</span>,</span></span>
<span class="r-in"><span>                              .map <span class="op">=</span> <span class="va">map</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># (D) A set of possible capture/recapture locations is permitted:</span></span></span>
<span class="r-in"><span>  <span class="co"># (i) Define possible starting locations</span></span></span>
<span class="r-in"><span>  <span class="va">capture_xy</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">capture_xy</span><span class="op">$</span><span class="va">x</span>, <span class="va">capture_xy</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">map</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/buffer.html" class="external-link">buffer</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/sample.html" class="external-link">spatSample</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10L</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/crds.html" class="external-link">crds</a></span><span class="op">(</span>df <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/setDT.html" class="external-link">setDT</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># (ii) Define possible recapture locations</span></span></span>
<span class="r-in"><span>  <span class="va">recapture_xy</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">recapture_xy</span><span class="op">$</span><span class="va">x</span>, <span class="va">recapture_xy</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">map</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/buffer.html" class="external-link">buffer</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/sample.html" class="external-link">spatSample</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10L</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/crds.html" class="external-link">crds</a></span><span class="op">(</span>df <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/setDT.html" class="external-link">setDT</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># (iii) Define containers</span></span></span>
<span class="r-in"><span>  <span class="va">xinit_containers</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu">assemble_xinit_containers</span><span class="op">(</span>.timeline <span class="op">=</span> <span class="va">timeline</span>,</span></span>
<span class="r-in"><span>                              .xinit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>forward <span class="op">=</span> <span class="va">capture_xy</span>,</span></span>
<span class="r-in"><span>                                            backward <span class="op">=</span> <span class="va">recapture_xy</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                              .radius <span class="op">=</span> <span class="fl">750</span>,</span></span>
<span class="r-in"><span>                              .mobility <span class="op">=</span> <span class="fl">750</span>,</span></span>
<span class="r-in"><span>                              .map <span class="op">=</span> <span class="va">map</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#### Example (6): Assemble acoustic containers</span></span></span>
<span class="r-in"><span>  <span class="co"># Assemble acoustic containers for the `acoustics` dataset above</span></span></span>
<span class="r-in"><span>  <span class="va">acoustics_containers</span> <span class="op">&lt;-</span> <span class="fu">assemble_acoustics_containers</span><span class="op">(</span>.timeline <span class="op">=</span> <span class="va">timeline</span>,</span></span>
<span class="r-in"><span>                                              .acoustics <span class="op">=</span> <span class="va">acoustics</span>,</span></span>
<span class="r-in"><span>                                              .mobility <span class="op">=</span> <span class="fl">750</span>,</span></span>
<span class="r-in"><span>                                              .map <span class="op">=</span> <span class="va">map</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># As for assemble_xinit_containers(), this function returns a list:</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">acoustics_containers</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Use the `forward` element for `pf_filter()` with `.direction = "forward"`</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">acoustics_containers</span><span class="op">$</span><span class="va">forward</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Use the `backward` for `pf_filter()` with `.direction = "backward"`</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">acoustics_containers</span><span class="op">$</span><span class="va">backward</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#### Example (7): Collate containers for multiple datasets</span></span></span>
<span class="r-in"><span>  <span class="va">containers</span> <span class="op">&lt;-</span> <span class="fu">assemble_containers</span><span class="op">(</span><span class="va">xinit_containers</span>, <span class="va">acoustics_containers</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#### Example (8): Implement particle filter</span></span></span>
<span class="r-in"><span>  <span class="co"># Use `pf_filter()` to implement the particle filter</span></span></span>
<span class="r-in"><span>  <span class="co"># A list of assembled datasets is passed to the `yobs` argument</span></span></span>
<span class="r-in"><span>  <span class="co"># The corresponding `ModelObs` sub-types must also be specified, e.g.:</span></span></span>
<span class="r-in"><span>  <span class="co"># * `ModelObsAcousticLogisTrunc`</span></span></span>
<span class="r-in"><span>  <span class="co"># * `ModelObsDepthUniformSeabed`</span></span></span>
<span class="r-in"><span>  <span class="co"># * `ModelObsContainer`</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

