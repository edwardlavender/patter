<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>PF: particle diagnostics — pf_diag • patter</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="PF: particle diagnostics — pf_diag"><meta property="og:description" content="These are internal functions that calculate diagnostic statistics from selected particle samples."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patter</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/a-methodology.html">Methodology</a>
    </li>
    <li>
      <a href="../articles/b-workflow-outline.html">Workflow</a>
    </li>
    <li>
      <a href="../articles/c-workflow-example.html">A revised implementation of the `flapper` algorithms</a>
    </li>
    <li>
      <a href="../articles/d-demos.html">Demos</a>
    </li>
    <li>
      <a href="../articles/e-faqs.html">FAQs</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/edwardlavender/patter/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>PF: particle diagnostics</h1>
    <small class="dont-index">Source: <a href="https://github.com/edwardlavender/patter/blob/HEAD/R/pf-diagnostics.R" class="external-link"><code>R/pf-diagnostics.R</code></a></small>
    <div class="hidden name"><code>pf_diag.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These are internal functions that calculate diagnostic statistics from selected particle samples.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">.pf_diag_any</span><span class="op">(</span><span class="va">.particles</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">.pf_diag_ess</span><span class="op">(</span><span class="va">.likelihood</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">.pf_diag_nu</span><span class="op">(</span><span class="va">.cells</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">.pf_diag</span><span class="op">(</span><span class="va">.particles</span>, <span class="va">.t</span>, .trial <span class="op">=</span> <span class="cn">NA_integer_</span>, <span class="va">.label</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">.pf_diag_bind</span><span class="op">(</span><span class="va">.diag</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">.pf_diag_collect</span><span class="op">(</span><span class="va">.diagnostics</span>, <span class="va">.iter_m</span>, <span class="va">.iter_i</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="particle-diagnostics">
    <h2>Particle diagnostics</h2>
    <p>Particle diagnostics measure how the diversity of particle samples evolves through time. Current diagnostics include the number of unique particle samples at each time step and the effective sample size. Particle diagnostics have multiple uses:</p><ul><li><p><strong>Convergence.</strong> Diagnostics from the forward run can indicate the causes of convergence failures. This is possible because <code><a href="pf_forward.html">pf_forward()</a></code> keeps track of diagnostics at every stage of the algorithm, recording at each time step the diversity of particle proposals, the diversity remaining after each likelihood function evaluation and the diversity following (re)-sampling. See <code><a href="../articles/d-demos.html">vignette("d-demos", package = "patter")</a></code> for an illustration.</p></li>
<li><p><strong>Sampling.</strong> Diagnostics indicate sampling sufficiency. In general, a low ratio of the number of unique particles to the total number of particles indicates effective coverage of the possible locations of an individual.</p></li>
<li><p><strong>Particle degeneracy.</strong> Diagnostics measure particle degeneracy, i.e., the decay in the number of unique particles through time as trajectories are sooner-or-later rendered invalid by observations. Comparison of particle diagnostics between <code><a href="pf_backward_killer.html">pf_backward_killer()</a></code> and <code>pf_backward_sampler()</code> is particular valuable in this context. Both functions perform a backward refinement of particles from the forward sampler, but the former is crude but fast while the latter is sophisticated but expensive. Tracking particle diagnostics can indicate whether <code>pf_backward_sampler()</code> is worth the cost.</p></li>
</ul></div>
    <div id="internal-routines">
    <h2>Internal routines</h2>
    
<ul><li><p><code>.pf_diag_any()</code> identifies whether or not any particle samples remain;</p></li>
<li><p><code>.pf_diag_ess()</code> calculates effective sample size;</p></li>
<li><p><code>.pf_diag_nu()</code> counts the number of unique particle samples;</p></li>
<li><p><code>.pf_diag()</code> is a wrapper function that collates diagnostics;</p></li>
</ul></div>
    <div id="exported-wrappers">
    <h2>Exported wrappers</h2>
    <p>In <code><a href="pf_forward.html">pf_forward</a></code>, diagnostics are necessarily calculated on the fly by <code>.pf_diag</code><code>_()</code> functions and simply require extraction from outputs via <code><a href="pf_forward_diagnostics.html">pf_forward_diagnostics()</a></code>. However, note that the forward simulation necessitates the calculation of multiple diagnostics at each time step and <code><a href="pf_forward_diagnostics.html">pf_forward_diagnostics()</a></code> attempts to collate all diagnostics in memory, which is not memory safe.</p>
<p><code><a href="pf_backward_killer.html">pf_backward_killer()</a></code> only tracks particle samples and it is therefore necessary to calculate diagnostics from particle samples post-hoc. A single set of diagnostics is calculated for each time step, so this function is (effectively) memory safe.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index">
<ul><li><p><code><a href="pf_forward.html">pf_forward()</a></code>, <code><a href="pf_backward_killer.html">pf_backward_killer()</a></code> and <code>pf_backward_sampler()</code> implement the forward simulation and the backward pass;</p></li>
<li><p><code><a href="pf_forward_diagnostics.html">pf_forward_diagnostics()</a></code> and <code><a href="pf_backward_killer_diagnostics.html">pf_backward_killer_diagnostics()</a></code> collect diagnostics;</p></li>
<li><p><code>.pf_diag</code><code>_()</code> functions are internal routines that calculate diagnostic statistics;</p></li>
</ul></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Edward Lavender</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

