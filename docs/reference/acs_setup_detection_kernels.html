<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>AC* set up: detection kernels — acs_setup_detection_kernels • patter</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="AC* set up: detection kernels — acs_setup_detection_kernels"><meta property="og:description" content="This function is part of a set of acs_setup_*() functions that prepare the layers required to evaluate the likelihood of acoustic observations in an AC*PF algorithm. The function prepares the detection kernels."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patter</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/a-methodology.html">Methodology</a>
    </li>
    <li>
      <a href="../articles/b-workflow-outline.html">Workflow outline</a>
    </li>
    <li>
      <a href="../articles/c-workflow-example.html">Example workflow</a>
    </li>
    <li>
      <a href="../articles/d-demos.html">Demos</a>
    </li>
    <li>
      <a href="../articles/e-faqs.html">FAQs</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/edwardlavender/patter/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>AC* set up: detection kernels</h1>
    <small class="dont-index">Source: <a href="https://github.com/edwardlavender/patter/blob/HEAD/R/acs-setup.R" class="external-link"><code>R/acs-setup.R</code></a></small>
    <div class="hidden name"><code>acs_setup_detection_kernels.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is part of a set of <code>acs_setup_*()</code> functions that prepare the layers required to evaluate the likelihood of acoustic observations in an AC*PF algorithm. The function prepares the detection kernels.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">acs_setup_detection_kernels</span><span class="op">(</span></span>
<span>  <span class="va">.dlist</span>,</span>
<span>  .pdetkernel <span class="op">=</span> <span class="va">acs_setup_detection_kernel</span>,</span>
<span>  .verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"patter.verbose"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="source">
    <h2>Source</h2>
    <p>This function is based on <a href="https://edwardlavender.github.io/flapper/reference/acs_setup_detection_kernels.html" class="external-link"><code><a href="https://edwardlavender.github.io/flapper/reference/acs_setup_detection_kernels.html" class="external-link">flapper::acs_setup_detection_kernels</a></code></a>.</p>
    </div>
    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>.dlist</dt>
<dd><p>A named <code>list</code> of data and parameters from <code><a href="pat_setup_data.html">pat_setup_data()</a></code>. This function requires:</p><ul><li><p><code>.dlist$data$moorings</code>, with the following columns: <code>receiver_id</code>, <code>receiver_start</code>, <code>receiver_end</code>, <code>receiver_x</code> and <code>receiver_y</code>, plus any columns used internally by <code>.pdetkernel</code> (see below).</p></li>
<li><p>(optional) <code>.dlist$data$services</code>, with the following columns: <code>receiver_id</code>, <code>service_start</code> and <code>service_end</code> (see <code><a href="make_matrix_receivers.html">make_matrix_receivers()</a></code>).</p></li>
<li><p><code>.dlist$spatial$bathy</code>, which defines the grid on which detection kernels are represented. <code>NA</code>s are used as a mask.</p></li>
<li><p><code>.dlist$pars$spatna</code>, which defines whether or not masking is required.</p></li>
</ul></dd>


<dt>.pdetkernel, ...</dt>
<dd><p>A <code>function</code> that defines the detection kernel as a <code>SpatRaster</code> around a receiver (see <code><a href="acs_setup_detection_kernel.html">acs_setup_detection_kernel()</a></code> for an example). This must accept three arguments (even if they are ignored):</p><ul><li><p><code>.mooring</code>---A one-row <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> that contains the information in <code>.dlist$data$moorings</code> for a specific receiver;</p></li>
<li><p><code>.bathy</code>---the <code>.dlist$spatial$bathy</code> <code>SpatRaster</code>;</p></li>
<li><p><code>.mask</code>---a <code>logical</code> variable passed down from <code>.dlist$pars$spatna</code>;</p></li>
<li><p><code>...</code> Additional arguments passed via <code>acs_setup_detection_kernels()</code>;</p></li>
</ul></dd>


<dt>.verbose</dt>
<dd><p>User output control (see <code><a href="patter-progress.html">patter-progress</a></code> for supported options).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The function returns a named <code>list</code>, with the following elements:</p><ul><li><p><strong><code>pkernel</code></strong>. A named <code>list</code>, with one element for each receiver. Each element is a <code>SpatRaster</code> of the detection kernel around that receiver. Cells values define the probability of a detection, as modelled by <code>.pdetkernel</code>. In an AC*PF algorithm, these kernels are used to calculate the likelihood of the acoustic data (detections/non-detections). This process effectively up-weights particles near to the receiver(s) that recorded detections and down-weights particles further afield.</p></li>
<li><p><strong><code>loglik</code></strong>. A named <code>list</code>, with one element for each array design. Each element is a <code>SpatRaster</code> that defines the log-likelihood of non-detection at all operational receivers in that array. In an AC*PF algorithm, during detection gaps, we can extract the log-likelihood of the acoustic data (non detection) at particle locations directly from this layer.</p></li>
</ul><p>To improve speed in <code><a href="pf_forward.html">pf_forward()</a></code>, use <code>terra:::readAll()</code> to force <code>SpatRaster</code>s into memory, if possible.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>An AC*PF algorithm is a particle filtering algorithm that incorporates acoustic observations to reconstruct the possible movements of an individual (see <code><a href="pf_forward.html">pf_forward()</a></code>). At each time step in such an algorithm, we evaluate the likelihood of acoustic observations (the presence or absence of detections at each operational receiver, accounting for receiver placement) given particle samples. The likelihood is evaluated using a Bernoulli distribution and a detection probability parameter. A detection kernel is a spatial representation of detection probability <em>around a specific receiver</em>. This typically declines with distance around a receiver, hence the default formulation of the <code>.pdetkernel</code> function. This function permits receiver-specific kernels, if required (but time-varying kernels are not currently supported and require custom likelihood functions in <code><a href="pf_forward.html">pf_forward()</a></code>). Pre-calculating detection kernels is a potentially slow operation, especially for large and/or high-resolution grids (and we would like to improve this in future). However, this penalty is only required once and improves the speed of downstream likelihood calculations in <code><a href="pf_lik.html">pf_lik_ac()</a></code> in <code><a href="pf_forward.html">pf_forward()</a></code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>To implement an AC*PF algorithm, see:</p><ol><li><p><code><a href="pat_setup_data.html">pat_setup_data()</a></code> to set up datasets;</p></li>
<li><p><code>acs_setup_*()</code> functions to prepare layers required for likelihood calculations, i.e.:</p><ul><li><p><code><a href="acs_setup_detection_overlaps.html">acs_setup_detection_overlaps()</a></code>, which identifies detection overlaps;</p></li>
<li><p><code><a href="acs_setup_detection_kernel.html">acs_setup_detection_kernel()</a></code>, which prepares a detection kernel;</p></li>
<li><p><code>acs_setup_detection_kernels()</code>, which prepares detection kernels;</p></li>
</ul></li>
<li><p><code><a href="pf_setup_obs.html">pf_setup_obs()</a></code> to define a timeline of observations</p></li>
<li><p><code><a href="pf_forward.html">pf_forward()</a></code> to run the simulation (using <code><a href="pf_lik.html">pf_lik_ac()</a></code> to evaluate the likelihood of acoustic observations);</p></li>
</ol></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Edward Lavender</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: data.table</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Define example datasets</span></span></span>
<span class="r-in"><span><span class="co"># Define example 'moorings' dataset</span></span></span>
<span class="r-in"><span><span class="co"># * Receivers 3 and 4 overlap in space but receiver 5 is further afield</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>receiver_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                receiver_start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2016-01-01"</span>, <span class="st">"2016-01-01"</span>, <span class="st">"2016-01-01"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                receiver_end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2016-01-05"</span>, <span class="st">"2016-01-05"</span>, <span class="st">"2016-01-05"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                receiver_easting <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">706124.9</span>, <span class="fl">706012.7</span>, <span class="fl">709379.0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                receiver_northing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6265030</span>, <span class="fl">6264993</span>, <span class="fl">6260093</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                receiver_range <span class="op">=</span> <span class="fl">750</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Define example 'services' dataset</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>receiver_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                service_start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2016-01-01"</span>, <span class="st">"2016-01-01"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                service_end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2016-01-01"</span>, <span class="st">"2016-01-01"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Set up data list as usual</span></span></span>
<span class="r-in"><span><span class="va">dlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="pat_setup_data.html">pat_setup_data</a></span><span class="op">(</span>.moorings <span class="op">=</span> <span class="va">m</span>,</span></span>
<span class="r-in"><span>                        .services <span class="op">=</span> <span class="va">s</span>,</span></span>
<span class="r-in"><span>                        .bathy <span class="op">=</span> <span class="fu"><a href="datasets-mefs.html">dat_gebco</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        .lonlat <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `.moorings` coordinates coerced onto `.bathy` grid.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#### Example (1): Implement function using specified inputs</span></span></span>
<span class="r-in"><span><span class="co"># Implement function</span></span></span>
<span class="r-in"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu">acs_setup_detection_kernels</span><span class="op">(</span>.dlist <span class="op">=</span> <span class="va">dlist</span>,</span></span>
<span class="r-in"><span>                                 .pdetkernel <span class="op">=</span> <span class="va">acs_setup_detection_kernel</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::acs_setup_detection_kernels()` called @ 2024-03-18 14:27:30... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Getting Pr(detection)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Getting Pr(non-detection)... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Getting log-likelihood surfaces for non-detection... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ... Listing outputs ... </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> `patter::acs_setup_detection_kernels()` call ended @ 2024-03-18 14:27:30 (duration: ~0 sec(s)). </span>
<span class="r-in"><span><span class="co"># Examine list elements</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Length Class  Mode</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pkernel 3      -none- list</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> loglik  2      -none- list</span>
<span class="r-in"><span><span class="co"># Examine detection probability kernels</span></span></span>
<span class="r-in"><span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">m</span><span class="op">$</span><span class="va">receiver_id</span><span class="op">)</span>, \<span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">k</span><span class="op">$</span><span class="va">pkernel</span><span class="op">[[</span><span class="va">id</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">m</span><span class="op">[</span><span class="va">m</span><span class="op">$</span><span class="va">receiver_id</span> <span class="op">==</span> <span class="va">id</span>, <span class="fu">.</span><span class="op">(</span><span class="va">receiver_easting</span>, <span class="va">receiver_northing</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>         cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="acs_setup_detection_kernels-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Examine likelihood of non detection for each unique array design</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">k</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, \<span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">k</span><span class="op">$</span><span class="va">loglik</span><span class="op">[[</span><span class="va">id</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">m</span><span class="op">[</span><span class="va">m</span><span class="op">$</span><span class="va">receiver_id</span> <span class="op">==</span> <span class="va">id</span>, <span class="fu">.</span><span class="op">(</span><span class="va">receiver_easting</span>, <span class="va">receiver_northing</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>         cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="acs_setup_detection_kernels-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

