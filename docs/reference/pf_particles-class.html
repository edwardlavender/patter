<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>PF: pf_particles objects — pf_particles-class • patter</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="PF: pf_particles objects — pf_particles-class"><meta property="og:description" content="An S3 class that defines the named list returned by pf_forward() and pf_backward_*()."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">patter</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/a-methodology.html">Methodology</a>
    </li>
    <li>
      <a href="../articles/b-workflow-outline.html">Workflow outline</a>
    </li>
    <li>
      <a href="../articles/c-workflow-example.html">Example workflow</a>
    </li>
    <li>
      <a href="../articles/d-demos.html">Demos</a>
    </li>
    <li>
      <a href="../articles/e-faqs.html">FAQs</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/edwardlavender/patter/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>PF: <code>pf_particles</code> objects</h1>
    <small class="dont-index">Source: <a href="https://github.com/edwardlavender/patter/blob/HEAD/R/pf-classes.R" class="external-link"><code>R/pf-classes.R</code></a></small>
    <div class="hidden name"><code>pf_particles-class.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>An S3 class that defines the named <code>list</code> returned by <code><a href="pf_forward.html">pf_forward()</a></code> and <code>pf_backward_*()</code>.</p>
    </div>


    <div id="structure">
    <h2>Structure</h2>
    <p><code>pf_particles</code> is a label used to denote outputs from selected functions in <code><a href="patter.html">patter</a></code>. The structure of this class is not strictly defined and primarily exists to streamline documentation. At the time of writing, <code>pf_particles</code> objects may comprise the following elements:</p><ul><li><p><code>history</code>---a <code>list</code> of particle samples;</p></li>
<li><p><code>convergence</code>---a <code>logical</code> value that defines convergence success;</p></li>
<li><p><code>time</code>---a <code>data.table</code> of timings;</p></li>
</ul></div>
    <div id="history">
    <h2><code>history</code></h2>
    <p><code>history</code> is a <code>list</code> with one element for each time step. Each element is a <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> that contains location (particle) samples. Each row is a specific sample.</p>
<p>In <code><a href="pf_forward.html">pf_forward()</a></code>, the columns in this table depend on <code><a href="pf_forward.html">pf_forward()</a></code>'s <code>.likelihood</code> function(s) and the <code>.record$cols</code> argument (see <code><a href="pf_opt.html">pf_opt_record()</a></code>). By default, the following columns are computed:</p><ul><li><p><code>timestep</code>---an <code>integer</code> vector that defines the time step;</p></li>
<li><p><code>cell_past</code>---an <code>integer</code> vector that identifies the grid cells of previous particle samples;</p></li>
<li><p><code>x_past</code>, <code>y_past</code>---<code>numeric</code> vectors that define the coordinates of previous particle samples;</p></li>
<li><p><code>cell_now</code>---an <code>integer</code> vector that identifies the grid cells of current particle samples;</p></li>
<li><p><code>x_now</code>, <code>y_now</code>---<code>numeric</code> vectors that define the coordinates of current particle samples;</p></li>
<li><p><code>lik</code>---a <code>numeric</code> vector of likelihoods;</p></li>
<li><p><code>weight</code>---a <code>numeric</code> vectors of weights;</p></li>
</ul><p>Coordinates are defined in continuous space by <code><a href="pf_propose.html">pf_rpropose_kick()</a></code> and on the grid by <code><a href="pf_propose.html">pf_rpropose_reachable()</a></code>.</p>
<p>The likelihood column (<code>lik</code>) is the product of the likelihood scores from each likelihood function. (Successive likelihood functions should <em>update</em> this column.)</p>
<p>The weight column (<code>weight</code>) contains particle weights. Weights are proportional to the product of weights from the previous time step, the likelihood at the current time step (and the movement density, in the case of directed sampling). After resampling, we obtain <code>.n</code> equally weighted particles. Weights are normalised to sum to one at each time step.</p>
<p>Additional columns may be included in <code>history</code> if computed by inputted likelihood functions. At the time of writing, most default likelihood functions calculate likelihoods without defining additional columns. However, <code><a href="pf_lik.html">pf_lik_dc()</a></code> adds <code>bathy</code> column, with values extracted from <code>.dlist$spatial$bathy</code>.
If directed sampling is used, <code>bathy</code> and <code>dens</code> columns are included where required (after the first time step). <code>dens</code> is <code>numeric</code> vector that defines the probability density of moving from <code>(x_past, y_past</code>) to <code>(x_now, y_now)</code>.</p>
<p>Since columns are recorded only when required, not all columns are recorded at each time step. To combine <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code>s, use <code><a href="pf_history.html">.pf_history_dt()</a></code>.</p>
<p>If <code>.record$save = FALSE</code>, <code>.history</code> is an empty <code>list</code> and the individual <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code>s are written to file in <code>{.record$sink}/history/</code> (see <code><a href="pf_opt.html">pf_opt_record()</a></code>).</p>
    </div>
    <div id="convergence">
    <h2><code>convergence</code></h2>
    <p>For <code><a href="pf_forward.html">pf_forward()</a></code>, <code>convergence</code> is a <code>logical</code> variable that defines whether or not the algorithm successfully converged (i.e., reached the end of the time series).</p>
    </div>
    <div id="time">
    <h2><code>time</code></h2>
    <p>A <code>data.table</code> that records the <code>start</code>, <code>end</code> and <code>duration</code> of algorithm runs (as <code>POSIXct</code> and <code><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime</a></code> objects).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>The particle filter samples locations (particles) that represent the possible locations of an individual through time, accounting for the data and the individual's movement.</p><ul><li><p>To set up data, use <code><a href="pat_setup_data.html">pat_setup_data()</a></code>.</p></li>
<li><p>To implement the particle filter, use <code><a href="pf_forward.html">pf_forward()</a></code>:</p><ul><li><p>To set up an observations timeline, use <code><a href="pf_setup_obs.html">pf_setup_obs()</a></code>;</p></li>
<li><p>For proposal (movement) models, see <code><a href="pf_propose.html">pf_propose</a></code>;</p></li>
<li><p>For likelihood functions, to evaluate the likelihood of the data at proposal locations, see <code><a href="pf_lik.html">pf_lik</a></code>;</p></li>
<li><p>For sampling functions, to (re)sample plausible proposal locations, see <code><a href="pf_sample.html">pf_sample</a></code>;</p></li>
<li><p>For tuning parameters, see <code><a href="pf_opt.html">pf_opt</a></code>;</p></li>
</ul></li>
<li><p>To map patterns of space use, use:</p><ul><li><p>The backward smoother (TO DO);</p></li>
<li><p><code><a href="pf_coord.html">pf_coord()</a></code> to extract coordinates;</p></li>
<li><p>A <code>map_*()</code> function, such as <code><a href="map_pou.html">map_pou()</a></code>, <code><a href="map_dens.html">map_dens()</a></code> and/or <code><a href="map_hr.html">map_hr</a></code><code>_()</code>;</p></li>
</ul></li>
<li><p>To reconstruct movement paths, use the backward sampler (TO DO).</p></li>
<li><p>For additional utilities, see supporting <code>pf_*()</code> functions, such as <code><a href="pf_files.html">pf_files()</a></code>, <code><a href="pf_files.html">pf_files_size()</a></code>, <code><a href="pf_plot_history.html">pf_plot_history()</a></code> and <code><a href="pf_diag.html">pf_diag_summary()</a></code>.</p></li>
</ul></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Edward Lavender</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

