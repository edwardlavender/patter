<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Changelog â€¢ patter</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Changelog"><meta property="og:image" content="https://edwardlavender.github.io/patter/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">patter</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/a-methodology.html">Methodology</a></li>
    <li><a class="dropdown-item" href="../articles/b-workflow-outline.html">Workflow outline</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/edwardlavender/patter/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-news">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Changelog</h1>
      <small>Source: <a href="https://github.com/edwardlavender/patter/blob/HEAD/NEWS.md" class="external-link"><code>NEWS.md</code></a></small>
    </div>

    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.0.1" id="patter-201">
<code>patter</code> 2.0.1<a class="anchor" aria-label="anchor" href="#patter-201"></a></h2>
<p>This version fixes the website documentation <a href="https://edwardlavender.github.io/patter/" class="uri">https://edwardlavender.github.io/patter/</a>.</p>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="2.0.0" id="patter-v200">
<code>patter</code> v2.0.0<a class="anchor" aria-label="anchor" href="#patter-v200"></a></h2>
<p><code>patter</code> v 2.0.0 includes some major internal and external changes associated with a revamp required to permit use on Linux and other improvements. There are some breaking changes in the API of some functions as a result. We have also added new data-assembly routines, such as <code><a href="../reference/assemble.html">assemble_acoustics_containers()</a></code>, which support particle filtering, alongside additional improvements to select functions. Where required for existing code, you can continue to use <code>patter</code> v1.0.1 with <a href="https://rstudio.github.io/renv/articles/renv.html" class="external-link"><code>renv</code></a>.</p>
<ul><li>
<strong>Julia setup</strong>
<ul><li>
<code><a href="../reference/julia_connect.html">julia_connect()</a></code> has been revised and enhanced. The <code>.threads</code> argument has been replaced with <code>JULIA_NUM_THREADS</code>.</li>
</ul></li>
<li>
<strong>Map export</strong>
<ul><li>
<code><a href="../reference/set_map.html">set_map()</a></code> has been revamped to support applications on Linux. The function accepts a file path to a raster and includes <code>.as_Raster</code> and <code>.as_GeoArray</code> arguments.</li>
</ul></li>
<li>
<strong>Data assembly</strong>
<ul><li>A distinction is made between detections and acoustic observations, which include detections and non-detections:
<ul><li>
<code>dat_acoustics</code> has been renamed to <code>dat_detections</code>;</li>
<li>
<code>assemble_acoustics(.timeline, .acoustics, ...)</code> has been reformulated to <code>assemble_acoustics(.timeline, .detections, ...)</code>;</li>
</ul></li>
<li>New data assembly routines have been added:
<ul><li>
<code><a href="../reference/assemble.html">assemble_xinit_containers()</a></code> assemble capture/recapture containers, which facilitate convergence of the particle filter with fewer particles;</li>
<li>
<code><a href="../reference/assemble.html">assemble_acoustics_containers()</a></code> assembles acoustic containers;</li>
<li>
<code><a href="../reference/assemble.html">assemble_containers()</a></code> collates container datasets;</li>
<li>
<code><a href="../reference/assemble.html">assemble_custom()</a></code> assembles custom datasets;</li>
</ul></li>
</ul></li>
<li>
<strong>Movement initialisation</strong>
<ul><li>Initial particle samples, formerly generated in <code>R</code> via <code>simulate_states_init()</code> and associated (internal) routines, have been moved to <code>Patter.jl</code>. This change affects <code><a href="../reference/sim_path_walk.html">sim_path_walk()</a></code> and <code><a href="../reference/pf_filter.html">pf_filter()</a></code>. The <code>.map</code> argument only accepted for plotting in <code><a href="../reference/sim_path_walk.html">sim_path_walk()</a></code> and no longer accepted in <code><a href="../reference/pf_filter.html">pf_filter()</a></code>. See the revised examples for automated sampling of initial states from the map.</li>
<li>A bug in <code>map_init.ModelObsAcousticLogisTrunc</code> that overly restricted the region from which initial samples were drawn has been fixed in the new <code>Julia</code> routines.</li>
</ul></li>
<li>
<strong>Movement simulation</strong>
<ul><li>New <code>State</code>s and <code>ModelMove</code>s have been implemented. Current options are <code>StateXY</code>, <code>StateXYZ</code>, <code>StateCXY</code> and <code>StateCXZY</code>, which map to <code>ModelMoveXY</code>, <code>ModelMoveXYZ</code>, <code>ModelMoveCXY</code> and <code>ModelMoveCXZY</code>. (<code>StateXYZD</code> and <code>ModelMoveXYZD</code> have been renamed.)</li>
<li>
<code>model_move_*()</code> wrappers (formerly <code>move_*()</code>) now return a <code>character</code> with an additional <code>ModelMove</code> and <code>ModelMove*</code> class label. Plot methods are provided for in-build classes (see <code>plot.ModelMove</code>).</li>
<li>
<code><a href="../reference/sim_path_walk.html">sim_path_walk()</a></code> now fails with an error for invalid maps/movement models.<br></li>
<li>A new <code>.collect</code> argument collect outputs in <code>R</code>.</li>
</ul></li>
<li>
<strong>Observation simulation</strong>
<ul><li>New <code>model_obs_*()</code> functions have been implemented, along with <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> methods, to streamline code.</li>
<li>
<code><a href="../reference/sim_observations.html">sim_observations()</a></code> now expects <code>ModelObs</code> structures and parameters in a single named list (passed to <code>.model_obs</code>). The <code>.model_obs_pars</code> argument has been dropped.</li>
<li>A new <code>.collect</code> argument collect outputs in <code>R</code>.</li>
</ul></li>
<li>
<strong>Particle filter</strong>
<ul><li>
<code><a href="../reference/pf_filter.html">pf_filter()</a></code> now expects <code>ModelObs</code> structures and observations in a single named list (passed to <code>.yobs</code>). The <code>.model_obs</code> argument has been dropped.</li>
<li>A new <code>.t_resample</code> argument permits you to force resampling at selected time steps.</li>
<li>A new <code>.n_iter</code> argument permits multiple runs of the filter.</li>
<li>A new <code>.batch</code> argument permits batching, i.e., writing particles to disk in batches (to minimise memory requirements for cluster implementations).</li>
<li>A new <code>.collect</code> argument collects outputs in <code>R</code>.</li>
<li>A new <code>.progress</code> argument supports a primitive progress bar on Windows (addressing <a href="https://github.com/edwardlavender/patter/issues/13" class="external-link">#13</a>) and enables customisation.</li>
<li>A revised <code>pf_particles</code> object is returned that includes a <code>callstats</code> [<code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table::data.table</a></code>] that replaces the <code>convergence</code> element.</li>
<li>The <code>callstats</code> element includes the log likelihood of the observations given the parameters for the filter run, enabling optimisation of static parameters (see the third set of examples for <code><a href="../reference/pf_filter.html">pf_filter()</a></code>).</li>
</ul></li>
<li>
<strong>Particle smoothing</strong>
<ul><li>
<code>Patter.particle_smoother_two_filter()</code> has been re-written for enhanced performance;</li>
<li>
<code><a href="../reference/pf_smoother_two_filter.html">pf_smoother_two_filter()</a></code> uses a more flexible <code>.vmap</code> argument, supported by <code><a href="../reference/pf_smoother_two_filter.html">set_vmap()</a></code>, in place of <code>.box</code> and <code>.mobility</code>.</li>
<li>Instances where the two filters are incompatible (all weights are zero) are now flagged with a warning. Formerly, <code>.n_particle</code> copies of the first particle were selected by <code>Patter.resample()</code> at problematic time steps, leading to a bottleneck in the distribution of an individualâ€™s possible locations. Now 50 % of the particles from the forward filter and 50 % from the backward filter are randomly selected at such steps (with a warning). The effective sample size at these time steps is set to NA &amp; provides a counter for the number of problematic time steps.</li>
<li>A new <code>.cache</code> argument fixes incorrect caching for time-varying movement models and enables the user to turn the caching on or off.</li>
<li>A new <code>.batch</code> argument permits batching (for cluster implementations).</li>
<li>A new <code>.collect</code> argument collects outputs in <code>R</code>.</li>
<li>A new <code>.progress</code> argument enables customisation of the progress bar (see above).</li>
<li>A revised <code>pf_particles</code> object is returned (see above).</li>
</ul></li>
<li>
<strong>Plotting &amp; mapping</strong>
<ul><li>
<code><a href="../reference/patter-deprecated.html">pf_plot_xy()</a></code> is deprecated; use the renamed function <code><a href="../reference/plot_xyt.html">plot_xyt()</a></code>.</li>
<li>
<code><a href="../reference/map_dens.html">map_dens()</a></code> now requires the smoothing bandwidth to be specified via a <code>.sigma</code> argument. A new function, <code><a href="../reference/map_dens.html">bw.h()</a></code>, is the default.</li>
<li>The <code>.use_tryCatch</code> argument is now simply named <code>.tryCatch</code>.</li>
</ul></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.0.1" id="patter-v101">
<code>patter</code> v1.0.1<a class="anchor" aria-label="anchor" href="#patter-v101"></a></h2>
<ul><li>This version includes minor documentation, bug fixes and tweaks, most notably:
<ul><li>
<code>Patter.logpdf_step()</code> now includes a <code>t</code> argument that can be used from <code>patter</code>
</li>
<li>
<code><a href="../reference/map_dens.html">map_dens()</a></code> includes an <code>.fterra</code> argument that permits parallelisation of <code><a href="https://rspatial.github.io/terra/reference/resample.html" class="external-link">terra::resample()</a></code>
</li>
</ul></li>
</ul></div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.0.0" id="patter-v100">
<code>patter</code> v1.0.0<a class="anchor" aria-label="anchor" href="#patter-v100"></a></h2>
<div class="section level3">
<h3 id="overview-1-0-0">Overview<a class="anchor" aria-label="anchor" href="#overview-1-0-0"></a></h3>
<p>This is the first version of <code>patter</code>. The main thrust of the package is the provision of particle algorithms for the reconstruction of animal movement paths and emergent patterns of space, with a focus on passive acoustic telemetry systems. The package evolved from the predecessor <code>flapper</code> package, but is simpler, faster, more powerful, better tested and easier to maintain. While current functionality remains more streamlined than <code>flapper</code>, internal routinesâ€”which now used a specialised, fast <code>Julia</code> backend (<code>Patter.jl</code>)â€”alongside the API and supporting documentation are substantially improved. The package also benefits from fewer dependencies and has been fully upgraded in line with the evolution of <code>R</code>â€™s spatial packages (with <code>terra</code> and <code>sf</code> superseding <code>raster</code>, <code>sp</code>, <code>rgeos</code> and associates). Please provide feedback on the new package. Much work remains!</p>
</div>
<div class="section level3">
<h3 id="de-novo-simulation-1-0-0">
<em>De-novo</em> simulation<a class="anchor" aria-label="anchor" href="#de-novo-simulation-1-0-0"></a></h3>
<p>The <code>sim_*()</code> functions in <code>flapper</code> have been replaced with faster and more flexible alternatives, including:</p>
<ul><li>
<code><a href="../reference/sim_path_walk.html">sim_path_walk()</a></code>, which replaces <code><a href="https://edwardlavender.github.io/flapper/reference/sim_path_sa.html" class="external-link">flapper::sim_path_sa()</a></code>;</li>
<li>
<code><a href="../reference/sim_array.html">sim_array()</a></code>, which replaces <code><a href="https://edwardlavender.github.io/flapper/reference/sim_array.html" class="external-link">flapper::sim_array()</a></code>;</li>
<li>
<code><a href="../reference/sim_observations.html">sim_observations()</a></code>, which replaces <code><a href="https://edwardlavender.github.io/flapper/reference/sim_detections.html" class="external-link">flapper::sim_detections()</a></code>;</li>
</ul></div>
<div class="section level3">
<h3 id="particle-filter-1-0-0">Particle filter<a class="anchor" aria-label="anchor" href="#particle-filter-1-0-0"></a></h3>
<p>The <code><a href="../reference/pf_filter.html">pf_filter()</a></code> function implements the particle filter. This brings together and enhances the <code>ac()</code>, <code>dc()</code>, <code>acdc()</code> and <code><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">pf()</a></code> functions in <code>flapper</code>. A major benefit of this integration is that the likelihood of simulated locations is evaluated exclusively at particle locations, rather than across the entire grid (as in <code>ac()</code>, <code>dc()</code> and <code>acdc()</code>), which is much faster. <code><a href="../reference/pf_filter.html">pf_filter()</a></code> also reparameterises the forward simulation of individual locations with a stochastic kick methodology. In <code>flapper</code>, we simulated new locations by calculating movement probabilities into surrounding grid cells and then sampling grid cells in line with those probabilities (a directed sampling methodology). This approach has some significant benefits but becomes prohibitively expensive as grid size (area and resolution) increases. In <code>patter</code>, the stochastic-kick methodology simulates new locations by â€˜kickingâ€™ previous locations using a movement model. Stochastic kicks are independent of grid resolution, so this approach is much faster.</p>
</div>
<div class="section level3">
<h3 id="backward-smoother-1-0-0">Backward smoother<a class="anchor" aria-label="anchor" href="#backward-smoother-1-0-0"></a></h3>
<p>The <code><a href="../reference/pf_smoother_two_filter.html">pf_smoother_two_filter()</a></code> implements particle smoothing. This is a major new routine that substantially refines maps of space use.</p>
</div>
<div class="section level3">
<h3 id="mapping-1-0-0">Mapping<a class="anchor" aria-label="anchor" href="#mapping-1-0-0"></a></h3>
<p>For mapping, <code><a href="../reference/map_pou.html">map_pou()</a></code> replaces <code><a href="https://edwardlavender.github.io/flapper/reference/pf_plot_map.html" class="external-link">flapper::pf_plot_map()</a></code> and resolves an issue with the calculation of weights. <code><a href="../reference/map_dens.html">map_dens()</a></code> is a new function for the reconstruction of maps is based on <code>spatstat</code> routines. This function accounts for particle weights and fits smooth utilisation distributions using cross validation, superseding approaches in <code>flapper</code> based on <code>adehabitatHR</code>. Both approaches can be flexibly implemented using a <code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table::data.table</a></code> of coordinates and are not restricted to particle samples. The <code>map_hr_*()</code> routines for the reconstruction of home ranges are re-implementations of the <code>get_hr_*()</code> functions in <code>flapper</code>.</p>
<p>For the comparison of simulated and reconstructed patterns, the new <code>skill_*()</code> functions can be used.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

