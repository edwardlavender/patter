<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Methodology • patter</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Methodology">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">patter</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a-methodology.html">Methodology</a></li>
    <li><a class="dropdown-item" href="../articles/b-workflow-outline.html">Workflow outline</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/edwardlavender/patter/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Methodology</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/edwardlavender/patter/blob/HEAD/vignettes/a-methodology.Rmd" class="external-link"><code>vignettes/a-methodology.Rmd</code></a></small>
      <div class="d-none name"><code>a-methodology.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>patter</code> implements particle algorithms for animal
movement modelling, with a focus on passive acoustic telemetry systems.
The statistical methodology integrates observations and movement in a
process-based framework that accounts for all available information to
reconstruct movement paths and emergent patterns of space use from
animal tracking data (such as detections at receivers and archival
(depth) time series). This vignette qualitatively outlines the
methodology, providing an entry point to the literature (Lavender et
al., in prep) and the package (Lavender et al., in prep). See the
subsequent vignettes to learn how to implement the methodology using
<code>patter</code> (type <code>vignette(package = "patter")</code> to
list vignettes).</p>
</div>
<div class="section level2">
<h2 id="evolution">Evolution<a class="anchor" aria-label="anchor" href="#evolution"></a>
</h2>
<p>The statistical methodology in <code>patter</code> unifies (and
refines) a suite of methods known as the flapper algorithms (Lavender et
al., 2023). In their original presentation, the flapper algorithms were
presented in two parts: an acoustic-container (AC) branch and a
particle-filtering (PF) branch. AC-branch algorithms define the set of
possible locations of an individual <em>given the data at each time
step</em>. The AC algorithm handles the information from acoustic
observations and the DC algorithm handles the information from depth
observations (which are often collected alongside acoustic data).
PF-branch algorithms refine AC-branch outputs <em>given a movement
model</em>. In the predecessor <a href="https://github.com/edwardlavender/flapper" class="external-link"><code>flapper</code></a>
package, AC-branch algorithms were implemented via <code>ac()</code>,
<code>dc()</code> and <code>acdc()</code> and their outputs were refined
through PF via <code><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">pf()</a></code> and <code>pf_simplify()</code>.</p>
<p>In <code>patter</code>, we have streamlined, enhanced and formalised
the original methodology within the framework of particle filtering and
smoothing (Doucet &amp; Johansen, 2008). (Particle sampling algorithms
remain to be added to the package.) In the particle filter, we simulate
individual states (typically, locations) using the movement model,
contingent upon past and present observations. Each sample is termed a
‘particle’. In <code>patter</code>, this is achieved with a single
function (<code><a href="../reference/pf_filter.html">pf_filter()</a></code>) that integrates the functions of the
AC- and PF-branch algorithms.</p>
<p>The particle filter is refined by particle smoothing. In the original
<code>flapper</code> implementation, a smoothing/sampling-like process
was implemented by <code>pf_simplify()</code> and involved pruning ‘dead
ends’ from a forward run of the particle filter. If you imagine a
forward-running particle filter as a growing fungal network between two
points in space (representing the start and end of a time series), dead
ends are the side branches of the (simulated) fungal network that fail
to reach the end. However, here are two, related limitations with the
‘prune’ methodology. The first is that the removal of dead ends tends to
bias particle samples, because early samples (which invariably
sooner-or-later end up on a dead-end) are more likely to get killed than
later samples. This is known as particle degeneracy. The second is that
while particles are contingent upon the past (a partial marginal
distribution), they do not embody information from the future (i.e., the
full marginal). In <code>patter</code>, particle smoothing mitigates
these issues (see <code><a href="../reference/pf_smoother_two_filter.html">pf_smoother_two_filter()</a></code>). Particle
sampling algorithms reconstruct movement trajectories but are not
currently implemented.</p>
<p>See <code>NEWS</code> for a summary of the differences between
<code>flapper</code> and <code>patter</code>.</p>
</div>
<div class="section level2">
<h2 id="forward-simulation">Forward simulation<a class="anchor" aria-label="anchor" href="#forward-simulation"></a>
</h2>
<div class="section level3">
<h3 id="algorithm">Algorithm<a class="anchor" aria-label="anchor" href="#algorithm"></a>
</h3>
<p>Consider a regular sequence of time steps, along which we have
collected observations (at regular or irregular intervals). In the
particle filter, we run along the time series, sampling particle (states
or locations that are compatible with the data and properties of
movement) as we go. This works as follows:</p>
<ul>
<li>
<strong>Proposals.</strong> At each time step, propose a series of
candidate locations in which the individual could be located. For
example, given a previous location, we simulate step lengths and
headings/turning angles from a movement model and use these to ‘kick’ an
individual into new locations.</li>
<li>
<strong>Likelihood.</strong> Calculate the likelihood of the data,
given each proposal. The likelihoods of acoustic and archival data given
each proposal can be resolved by the equations of the AC and DC
algorithms (or modifications thereof). For example, the AC algorithm
calculates the likelihood of acoustic observations (the presence or
absence of detections at each receiver) according a model of detection
probability, given proposal locations.</li>
<li>
<strong>Weights.</strong> Translate likelihoods into sampling
weights that encapsulate the information in the data and the movement
model.</li>
<li>
<strong>Sampling</strong>. Periodically, sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
proposals, with replacement, in line with the weights. This process
effectively kills off particles that are incompatible with the data and
increases the frequency of more likely proposals.</li>
</ul>
<p>This process continues until the end of the time series. The outcome
is a set of particle samples (partial marginal distributions), one for
each time step.</p>
</div>
<div class="section level3">
<h3 id="implementation">Implementation<a class="anchor" aria-label="anchor" href="#implementation"></a>
</h3>
<p>The implementation of the particle filter in <code>patter</code> is a
four step process:</p>
<ul>
<li>(optional) <code><a href="../reference/pat_setup_data.html">pat_setup_data()</a></code> is used to validate input
datasets;</li>
<li>
<code>assemble_*()</code> functions are used to prepare
datasets;</li>
<li>
<code><a href="../reference/pf_filter.html">pf_filter()</a></code> implements the particle filter, given:
<ul>
<li>The <code>State</code> type;</li>
<li>The movement model (<code>ModelMove</code>);</li>
<li>The observation models (<code>ModelObs</code>);</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="smoothing">Smoothing<a class="anchor" aria-label="anchor" href="#smoothing"></a>
</h2>
<p>Particle smoothing algorithms re-weight particles from the filter,
incorporating information not only from the past but from the future as
well. In other words, smoothing generates an approximation of the full
marginal distribution for an individual’s latent state at each time
step. At the time of writing, we have implemented the two-filter
smoother via via <code><a href="../reference/pf_smoother_two_filter.html">pf_smoother_two_filter()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="mapping">Mapping<a class="anchor" aria-label="anchor" href="#mapping"></a>
</h2>
<p>Patterns of space use (utilisation distributions) can be
reconstructed using standard statistical techniques (see
<code><a href="../reference/map_pou.html">map_pou()</a></code>, <code><a href="../reference/map_dens.html">map_dens()</a></code> and
<code>map_hr_*()</code> for built-in functions).</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Doucet, A. &amp; Johansen, A. M. (2008). A tutorial on particle
filtering and smoothing: Fifteen years later. <a href="https://www.stats.ox.ac.uk/~doucet/doucet_johansen_tutorialPF2011.pdf" class="external-link uri">https://www.stats.ox.ac.uk/~doucet/doucet_johansen_tutorialPF2011.pdf</a>.</p>
<p>Lavender. E. et al. (2023). An integrative modelling framework for
passive acoustic telemetry. <em>Methods in Ecology and Evolution</em>.
<a href="https://doi.org/10.1111/2041-210X.14193" class="external-link uri">https://doi.org/10.1111/2041-210X.14193</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward Lavender.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
